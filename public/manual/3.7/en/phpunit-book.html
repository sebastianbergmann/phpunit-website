<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>PHPUnit Manual</title><link rel="stylesheet" type="text/css" href="css/docbook.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /></head><body><div xml:lang="en" class="book" lang="en"><div class="titlepage"><div><div><h1 class="title"><a id="phpunit"></a>PHPUnit Manual</h1></div><div><div class="author"><h3 class="author"><span class="firstname">Sebastian</span> <span class="surname">Bergmann</span></h3></div></div><div><p class="copyright">Copyright © 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015 Sebastian Bergmann</p></div><div><div class="legalnotice"><a id="idm140124621829952"></a><p>This work is licensed under the Creative Commons Attribution 3.0 Unported License.</p></div></div><div><p class="pubdate">Edition for PHPUnit 3.7. Updated on 2018-04-12.</p></div></div><hr /></div><div class="toc"><dl class="toc"><dt><span class="chapter"><a href="#automating-tests">1. Automating Tests</a></span></dt><dt><span class="chapter"><a href="#goals">2. PHPUnit's Goals</a></span></dt><dt><span class="chapter"><a href="#installation">3. Installing PHPUnit</a></span></dt><dd><dl><dt><span class="section"><a href="#installation.requirements">Requirements</a></span></dt><dt><span class="section"><a href="#installation.phar">PHP Archive (PHAR)</a></span></dt><dd><dl><dt><span class="section"><a href="#installation.phar.verification">Verifying PHPUnit PHAR Releases</a></span></dt></dl></dd><dt><span class="section"><a href="#installation.composer">Composer</a></span></dt><dt><span class="section"><a href="#installation.optional-packages">Optional packages</a></span></dt><dt><span class="section"><a href="#installing.upgrading">Upgrading</a></span></dt></dl></dd><dt><span class="chapter"><a href="#writing-tests-for-phpunit">4. Writing Tests for PHPUnit</a></span></dt><dd><dl><dt><span class="section"><a href="#writing-tests-for-phpunit.test-dependencies">Test Dependencies</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.data-providers">Data Providers</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.exceptions">Testing Exceptions</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.errors">Testing PHP Errors</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.output">Testing Output</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions">Assertions</a></span></dt><dd><dl><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertArrayHasKey">assertArrayHasKey()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertClassHasAttribute">assertClassHasAttribute()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertClassHasStaticAttribute">assertClassHasStaticAttribute()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertContains">assertContains()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertContainsOnly">assertContainsOnly()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertContainsOnlyInstancesOf">assertContainsOnlyInstancesOf()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertCount">assertCount()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertEmpty">assertEmpty()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertEqualXMLStructure">assertEqualXMLStructure()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertEquals">assertEquals()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertFalse">assertFalse()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertFileEquals">assertFileEquals()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertFileExists">assertFileExists()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertGreaterThan">assertGreaterThan()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertGreaterThanOrEqual">assertGreaterThanOrEqual()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertInstanceOf">assertInstanceOf()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertInternalType">assertInternalType()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertJsonFileEqualsJsonFile">assertJsonFileEqualsJsonFile()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertJsonStringEqualsJsonFile">assertJsonStringEqualsJsonFile()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertJsonStringEqualsJsonString">assertJsonStringEqualsJsonString()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertLessThan">assertLessThan()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertLessThanOrEqual">assertLessThanOrEqual()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertNull">assertNull()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertObjectHasAttribute">assertObjectHasAttribute()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertRegExp">assertRegExp()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertStringMatchesFormat">assertStringMatchesFormat()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertStringMatchesFormatFile">assertStringMatchesFormatFile()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertSame">assertSame()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertSelectCount">assertSelectCount()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertSelectEquals">assertSelectEquals()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertSelectRegExp">assertSelectRegExp()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertStringEndsWith">assertStringEndsWith()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertStringEqualsFile">assertStringEqualsFile()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertStringStartsWith">assertStringStartsWith()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertTag">assertTag()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertTrue">assertTrue()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertXmlFileEqualsXmlFile">assertXmlFileEqualsXmlFile()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertXmlStringEqualsXmlFile">assertXmlStringEqualsXmlFile()</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertXmlStringEqualsXmlString">assertXmlStringEqualsXmlString()</a></span></dt></dl></dd><dt><span class="section"><a href="#writing-tests-for-phpunit.error-output">Error output</a></span></dt><dd><dl><dt><span class="section"><a href="#writing-tests-for-phpunit.error-output.edge-cases">Edge cases</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#textui">5. The Command-Line Test Runner</a></span></dt><dd><dl><dt><span class="section"><a href="#textui.clioptions">Command-Line Options</a></span></dt></dl></dd><dt><span class="chapter"><a href="#fixtures">6. Fixtures</a></span></dt><dd><dl><dt><span class="section"><a href="#fixtures.more-setup-than-teardown">More setUp() than tearDown()</a></span></dt><dt><span class="section"><a href="#fixtures.variations">Variations</a></span></dt><dt><span class="section"><a href="#fixtures.sharing-fixture">Sharing Fixture</a></span></dt><dt><span class="section"><a href="#fixtures.global-state">Global State</a></span></dt></dl></dd><dt><span class="chapter"><a href="#organizing-tests">7. Organizing Tests</a></span></dt><dd><dl><dt><span class="section"><a href="#organizing-tests.filesystem">Composing a Test Suite Using the Filesystem</a></span></dt><dt><span class="section"><a href="#organizing-tests.xml-configuration">Composing a Test Suite Using XML Configuration</a></span></dt></dl></dd><dt><span class="chapter"><a href="#database">8. Database Testing</a></span></dt><dd><dl><dt><span class="section"><a href="#database.supported-vendors-for-database-testing">Supported Vendors for Database Testing</a></span></dt><dt><span class="section"><a href="#database.difficulties-in-database-testing">Difficulties in Database Testing</a></span></dt><dt><span class="section"><a href="#database.the-four-stages-of-a-database-test">The four stages of a database test</a></span></dt><dd><dl><dt><span class="section"><a href="#database.clean-up-database">1. Clean-Up Database</a></span></dt><dt><span class="section"><a href="#database.set-up-fixture">2. Set up fixture</a></span></dt><dt><span class="section"><a href="#database.run-test-verify-outcome-and-teardown">3–5. Run Test, Verify outcome and Teardown</a></span></dt></dl></dd><dt><span class="section"><a href="#database.configuration-of-a-phpunit-database-testcase">Configuration of a PHPUnit Database TestCase</a></span></dt><dd><dl><dt><span class="section"><a href="#database.implementing-getconnection">Implementing getConnection()</a></span></dt><dt><span class="section"><a href="#database.implementing-getdataset">Implementing getDataSet()</a></span></dt><dt><span class="section"><a href="#database.what-about-the-database-schema-ddl">What about the Database Schema (DDL)?</a></span></dt><dt><span class="section"><a href="#database.tip-use-your-own-abstract-database-testcase">Tip: Use your own Abstract Database TestCase</a></span></dt></dl></dd><dt><span class="section"><a href="#database.understanding-datasets-and-datatables">Understanding DataSets and DataTables</a></span></dt><dd><dl><dt><span class="section"><a href="#database.available-implementations">Available Implementations</a></span></dt><dt><span class="section"><a href="#database.beware-of-foreign-keys">Beware of Foreign Keys</a></span></dt><dt><span class="section"><a href="#database.implementing-your-own-datasetsdatatables">Implementing your own DataSets/DataTables</a></span></dt></dl></dd><dt><span class="section"><a href="#database.the-connection-api">The Connection API</a></span></dt><dt><span class="section"><a href="#database.database-assertions-api">Database Assertions API</a></span></dt><dd><dl><dt><span class="section"><a href="#database.asserting-the-row-count-of-a-table">Asserting the Row-Count of a Table</a></span></dt><dt><span class="section"><a href="#database.asserting-the-state-of-a-table">Asserting the State of a Table</a></span></dt><dt><span class="section"><a href="#database.asserting-the-result-of-a-query">Asserting the Result of a Query</a></span></dt><dt><span class="section"><a href="#database.asserting-the-state-of-multiple-tables">Asserting the State of Multiple Tables</a></span></dt></dl></dd><dt><span class="section"><a href="#database.frequently-asked-questions">Frequently Asked Questions</a></span></dt><dd><dl><dt><span class="section"><a href="#database.will-phpunit-re-create-the-database-schema-for-each-test">Will PHPUnit (re-)create the database schema for each
             test?</a></span></dt><dt><span class="section"><a href="#database.am-i-required-to-use-pdo-in-my-application-for-the-database-extension-to-work">Am I required to use PDO in my application for the Database
             Extension to work?</a></span></dt><dt><span class="section"><a href="#database.what-can-i-do-when-i-get-a-too-much-connections-error">What can I do, when I get a
             <span class="quote">“<span class="quote">Too much Connections</span>”</span> Error?</a></span></dt><dt><span class="section"><a href="#database.how-to-handle-null-with-flat-xml-csv-datasets">How to handle NULL with Flat XML / CSV Datasets?</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#incomplete-and-skipped-tests">9. Incomplete and Skipped Tests</a></span></dt><dd><dl><dt><span class="section"><a href="#incomplete-and-skipped-tests.incomplete-tests">Incomplete Tests</a></span></dt><dt><span class="section"><a href="#incomplete-and-skipped-tests.skipping-tests">Skipping Tests</a></span></dt><dt><span class="section"><a href="#incomplete-and-skipped-tests.skipping-tests-using-requires">Skipping Tests using @requires</a></span></dt></dl></dd><dt><span class="chapter"><a href="#test-doubles">10. Test Doubles</a></span></dt><dd><dl><dt><span class="section"><a href="#test-doubles.stubs">Stubs</a></span></dt><dt><span class="section"><a href="#test-doubles.mock-objects">Mock Objects</a></span></dt><dt><span class="section"><a href="#test-doubles.stubbing-and-mocking-web-services">Stubbing and Mocking Web Services</a></span></dt><dt><span class="section"><a href="#test-doubles.mocking-the-filesystem">Mocking the Filesystem</a></span></dt></dl></dd><dt><span class="chapter"><a href="#testing-practices">11. Testing Practices</a></span></dt><dd><dl><dt><span class="section"><a href="#testing-practices.during-development">During Development</a></span></dt><dt><span class="section"><a href="#testing-practices.during-debugging">During Debugging</a></span></dt></dl></dd><dt><span class="chapter"><a href="#test-driven-development">12. Test-Driven Development</a></span></dt><dd><dl><dt><span class="section"><a href="#test-driven-development.bankaccount-example">BankAccount Example</a></span></dt></dl></dd><dt><span class="chapter"><a href="#behaviour-driven-development">13. Behaviour-Driven Development</a></span></dt><dd><dl><dt><span class="section"><a href="#behaviour-driven-development.bowlinggame-example">BowlingGame Example</a></span></dt></dl></dd><dt><span class="chapter"><a href="#code-coverage-analysis">14. Code Coverage Analysis</a></span></dt><dd><dl><dt><span class="section"><a href="#code-coverage-analysis.specifying-covered-methods">Specifying Covered Methods</a></span></dt><dt><span class="section"><a href="#code-coverage-analysis.ignoring-code-blocks">Ignoring Code Blocks</a></span></dt><dt><span class="section"><a href="#code-coverage-analysis.including-excluding-files">Including and Excluding Files</a></span></dt><dt><span class="section"><a href="#code-coverage-analysis.edge-cases">Edge cases</a></span></dt></dl></dd><dt><span class="chapter"><a href="#other-uses-for-tests">15. Other Uses for Tests</a></span></dt><dd><dl><dt><span class="section"><a href="#other-uses-for-tests.agile-documentation">Agile Documentation</a></span></dt><dt><span class="section"><a href="#other-uses-for-tests.cross-team-tests">Cross-Team Tests</a></span></dt></dl></dd><dt><span class="chapter"><a href="#skeleton-generator">16. Skeleton Generator</a></span></dt><dd><dl><dt><span class="section"><a href="#skeleton-generator.test">Generating a Test Case Class Skeleton</a></span></dt><dt><span class="section"><a href="#skeleton-generator.class">Generating a Class Skeleton from a Test Case Class</a></span></dt></dl></dd><dt><span class="chapter"><a href="#selenium">17. PHPUnit and Selenium</a></span></dt><dd><dl><dt><span class="section"><a href="#selenium.selenium-rc">Selenium Server</a></span></dt><dt><span class="section"><a href="#selenium.installation">Installation</a></span></dt><dt><span class="section"><a href="#selenium.selenium2testcase">PHPUnit_Extensions_Selenium2TestCase</a></span></dt><dt><span class="section"><a href="#selenium.seleniumtestcase">PHPUnit_Extensions_SeleniumTestCase</a></span></dt></dl></dd><dt><span class="chapter"><a href="#logging">18. Logging</a></span></dt><dd><dl><dt><span class="section"><a href="#logging.xml">Test Results (XML)</a></span></dt><dt><span class="section"><a href="#logging.tap">Test Results (TAP)</a></span></dt><dt><span class="section"><a href="#logging.json">Test Results (JSON)</a></span></dt><dt><span class="section"><a href="#logging.codecoverage.xml">Code Coverage (XML)</a></span></dt><dt><span class="section"><a href="#logging.codecoverage.text">Code Coverage (TEXT)</a></span></dt></dl></dd><dt><span class="chapter"><a href="#extending-phpunit">19. Extending PHPUnit</a></span></dt><dd><dl><dt><span class="section"><a href="#extending-phpunit.PHPUnit_Framework_TestCase">Subclass PHPUnit_Framework_TestCase</a></span></dt><dt><span class="section"><a href="#extending-phpunit.custom-assertions">Write custom assertions</a></span></dt><dt><span class="section"><a href="#extending-phpunit.PHPUnit_Framework_TestListener">Implement PHPUnit_Framework_TestListener</a></span></dt><dt><span class="section"><a href="#extending-phpunit.PHPUnit_Extensions_TestDecorator">Subclass PHPUnit_Extensions_TestDecorator</a></span></dt><dt><span class="section"><a href="#extending-phpunit.PHPUnit_Framework_Test">Implement PHPUnit_Framework_Test</a></span></dt></dl></dd><dt><span class="appendix"><a href="#appendixes.assertions">A. Assertions</a></span></dt><dt><span class="appendix"><a href="#appendixes.annotations">B. Annotations</a></span></dt><dd><dl><dt><span class="section"><a href="#appendixes.annotations.author">@author</a></span></dt><dt><span class="section"><a href="#appendixes.annotations.backupGlobals">@backupGlobals</a></span></dt><dt><span class="section"><a href="#appendixes.annotations.backupStaticAttributes">@backupStaticAttributes</a></span></dt><dt><span class="section"><a href="#appendixes.annotations.codeCoverageIgnore">@codeCoverageIgnore*</a></span></dt><dt><span class="section"><a href="#appendixes.annotations.covers">@covers</a></span></dt><dt><span class="section"><a href="#appendixes.annotations.coversDefaultClass">@coversDefaultClass</a></span></dt><dt><span class="section"><a href="#appendixes.annotations.coversNothing">@coversNothing</a></span></dt><dt><span class="section"><a href="#appendixes.annotations.dataProvider">@dataProvider</a></span></dt><dt><span class="section"><a href="#appendixes.annotations.depends">@depends</a></span></dt><dt><span class="section"><a href="#appendixes.annotations.expectedException">@expectedException</a></span></dt><dt><span class="section"><a href="#appendixes.annotations.expectedExceptionCode">@expectedExceptionCode</a></span></dt><dt><span class="section"><a href="#appendixes.annotations.expectedExceptionMessage">@expectedExceptionMessage</a></span></dt><dt><span class="section"><a href="#appendixes.annotations.group">@group</a></span></dt><dt><span class="section"><a href="#appendixes.annotations.large">@large</a></span></dt><dt><span class="section"><a href="#appendixes.annotations.medium">@medium</a></span></dt><dt><span class="section"><a href="#appendixes.annotations.preserveGlobalState">@preserveGlobalState</a></span></dt><dt><span class="section"><a href="#appendixes.annotations.requires">@requires</a></span></dt><dt><span class="section"><a href="#appendixes.annotations.runTestsInSeparateProcesses">@runTestsInSeparateProcesses</a></span></dt><dt><span class="section"><a href="#appendixes.annotations.runInSeparateProcess">@runInSeparateProcess</a></span></dt><dt><span class="section"><a href="#appendixes.annotations.small">@small</a></span></dt><dt><span class="section"><a href="#appendixes.annotations.test">@test</a></span></dt><dt><span class="section"><a href="#appendixes.annotations.testdox">@testdox</a></span></dt><dt><span class="section"><a href="#appendixes.annotations.ticket">@ticket</a></span></dt></dl></dd><dt><span class="appendix"><a href="#appendixes.configuration">C. The XML Configuration File</a></span></dt><dd><dl><dt><span class="section"><a href="#appendixes.configuration.phpunit">PHPUnit</a></span></dt><dt><span class="section"><a href="#appendixes.configuration.testsuites">Test Suites</a></span></dt><dt><span class="section"><a href="#appendixes.configuration.groups">Groups</a></span></dt><dt><span class="section"><a href="#appendixes.configuration.blacklist-whitelist">Including and Excluding Files for Code Coverage</a></span></dt><dt><span class="section"><a href="#appendixes.configuration.logging">Logging</a></span></dt><dt><span class="section"><a href="#appendixes.configuration.test-listeners">Test Listeners</a></span></dt><dt><span class="section"><a href="#appendixes.configuration.php-ini-constants-variables">Setting PHP INI settings, Constants and Global Variables</a></span></dt><dt><span class="section"><a href="#appendixes.configuration.selenium-rc">Configuring Browsers for Selenium RC</a></span></dt></dl></dd><dt><span class="appendix"><a href="#appendixes.index">D. Index</a></span></dt><dd><dl><dt><span class="index"><a href="#appendixes.index.index"></a></span></dt></dl></dd><dt><span class="appendix"><a href="#appendixes.bibliography">E. Bibliography</a></span></dt><dt><span class="appendix"><a href="#appendixes.copyright">F. Copyright</a></span></dt></dl></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="automating-tests"></a>Chapter 1. Automating Tests</h1></div></div></div><p>
    Even good programmers make mistakes. The difference between a good
    programmer and a bad programmer is that the good programmer uses tests
    to detect mistakes as soon as possible. The sooner you test for a
    mistake the greater your chance of finding it and the less it will cost
    to find and fix. This explains why leaving testing until just before
    releasing software is so problematic. Most errors do not get caught at
    all, and the cost of fixing the ones you do catch is so high that you
    have to perform triage with the errors because you just cannot afford
    to fix them all.
  </p><p>
    <a id="idm140124621819200" class="indexterm"></a>

    Testing with PHPUnit is not a totally different activity from what you
    should already be doing. It is just a different way of doing it. The
    difference is between <span class="emphasis"><em>testing</em></span>, that is, checking
    that your program behaves as expected, and <span class="emphasis"><em>performing a battery
    of tests</em></span>, runnable code-fragments that automatically test the
    correctness of parts (units) of the software. These runnable
    code-fragments are called unit tests.
  </p><p>
    In this chapter we will go from simple <code class="literal">print</code>-based
    testing code to a fully automated test. Imagine that we have been asked
    to test PHP's built-in <code class="literal">array</code>. One bit of functionality
    to test is the function <code class="literal">count()</code>. For a newly created
    array we expect the <code class="literal">count()</code> function to return
    <code class="literal">0</code>. After we add an element, <code class="literal">count()</code>
    should return <code class="literal">1</code>.
    <a class="xref" href="#automating-tests.examples.array-test.php" title="Example 1.1: Testing array operations">Example 1.1</a> shows what
    we want to test.
  </p><div class="example"><a id="automating-tests.examples.array-test.php"></a><p class="title"><strong>Example 1.1: Testing array operations</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
$fixture = array();
// $fixture is expected to be empty.

$fixture[] = 'element';
// $fixture is expected to contain one element.
?&gt;</pre></div></div><br class="example-break" /><p>
    A really simple way to check whether we are getting the results we
    expect is to print the result of <code class="literal">count()</code> before
    and after adding the element (see
    <a class="xref" href="#automating-tests.examples.array-test2.php" title="Example 1.2: Using print to test array operations">Example 1.2</a>).
    If we get <code class="literal">0</code> and then <code class="literal">1</code>,
    <code class="literal">array</code> and <code class="literal">count()</code> behave as
    expected.
  </p><div class="example"><a id="automating-tests.examples.array-test2.php"></a><p class="title"><strong>Example 1.2: Using print to test array operations</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
$fixture = array();
print count($fixture) . "\n";

$fixture[] = 'element';
print count($fixture) . "\n";
?&gt;</pre><pre class="screen">0
1</pre></div></div><br class="example-break" /><p>
    Now, we would like to move from tests that require manual interpretation
    to tests that can run automatically. In
    <a class="xref" href="#automating-tests.examples.array-test3.php" title="Example 1.3: Comparing expected and actual values to test array operations">Example 1.3</a>, we write
    the comparison of the expected and actual values into the test code and
    print <code class="literal">ok</code> if the values are equal. If we ever see a
    <code class="literal">not ok</code> message, we know something is wrong.
  </p><div class="example"><a id="automating-tests.examples.array-test3.php"></a><p class="title"><strong>Example 1.3: Comparing expected and actual values to test array operations</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
$fixture = array();
print count($fixture) == 0 ? "ok\n" : "not ok\n";

$fixture[] = 'element';
print count($fixture) == 1 ? "ok\n" : "not ok\n";
?&gt;</pre><pre class="screen">ok
ok</pre></div></div><br class="example-break" /><p>
    <a id="idm140124621858656" class="indexterm"></a>

    We now factor out the comparison of expected and actual values into a
    function that raises an Exception when there is a discrepancy
    (<a class="xref" href="#automating-tests.examples.array-test4.php" title="Example 1.4: Using an assertion function to test array operations">Example 1.4</a>). This
    gives us two benefits: the writing of tests becomes easier and we only
    get output when something is wrong.
  </p><div class="example"><a id="automating-tests.examples.array-test4.php"></a><p class="title"><strong>Example 1.4: Using an assertion function to test array operations</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
ini_set('error_log', '');
ini_set('display_errors', 'Off');

$fixture = array();
assertTrue(count($fixture) == 0);

$fixture[] = 'element';
assertTrue(count($fixture) == 1);

function assertTrue($condition)
{
    if (!$condition) {
        throw new Exception('Assertion failed.');
    }
}
?&gt;</pre></div></div><br class="example-break" /><p>
    <a id="idm140124621855056" class="indexterm"></a>

    The test is now completely automated. Instead of just
    <span class="emphasis"><em>testing</em></span> as we did with our first version,
    with this version we have an <span class="emphasis"><em>automated test</em></span>.
  </p><p>
    The goal of using automated tests is to make fewer mistakes. While your
    code will still not be perfect, even with excellent tests, you will
    likely see a dramatic reduction in defects once you start automating
    tests. Automated tests give you justified confidence in your code. You
    can use this confidence to take more daring leaps in design
    (Refactoring), get along with your teammates better (Cross-Team Tests),
    improve relations with your customers, and go home every night with
    proof that the system is better now than it was this morning because of
    your efforts.
  </p></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="goals"></a>Chapter 2. PHPUnit's Goals</h1></div></div></div><p>
    So far, we only have two tests for the <code class="literal">array</code> built-in
    and the <code class="literal">count()</code> function. When we start to test the
    numerous <code class="literal">array_*()</code> functions PHP offers, we will need
    to write a test for each of them. We could write the infrastructure for
    all these tests from scratch. However, it is much better to write a
    testing infrastructure once and then write only the unique parts of each
    test. PHPUnit is such an infrastructure.
  </p><p>
    A framework such as PHPUnit has to resolve a set of constraints, some of
    which seem always to conflict with each other. Simultaneously, tests
    should be:
  </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><span class="emphasis"><em>Easy to learn to write.</em></span></span></dt><dd><p>
          If it's hard to learn how to write tests, developers will not learn
          to write them.
        </p></dd><dt><span class="term"><span class="emphasis"><em>Easy to write.</em></span></span></dt><dd><p>
          If tests are not easy to write, developers will not write them.
        </p></dd><dt><span class="term"><span class="emphasis"><em>Easy to read.</em></span></span></dt><dd><p>
          Test code should contain no extraneous overhead so that the test
          itself does not get lost in noise that surrounds it.
        </p></dd><dt><span class="term"><span class="emphasis"><em>Easy to execute.</em></span></span></dt><dd><p>
          The tests should run at the touch of a button and present their
          results in a clear and unambiguous format.
        </p></dd><dt><span class="term"><span class="emphasis"><em>Quick to execute.</em></span></span></dt><dd><p>
          Tests should run fast so they can be run hundreds or thousands
          of times a day.
        </p></dd><dt><span class="term"><span class="emphasis"><em>Isolated.</em></span></span></dt><dd><p>
          The tests should not affect each other. If the order in which the
          tests are run changes, the results of the tests should not change.
        </p></dd><dt><span class="term"><span class="emphasis"><em>Composable.</em></span></span></dt><dd><p>
          We should be able to run any number or combination of tests together.
          This is a corollary of isolation.
        </p></dd></dl></div><p>
    There are two main clashes between these constraints:
  </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><span class="emphasis"><em>Easy to learn to write versus easy to write.</em></span></span></dt><dd><p>
          Tests do not generally require all the flexibility of a programming
          language. Many testing tools provide their own scripting language
          that only includes the minimum necessary features for writing tests.
          The resulting tests are easy to read and write because they have no
          noise to distract you from the content of the tests. However,
          learning yet another programming language and set of programming
          tools is inconvenient and clutters the mind.
        </p></dd><dt><span class="term"><span class="emphasis"><em>Isolated versus quick to execute.</em></span></span></dt><dd><p>
          If you want the results of one test to have no effect on the results
          of another test, each test should create the full state of the world
          before it begins to execute and return the world to its original
          state when it finishes. However, setting up the world can take a
          long time: for example connecting to a database and initializing it
          to a known state using realistic data.
        </p></dd></dl></div><p>
    PHPUnit attempts to resolve these conflicts by using PHP as the testing
    language. Sometimes the full power of PHP is overkill for writing little
    straight-line tests, but by using PHP we leverage all the experience and
    tools programmers already have in place. Since we are trying to convince
    reluctant testers, lowering the barrier to writing those initial tests
    is particularly important.
  </p><p>
    PHPUnit errs on the side of isolation over quick execution. Isolated
    tests are valuable because they provide high-quality feedback. You do
    not get a report with a bunch of test failures, which were really caused
    because one test at the beginning of the suite failed and left the world
    messed up for the rest of the tests. This orientation towards isolated
    tests encourages designs with a large number of simple objects. Each
    object can be tested quickly in isolation. The result is better designs
    <span class="emphasis"><em>and</em></span> faster tests.
  </p><p>
    PHPUnit assumes that most tests succeed and it is not worth reporting
    the details of successful tests. When a test fails, that fact is worth
    noting and reporting. The vast majority of tests should succeed and are
    not worth commenting on except to count the number of tests that run.
    This is an assumption that is really built into the reporting classes,
    and not into the core of PHPUnit. When the results of a test run are
    reported, you see how many tests were executed, but you only see details
    for those that failed.
  </p><p>
    Tests are expected to be fine-grained, testing one aspect of one object.
    Hence, the first time a test fails, execution of the test halts, and
    PHPUnit reports the failure. It is an art to test by running in many
    small tests. Fine-grained tests improve the overall design of the system.
  </p><p>
    When you test an object with PHPUnit, you do so only through the
    object's public interface. Testing based only on publicly visible
    behaviour encourages you to confront and solve difficult design problems
    earlier, before the results of poor design can infect large parts of the
    system.
  </p></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="installation"></a>Chapter 3. Installing PHPUnit</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="installation.requirements"></a>Requirements</h2></div></div></div><p>
      PHPUnit 3.7 requires PHP 5.3.3; using the latest version of PHP is highly
      recommended.
    </p><p>
      PHPUnit requires the <a class="ulink" href="http://php.net/manual/en/ctype.installation.php" target="_top">ctype</a>,
      <a class="ulink" href="http://php.net/manual/en/dom.setup.php" target="_top">dom</a>, <a class="ulink" href="http://php.net/manual/en/json.installation.php" target="_top">json</a>,
      <a class="ulink" href="http://php.net/manual/en/pcre.installation.php" target="_top">pcre</a>,
      <a class="ulink" href="http://php.net/manual/en/reflection.installation.php" target="_top">reflection</a>,
      and <a class="ulink" href="http://php.net/manual/en/spl.installation.php" target="_top">spl</a>
      extensions. These extensions are usually compiled and enabled by default.
      Some of them cannot even be disabled and are therefore always available.
    </p><p>
      For code coverage support, <a class="ulink" href="http://xdebug.org/" target="_top">Xdebug</a> 2.1.3 is required; using the
      latest version of Xdebug is highly recommended. The <a class="ulink" href="http://php.net/manual/en/tokenizer.installation.php" target="_top">tokenizer</a>
      extension is also required for the code coverage functionality to work.
    </p><p>
      The <a class="ulink" href="http://php.net/manual/en/phar.installation.php" target="_top">phar</a>
      extension is required for using PHPUnit from a PHP Archive (PHAR). You
      need to configure <code class="literal">suhosin.executor.include.whitelist = phar</code>
      if you are using the <a class="ulink" href="http://suhosin.org/" target="_top">Suhosin</a>
      extension and would like to use PHPUnit from a PHP Archive (PHAR).
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="installation.phar"></a>PHP Archive (PHAR)</h2></div></div></div><p>
      The easiest way to obtain PHPUnit is to download a <a class="ulink" href="http://php.net/phar" target="_top">PHP Archive (PHAR)</a> that has all required
      (as well as some optional) dependencies of PHPUnit bundled in a single
      file:
    </p><pre class="screen"><strong class="userinput"><code>wget https://phar.phpunit.de/phpunit.phar</code></strong>
<strong class="userinput"><code>chmod +x phpunit.phar</code></strong>
<strong class="userinput"><code>mv phpunit.phar /usr/local/bin/phpunit</code></strong></pre><p>
      You can also immediately use the PHAR after you have downloaded it, of
      course:
    </p><pre class="screen"><strong class="userinput"><code>wget https://phar.phpunit.de/phpunit.phar</code></strong>
<strong class="userinput"><code>php phpunit.phar</code></strong></pre><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="installation.phar.verification"></a>Verifying PHPUnit PHAR Releases</h3></div></div></div><p>
        All official releases of code distributed by the PHPUnit Project are
        signed by the release manager for the release. PGP signatures and SHA1
        hashes are available for verification on <a class="ulink" href="https://phar.phpunit.de/" target="_top">phar.phpunit.de</a>.
      </p><p>
        The following example details how release verification works. We start
        by downloading <code class="filename">phpunit.phar</code> as well as its
        detached PGP signature <code class="filename">phpunit.phar.asc</code>:
      </p><pre class="screen"><strong class="userinput"><code>wget https://phar.phpunit.de/phpunit.phar</code></strong>
<strong class="userinput"><code>wget https://phar.phpunit.de/phpunit.phar.asc</code></strong></pre><p>
        We want to verify PHPUnit's PHP Archive (<code class="filename">phpunit.phar</code>)
        against its detached signature (<code class="filename">phpunit.phar.asc</code>):
      </p><pre class="screen"><strong class="userinput"><code>gpg phpunit.phar.asc</code></strong>
gpg: Signature made Sat 19 Jul 2014 01:28:02 PM CEST using RSA key ID 6372C20A
gpg: Can't check signature: public key not found</pre><p>
        We don't have the release manager's public key (<code class="literal">6372C20A</code>)
        in our local system. In order to proceed with the verification we need
        to retrieve the release manager's public key from a key server. One such
        server is <code class="filename">pgp.uni-mainz.de</code>. The public key servers
        are linked together, so you should be able to connect to any key server.
      </p><pre class="screen"><strong class="userinput"><code>gpg --keyserver pgp.uni-mainz.de --recv-keys 0x4AA394086372C20A</code></strong>
gpg: requesting key 6372C20A from hkp server pgp.uni-mainz.de
gpg: key 6372C20A: public key "Sebastian Bergmann &lt;sb@sebastian-bergmann.de&gt;" imported
gpg: Total number processed: 1
gpg:               imported: 1  (RSA: 1)</pre><p>
        Now we have received a public key for an entity known as "Sebastian
        Bergmann &lt;sb@sebastian-bergmann.de&gt;". However, we have no way of
        verifying this key was created by the person known as Sebastian
        Bergmann. But, let's try to verify the release signature again.
      </p><pre class="screen"><strong class="userinput"><code>gpg phpunit.phar.asc</code></strong>
gpg: Signature made Sat 19 Jul 2014 01:28:02 PM CEST using RSA key ID 6372C20A
gpg: Good signature from "Sebastian Bergmann &lt;sb@sebastian-bergmann.de&gt;"
gpg:                 aka "Sebastian Bergmann &lt;sebastian@php.net&gt;"
gpg:                 aka "Sebastian Bergmann &lt;sebastian@thephp.cc&gt;"
gpg:                 aka "Sebastian Bergmann &lt;sebastian@phpunit.de&gt;"
gpg:                 aka "Sebastian Bergmann &lt;sebastian.bergmann@thephp.cc&gt;"
gpg:                 aka "[jpeg image of size 40635]"
gpg: WARNING: This key is not certified with a trusted signature!
gpg:          There is no indication that the signature belongs to the owner.
Primary key fingerprint: D840 6D0D 8294 7747 2937  7831 4AA3 9408 6372 C20A</pre><p>
        At this point, the signature is good, but we don't trust this key. A
        good signature means that the file has not been tampered. However, due
        to the nature of public key cryptography, you need to additionally
        verify that key <code class="literal">6372C20A</code> was created by the real
        Sebastian Bergmann.
      </p><p>
        Any attacker can create a public key and upload it to the public key
        servers. They can then create a malicious release signed by this fake
        key. Then, if you tried to verify the signature of this corrupt release,
        it would succeed because the key was not the "real" key. Therefore, you
        need to validate the authenticity of this key. Validating the
        authenticity of a public key, however, is outside the scope of this
        documentation.
      </p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="installation.composer"></a>Composer</h2></div></div></div><p>
      Simply add a dependency on <code class="literal">phpunit/phpunit</code> to your
      project's <code class="literal">composer.json</code> file if you use
      <a class="ulink" href="http://getcomposer.org/" target="_top">Composer</a> to manage the
      dependencies of your project. Here is a minimal example of a
      <code class="literal">composer.json</code> file that just defines a development-time
      dependency on PHPUnit 3.7:
    </p><pre class="programlisting">{
    "require-dev": {
        "phpunit/phpunit": "3.7.*"
    }
}</pre><p>
      For a system-wide installation via Composer, you can run:
    </p><pre class="screen"><strong class="userinput"><code>composer global require "phpunit/phpunit=3.7.*"</code></strong></pre><p>
      Make sure you have <code class="literal">~/.composer/vendor/bin/</code> in your
      path.
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        Support for Composer and PHP Archive (PHAR) was added in PHPUnit 3.7
        (and is known to be stable since PHPUnit 3.7.5). Earlier releases of
        PHPUnit are not available through these distribution channels.
      </p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="installation.optional-packages"></a>Optional packages</h2></div></div></div><p>
      The following optional packages are available:
    </p><div class="variablelist"><dl class="variablelist"><dt><span class="term">
          <code class="literal">PHP_Invoker</code>
        </span></dt><dd><p>
            A utility class for invoking callables with a timeout. This package is
            required to enforce test timeouts in strict mode.
          </p><p>
            This package is included in the PHAR distribution of PHPUnit. It can
            be installed via Composer by adding the following
            <code class="literal">"require-dev"</code> dependency:
          </p><pre class="screen"><strong class="userinput"><code>"phpunit/php-invoker": "*"</code></strong></pre></dd><dt><span class="term">
          <code class="literal">DbUnit</code>
        </span></dt><dd><p>
            DbUnit port for PHP/PHPUnit to support database interaction testing.
          </p><p>
            This package is included in the PHAR distribution of PHPUnit. It can
            be installed via Composer by adding the following
            <code class="literal">"require-dev"</code> dependency:
          </p><pre class="screen"><strong class="userinput"><code>"phpunit/dbunit": "&gt;=1.2"</code></strong></pre></dd><dt><span class="term">
          <code class="literal">PHPUnit_Selenium</code>
        </span></dt><dd><p>
            Selenium RC integration for PHPUnit.
          </p><p>
            This package is included in the PHAR distribution of PHPUnit. It can
            be installed via Composer by adding the following
            <code class="literal">"require-dev"</code> dependency:
          </p><pre class="screen"><strong class="userinput"><code>"phpunit/phpunit-selenium": "&gt;=1.2"</code></strong></pre></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="installing.upgrading"></a>Upgrading</h2></div></div></div><p>
      This section serves as a collection of minor BC issues that one might
      run into when upgrading from PHPUnit 3.6 to PHPUnit 3.7.
    </p><p>
      The upgrade should be rather easy and work without any issues as it was
      tested against all major Open Source frameworks and there was not a
      single problem for them. Still every project is different and if you
      did not get around to trying one of the release candidates and have ran
      into an issue this document might provide some help.
    </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><span class="strong"><strong>Removed deprecated OutputTestCase</strong></span></span></dt><dd><p>
            The class <code class="literal">PHPUnit_Extensions_OutputTestCase</code> has
            been removed. PHPUnit 3.6 issued a deprecation notice when it was
            used. To see how output can now be tested look into
            <a class="xref" href="#writing-tests-for-phpunit.output" title="Testing Output">the section called “Testing Output”</a>.
          </p></dd><dt><span class="term"><span class="strong"><strong>Current working directory will be restored after each test case</strong></span></span></dt><dd><p>
            If a test changes the current working directory
            (<code class="literal">cwd</code>) PHPUnit ran into issues when generating
            code coverage output. Now that the cwd is restored after each
            test case you might find that one of your tests depended on
            another test changing the cwd. Something that isn't desirable
            anyways and should be easy to fix.
          </p></dd><dt><span class="term"><span class="strong"><strong>Test listeners trigger one autoload call</strong></span></span></dt><dd><p>
            When using custom test listeners as described in
            <a class="xref" href="#appendixes.configuration.test-listeners" title="Test Listeners">the section called “Test Listeners”</a> PHPUnit
            silently ignored missing test listeners and it was quite hard to
            debug that issues for the user. Now one autoload call will be
            triggered trying to locate the class. If your autoloader produces
            an error when it doesn't find a test listener you might run into an
            issue here. Removing the listener or making sure it's loaded in your
            <code class="literal">bootstrap.php</code> will solve this.
          </p></dd><dt><span class="term"><span class="strong"><strong>Parameters for mock objects do not get cloned anymore</strong></span></span></dt><dd><p>
            Previously all object parameters where cloned when mocking.
            This lead to issues when testing trying to check whether the same
            object was passed to method or not and other problem with
            uncloneable objects. As a long standing feature request by many
            this behavior was changed.
            <a class="xref" href="#test-doubles.mock-objects.examples.clone-object-parameters-usecase.php" title="Example 10.15: Testing that a method gets called once and with the identical object as was passed">Example 10.15</a>
            shows where the new implementation could be useful.
            <a class="xref" href="#test-doubles.mock-objects.examples.enable-clone-object-parameters.php" title="Example 10.16: Create a mock object with cloning parameters enabled">Example 10.16</a>
            shows how to switch back to previous behavior.
          </p></dd><dt><span class="term"><span class="strong"><strong>
          <code class="literal">addUncoveredFilesFromWhitelist</code>
          was removed in favor of
          <code class="literal">processUncoveredFilesFromWhitelist</code></strong></span>
        </span></dt><dd><p>
            When generating code coverage and using
            <code class="literal">&lt;whitelist addUncoveredFilesFromWhitelist="true"&gt;</code>
            all uncovered files got included by PHPUnit. This was an issue for
            people with executable code in those files. PHPUnit will now scan
            the file and guess what code is executable and what code is not
            without including it. This might lead to different code coverage
            reports.
          </p><p>
            To switch back to the old behavior the setting
            <code class="literal">&lt;whitelist processUncoveredFilesFromWhitelist="true"&gt;</code>
            can be used. If you want the behavior with PHPUnit 3.6. and 3.7.
            it is possible to use both settings for a while.
          </p></dd><dt><span class="term"><span class="strong"><strong>
          Default value of <code class="literal">cacheTokens</code> changed to
          <code class="literal">false</code></strong></span>
        </span></dt><dd><p>
            Since PHPUnit <code class="literal">3.7.2</code> we turned off the caching
            of tokenized files by default. When processing code coverage
            reports for big projects this cache consumed a lot of memory and
            due to the change in whitelist behavior it was problematic for
            folks with code bases with more than a couple of thousand classes.
          </p><p>
            If your project is smaller or you have enough memory you will get
            a runtime benefit by adding <code class="literal">cacheTokens="true"</code>
            to your <code class="literal">phpunit.xml</code> file. See
            <a class="xref" href="#appendixes.configuration.phpunit" title="PHPUnit">the section called “PHPUnit”</a>.
          </p></dd></dl></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="writing-tests-for-phpunit"></a>Chapter 4. Writing Tests for PHPUnit</h1></div></div></div><p>
    <a id="idm140124621739952" class="indexterm"></a>

    <a class="xref" href="#writing-tests-for-phpunit.examples.StackTest.php" title="Example 4.1: Testing array operations with PHPUnit">Example 4.1</a> shows
    how we can write tests using PHPUnit that exercise PHP's array operations.
    The example introduces the basic conventions and steps for writing tests
    with PHPUnit:
  </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>The tests for a class <code class="literal">Class</code> go into a class <code class="literal">ClassTest</code>.</p></li><li class="listitem"><p><code class="literal">ClassTest</code> inherits (most of the time) from <code class="literal">PHPUnit_Framework_TestCase</code>.</p></li><li class="listitem"><a id="idm140124621693968" class="indexterm"></a><a id="idm140124621693552" class="indexterm"></a><p>The tests are public methods that are named <code class="literal">test*</code>.</p><p><a id="idm140124621692304" class="indexterm"></a>Alternatively, you can use the <code class="literal">@test</code> annotation in a method's docblock to mark it as a test method.</p></li><li class="listitem"><p>Inside the test methods, assertion methods such as <code class="literal">assertEquals()</code> (see <a class="xref" href="#writing-tests-for-phpunit.assertions" title="Assertions">the section called “Assertions”</a>) are used to assert that an actual value matches an expected value.</p></li></ol></div><div class="example"><a id="writing-tests-for-phpunit.examples.StackTest.php"></a><p class="title"><strong>Example 4.1: Testing array operations with PHPUnit</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class StackTest extends PHPUnit_Framework_TestCase
{
    public function testPushAndPop()
    {
        $stack = array();
        $this-&gt;assertEquals(0, count($stack));

        array_push($stack, 'foo');
        $this-&gt;assertEquals('foo', $stack[count($stack)-1]);
        $this-&gt;assertEquals(1, count($stack));

        $this-&gt;assertEquals('foo', array_pop($stack));
        $this-&gt;assertEquals(0, count($stack));
    }
}
?&gt;</pre></div></div><br class="example-break" /><div class="blockquote"><table border="0" class="blockquote" style="width: 100%; cellspacing: 0; cellpadding: 0;" summary="Block quote"><tr><td width="10%" valign="top"> </td><td width="80%" valign="top"><p>
      Whenever you are tempted to type something into a
      <code class="literal">print</code> statement or a debugger expression, write it
      as a test instead.
    </p></td><td width="10%" valign="top"> </td></tr><tr><td width="10%" valign="top"> </td><td colspan="2" align="right" valign="top">--<span class="attribution">Martin Fowler</span></td></tr></table></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="writing-tests-for-phpunit.test-dependencies"></a>Test Dependencies</h2></div></div></div><div class="blockquote"><table border="0" class="blockquote" style="width: 100%; cellspacing: 0; cellpadding: 0;" summary="Block quote"><tr><td width="10%" valign="top"> </td><td width="80%" valign="top"><p>
        Unit Tests are primarily written as a good practice to help developers
        identify and fix bugs, to refactor code and to serve as documentation
        for a unit of software under test. To achieve these benefits, unit tests
        ideally should cover all the possible paths in a program. One unit test
        usually covers one specific path in one function or method. However a
        test method is not necessarily an encapsulated, independent entity. Often
        there are implicit dependencies between test methods, hidden in the
        implementation scenario of a test.
      </p></td><td width="10%" valign="top"> </td></tr><tr><td width="10%" valign="top"> </td><td colspan="2" align="right" valign="top">--<span class="attribution">Adrian Kuhn et. al.</span></td></tr></table></div><p>
      <a id="idm140124621717936" class="indexterm"></a>

      PHPUnit supports the declaration of explicit dependencies between test
      methods. Such dependencies do not define the order in which the test
      methods are to be executed but they allow the returning of an instance of
      the test fixture by a producer and passing it to the dependent consumers.
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>A producer is a test method that yields its unit under test as return value.</p></li><li class="listitem"><p>A consumer is a test method that depends on one or more producers and their return values.</p></li></ul></div><p>
      <a id="idm140124621631120" class="indexterm"></a>
      <a id="idm140124621630544" class="indexterm"></a>

      <a class="xref" href="#writing-tests-for-phpunit.examples.StackTest2.php" title="Example 4.2: Using the @depends annotation to express dependencies">Example 4.2</a> shows
      how to use the <code class="literal">@depends</code> annotation to express
      dependencies between test methods.
    </p><div class="example"><a id="writing-tests-for-phpunit.examples.StackTest2.php"></a><p class="title"><strong>Example 4.2: Using the <code class="literal">@depends</code> annotation to express dependencies</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class StackTest extends PHPUnit_Framework_TestCase
{
    public function testEmpty()
    {
        $stack = array();
        $this-&gt;assertEmpty($stack);

        return $stack;
    }

    /**
     * @depends testEmpty
     */
    public function testPush(array $stack)
    {
        array_push($stack, 'foo');
        $this-&gt;assertEquals('foo', $stack[count($stack)-1]);
        $this-&gt;assertNotEmpty($stack);

        return $stack;
    }

    /**
     * @depends testPush
     */
    public function testPop(array $stack)
    {
        $this-&gt;assertEquals('foo', array_pop($stack));
        $this-&gt;assertEmpty($stack);
    }
}
?&gt;</pre></div></div><br class="example-break" /><p>
      In the example above, the first test, <code class="literal">testEmpty()</code>,
      creates a new array and asserts that it is empty. The test then returns
      the fixture as its result. The second test, <code class="literal">testPush()</code>,
      depends on <code class="literal">testEmpty()</code> and is passed the result of that
      depended-upon test as its argument. Finally, <code class="literal">testPop()</code>
      depends upon <code class="literal">testPush()</code>.
    </p><p>
      <a id="idm140124621622880" class="indexterm"></a>

      To quickly localize defects, we want our attention to be focussed on
      relevant failing tests. This is why PHPUnit skips the execution of a test
      when a depended-upon test has failed. This improves defect localization by
      exploiting the dependencies between tests as shown in
      <a class="xref" href="#writing-tests-for-phpunit.examples.DependencyFailureTest.php" title="Example 4.3: Exploiting the dependencies between tests">Example 4.3</a>.
    </p><div class="example"><a id="writing-tests-for-phpunit.examples.DependencyFailureTest.php"></a><p class="title"><strong>Example 4.3: Exploiting the dependencies between tests</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class DependencyFailureTest extends PHPUnit_Framework_TestCase
{
    public function testOne()
    {
        $this-&gt;assertTrue(FALSE);
    }

    /**
     * @depends testOne
     */
    public function testTwo()
    {
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit --verbose DependencyFailureTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

FS

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) DependencyFailureTest::testOne
Failed asserting that false is true.

/home/sb/DependencyFailureTest.php:6

There was 1 skipped test:

1) DependencyFailureTest::testTwo
This test depends on "DependencyFailureTest::testOne" to pass.


FAILURES!
Tests: 1, Assertions: 1, Failures: 1, Skipped: 1.</pre></div></div><br class="example-break" /><p>
      A test may have more than one <code class="literal">@depends</code> annotation.
      PHPUnit does not change the order in which tests are executed, you have to
      ensure that the dependencies of a test can actually be met before the test
      is run.
    </p><p>
      A test that has more than one <code class="literal">@depends</code> annotation
      will get a fixture from the first producer as the first argument, a fixture
      from the second producer as the second argument, and so on.
      See <a class="xref" href="#writing-tests-for-phpunit.examples.MultipleDependencies.php" title="Example 4.4: Test with multiple dependencies">Example 4.4</a>
    </p><div class="example"><a id="writing-tests-for-phpunit.examples.MultipleDependencies.php"></a><p class="title"><strong>Example 4.4: Test with multiple dependencies</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class MultipleDependenciesTest extends PHPUnit_Framework_TestCase
{
    public function testProducerFirst()
    {
        $this-&gt;assertTrue(true);
        return 'first';
    }

    public function testProducerSecond()
    {
        $this-&gt;assertTrue(true);
        return 'second';
    }

    /**
     * @depends testProducerFirst
     * @depends testProducerSecond
     */
    public function testConsumer()
    {
        $this-&gt;assertEquals(
            array('first', 'second'),
            func_get_args()
        );
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit --verbose MultipleDependenciesTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

...

Time: 0 seconds, Memory: 3.25Mb

OK (3 tests, 3 assertions)</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="writing-tests-for-phpunit.data-providers"></a>Data Providers</h2></div></div></div><p>
      <a id="idm140124621644736" class="indexterm"></a>
      <a id="idm140124621644160" class="indexterm"></a>
      A test method can accept arbitrary arguments. These arguments are to be
      provided by a data provider method (<code class="literal">provider()</code> in
      <a class="xref" href="#writing-tests-for-phpunit.data-providers.examples.DataTest.php" title="Example 4.5: Using a data provider that returns an array of arrays">Example 4.5</a>).
      The data provider method to be used is specified using the
      <code class="literal">@dataProvider</code> annotation.
    </p><p>
      A data provider method must be <code class="literal">public</code> and either return
      an array of arrays or an object that implements the <code class="literal">Iterator</code>
      interface and yields an array for each iteration step. For each array that
      is part of the collection the test method will be called with the contents
      of the array as its arguments.
    </p><div class="example"><a id="writing-tests-for-phpunit.data-providers.examples.DataTest.php"></a><p class="title"><strong>Example 4.5: Using a data provider that returns an array of arrays</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class DataTest extends PHPUnit_Framework_TestCase
{
    /**
     * @dataProvider provider
     */
    public function testAdd($a, $b, $c)
    {
        $this-&gt;assertEquals($c, $a + $b);
    }

    public function provider()
    {
        return array(
          array(0, 0, 0),
          array(0, 1, 1),
          array(1, 0, 1),
          array(1, 1, 3)
        );
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit DataTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

...F

Time: 0 seconds, Memory: 5.75Mb

There was 1 failure:

1) DataTest::testAdd with data set #3 (1, 1, 3)
Failed asserting that 2 matches expected 3.

/home/sb/DataTest.php:9

FAILURES!
Tests: 4, Assertions: 4, Failures: 1.</pre></div></div><br class="example-break" /><div class="example"><a id="writing-tests-for-phpunit.data-providers.examples.DataTest2.php"></a><p class="title"><strong>Example 4.6: Using a data provider that returns an Iterator object</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
require 'CsvFileIterator.php';

class DataTest extends PHPUnit_Framework_TestCase
{
    /**
     * @dataProvider provider
     */
    public function testAdd($a, $b, $c)
    {
        $this-&gt;assertEquals($c, $a + $b);
    }

    public function provider()
    {
        return new CsvFileIterator('data.csv');
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit DataTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

...F

Time: 0 seconds, Memory: 5.75Mb

There was 1 failure:

1) DataTest::testAdd with data set #3 ('1', '1', '3')
Failed asserting that 2 matches expected '3'.

/home/sb/DataTest.php:11

FAILURES!
Tests: 4, Assertions: 4, Failures: 1.</pre></div></div><br class="example-break" /><div class="example"><a id="writing-tests-for-phpunit.data-providers.examples.CsvFileIterator.php"></a><p class="title"><strong>Example 4.7: The CsvFileIterator class</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class CsvFileIterator implements Iterator {
    protected $file;
    protected $key = 0;
    protected $current;

    public function __construct($file) {
        $this-&gt;file = fopen($file, 'r');
    }

    public function __destruct() {
        fclose($this-&gt;file);
    }

    public function rewind() {
        rewind($this-&gt;file);
        $this-&gt;current = fgetcsv($this-&gt;file);
        $this-&gt;key = 0;
    }

    public function valid() {
        return !feof($this-&gt;file);
    }

    public function key() {
        return $this-&gt;key;
    }

    public function current() {
        return $this-&gt;current;
    }

    public function next() {
        $this-&gt;current = fgetcsv($this-&gt;file);
        $this-&gt;key++;
    }
}
?&gt;</pre></div></div><br class="example-break" /><p>
      <a id="idm140124620991616" class="indexterm"></a>
      <a id="idm140124620991040" class="indexterm"></a>
      <a id="idm140124620990464" class="indexterm"></a>

      When a test receives input from both a <code class="literal">@dataProvider</code>
      method and from one or more tests it <code class="literal">@depends</code> on, the
      arguments from the data provider will come before the ones from
      depended-upon tests. The arguments from depended-upon tests will be the
      same for each data set.
      See <a class="xref" href="#writing-tests-for-phpunit.data-providers.examples.DependencyAndDataProviderCombo.php" title="Example 4.8: Combination of @depends and @dataProvider in same test">Example 4.8</a>
    </p><div class="example"><a id="writing-tests-for-phpunit.data-providers.examples.DependencyAndDataProviderCombo.php"></a><p class="title"><strong>Example 4.8: Combination of @depends and @dataProvider in same test</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class DependencyAndDataProviderComboTest extends PHPUnit_Framework_TestCase
{
    public function provider()
    {
        return array(array('provider1'), array('provider2'));
    }

    public function testProducerFirst()
    {
        $this-&gt;assertTrue(true);
        return 'first';
    }

    public function testProducerSecond()
    {
        $this-&gt;assertTrue(true);
        return 'second';
    }

    /**
     * @depends testProducerFirst
     * @depends testProducerSecond
     * @dataProvider provider
     */
    public function testConsumer()
    {
        $this-&gt;assertEquals(
            array('provider1', 'first', 'second'),
            func_get_args()
        );
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit --verbose DependencyAndDataProviderComboTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

...F

Time: 0 seconds, Memory: 3.50Mb

There was 1 failure:

1) DependencyAndDataProviderComboTest::testConsumer with data set #1 ('provider2')
Failed asserting that two arrays are equal.
--- Expected
+++ Actual
@@ @@
Array (
-    0 =&gt; 'provider1'
+    0 =&gt; 'provider2'
1 =&gt; 'first'
2 =&gt; 'second'
)

/home/sb/DependencyAndDataProviderComboTest.php:31

FAILURES!
Tests: 4, Assertions: 4, Failures: 1.
</pre></div></div><br class="example-break" /><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        <a id="idm140124620983808" class="indexterm"></a>
        <a id="idm140124620983232" class="indexterm"></a>
        <a id="idm140124620982656" class="indexterm"></a>

        When a test depends on a test that uses data providers, the depending
        test will be executed when the test it depends upon is successful for at
        least one data set. The result of a test that uses data providers cannot
        be injected into a depending test.
      </p></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        <a id="idm140124620980912" class="indexterm"></a>
        <a id="idm140124620980336" class="indexterm"></a>
        <a id="idm140124620979760" class="indexterm"></a>

        All data providers are executed before both the call to the <code class="literal">setUpBeforeClass</code>
        static method and the first call to the <code class="literal">setUp</code> method.
        Because of that you can't access any variables you create there from
        within a data provider. This is required in order for PHPUnit to be able
        to compute the total number of tests.
      </p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="writing-tests-for-phpunit.exceptions"></a>Testing Exceptions</h2></div></div></div><p>
      <a id="idm140124620976208" class="indexterm"></a>
      <a id="idm140124620975632" class="indexterm"></a>

      <a class="xref" href="#writing-tests-for-phpunit.exceptions.examples.ExceptionTest.php" title="Example 4.9: Using the @expectedException annotation">Example 4.9</a>
      shows how to use the <code class="literal">@expectedException</code> annotation to
      test whether an exception is thrown inside the tested code.
    </p><div class="example"><a id="writing-tests-for-phpunit.exceptions.examples.ExceptionTest.php"></a><p class="title"><strong>Example 4.9: Using the @expectedException annotation</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class ExceptionTest extends PHPUnit_Framework_TestCase
{
    /**
     * @expectedException InvalidArgumentException
     */
    public function testException()
    {
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit ExceptionTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 4.75Mb

There was 1 failure:

1) ExceptionTest::testException
Expected exception InvalidArgumentException


FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /><p>
      <a id="idm140124620970688" class="indexterm"></a>
      <a id="idm140124620970112" class="indexterm"></a>
      <a id="idm140124620969536" class="indexterm"></a>
      <a id="idm140124620968944" class="indexterm"></a>

      Additionally, you can use <code class="literal">@expectedExceptionMessage</code>
      and <code class="literal">@expectedExceptionCode</code> in combination with
      <code class="literal">@expectedException</code> to test the exception message and
      exception code as shown in
      <a class="xref" href="#writing-tests-for-phpunit.exceptions.examples.ExceptionTest2.php" title="Example 4.10: Using the @expectedExceptionMessage and @expectedExceptionCode annotations">Example 4.10</a>.
    </p><div class="example"><a id="writing-tests-for-phpunit.exceptions.examples.ExceptionTest2.php"></a><p class="title"><strong>Example 4.10: Using the @expectedExceptionMessage and @expectedExceptionCode annotations</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class ExceptionTest extends PHPUnit_Framework_TestCase
{
    /**
     * @expectedException        InvalidArgumentException
     * @expectedExceptionMessage Right Message
     */
    public function testExceptionHasRightMessage()
    {
        throw new InvalidArgumentException('Some Message', 10);
    }

    /**
     * @expectedException     InvalidArgumentException
     * @expectedExceptionCode 20
     */
    public function testExceptionHasRightCode()
    {
        throw new InvalidArgumentException('Some Message', 10);
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit ExceptionTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

FF

Time: 0 seconds, Memory: 3.00Mb

There were 2 failures:

1) ExceptionTest::testExceptionHasRightMessage
Failed asserting that exception message 'Some Message' contains 'Right Message'.


2) ExceptionTest::testExceptionHasRightCode
Failed asserting that expected exception code 20 is equal to 10.


FAILURES!
Tests: 2, Assertions: 4, Failures: 2.</pre></div></div><br class="example-break" /><p>
      More examples of <code class="literal">@expectedExceptionMessage</code> and <code class="literal">@expectedExceptionCode</code>
      are shown in <a class="xref" href="#appendixes.annotations.expectedExceptionMessage" title="@expectedExceptionMessage">the section called “@expectedExceptionMessage”</a> and
      <a class="xref" href="#appendixes.annotations.expectedExceptionCode" title="@expectedExceptionCode">the section called “@expectedExceptionCode”</a> respectively.
    </p><p>
      Alternatively, you can use the <code class="literal">setExpectedException()</code>
      method to set the expected exception as shown in <a class="xref" href="#writing-tests-for-phpunit.exceptions.examples.ExceptionTest3.php" title="Example 4.11: Expecting an exception to be raised by the tested code">Example 4.11</a>.
    </p><div class="example"><a id="writing-tests-for-phpunit.exceptions.examples.ExceptionTest3.php"></a><p class="title"><strong>Example 4.11: Expecting an exception to be raised by the tested code</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class ExceptionTest extends PHPUnit_Framework_TestCase
{
    public function testException()
    {
        $this-&gt;setExpectedException('InvalidArgumentException');
    }

    public function testExceptionHasRightMessage()
    {
        $this-&gt;setExpectedException(
          'InvalidArgumentException', 'Right Message'
        );
        throw new InvalidArgumentException('Some Message', 10);
    }

    public function testExceptionHasRightCode()
    {
        $this-&gt;setExpectedException(
          'InvalidArgumentException', 'Right Message', 20
        );
        throw new InvalidArgumentException('The Right Message', 10);
    }
}?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit ExceptionTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

FFF

Time: 0 seconds, Memory: 3.00Mb

There were 3 failures:

1) ExceptionTest::testException
Expected exception InvalidArgumentException


2) ExceptionTest::testExceptionHasRightMessage
Failed asserting that exception message 'Some Message' contains 'Right Message'.


3) ExceptionTest::testExceptionHasRightCode
Failed asserting that expected exception code 20 is equal to 10.


FAILURES!
Tests: 3, Assertions: 6, Failures: 3.</pre></div></div><br class="example-break" /><p>
      <a class="xref" href="#writing-tests-for-phpunit.exceptions.tables.api" title="Table 4.1. Methods for testing exceptions">Table 4.1</a>
      shows the methods provided for testing exceptions.
    </p><div class="table"><a id="writing-tests-for-phpunit.exceptions.tables.api"></a><p class="title"><strong>Table 4.1. Methods for testing exceptions</strong></p><div class="table-contents"><table class="table" summary="Methods for testing exceptions" border="1"><colgroup><col /><col /></colgroup><thead><tr><th align="left">Method</th><th align="left">Meaning</th></tr></thead><tbody><tr><td align="left"><code class="literal">void setExpectedException(string $exceptionName[, string $exceptionMessage = '', integer $exceptionCode = NULL])</code></td><td align="left">Set the expected <code class="literal">$exceptionName</code>, <code class="literal">$exceptionMessage</code>, and <code class="literal">$exceptionCode</code>.</td></tr><tr><td align="left"><code class="literal">String getExpectedException()</code></td><td align="left">Return the name of the expected exception.</td></tr></tbody></table></div></div><br class="table-break" /><p>
      You can also use the approach shown in
      <a class="xref" href="#writing-tests-for-phpunit.exceptions.examples.ExceptionTest4.php" title="Example 4.12: Alternative approach to testing exceptions">Example 4.12</a>
      to test exceptions.
    </p><div class="example"><a id="writing-tests-for-phpunit.exceptions.examples.ExceptionTest4.php"></a><p class="title"><strong>Example 4.12: Alternative approach to testing exceptions</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class ExceptionTest extends PHPUnit_Framework_TestCase {
    public function testException() {
        try {
            // ... Code that is expected to raise an exception ...
        }

        catch (InvalidArgumentException $expected) {
            return;
        }

        $this-&gt;fail('An expected exception has not been raised.');
    }
}
?&gt;</pre></div></div><br class="example-break" /><p>
      If the code that is expected to raise an exception in <a class="xref" href="#writing-tests-for-phpunit.exceptions.examples.ExceptionTest4.php" title="Example 4.12: Alternative approach to testing exceptions">Example 4.12</a>
      does not raise the expected exception, the subsequent call to
      <code class="literal">fail()</code> will halt the test and signal a problem with the
      test. If the expected exception is raised, the <code class="literal">catch</code>
      block will be executed, and the test will end successfully.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="writing-tests-for-phpunit.errors"></a>Testing PHP Errors</h2></div></div></div><p>
      <a id="idm140124620937840" class="indexterm"></a>
      <a id="idm140124620937264" class="indexterm"></a>
      <a id="idm140124620936688" class="indexterm"></a>
      <a id="idm140124620936112" class="indexterm"></a>
      <a id="idm140124620935536" class="indexterm"></a>

      By default, PHPUnit converts PHP errors, warnings, and notices that are
      triggered during the execution of a test to an exception. Using these
      exceptions, you can, for instance, expect a test to trigger a PHP error as
      shown in <a class="xref" href="#writing-tests-for-phpunit.exceptions.examples.ErrorTest.php" title="Example 4.13: Expecting a PHP error using @expectedException">Example 4.13</a>.
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        PHP's <code class="literal">error_reporting</code> runtime configuration can
        limit which errors PHPUnit will convert to exceptions. If you are
        having issues with this feature, be sure PHP is not configured to
        suppress the type of errors you're testing.
      </p></div><div class="example"><a id="writing-tests-for-phpunit.exceptions.examples.ErrorTest.php"></a><p class="title"><strong>Example 4.13: Expecting a PHP error using @expectedException</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class ExpectedErrorTest extends PHPUnit_Framework_TestCase
{
    /**
     * @expectedException PHPUnit_Framework_Error
     */
    public function testFailingInclude()
    {
        include 'not_existing_file.php';
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit -d error_reporting=2 ExpectedErrorTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

.

Time: 0 seconds, Memory: 5.25Mb

OK (1 test, 1 assertion)</pre></div></div><br class="example-break" /><p>
      <a id="idm140124620929344" class="indexterm"></a>
      <a id="idm140124620928752" class="indexterm"></a>

      <code class="literal">PHPUnit_Framework_Error_Notice</code> and
      <code class="literal">PHPUnit_Framework_Error_Warning</code> represent PHP notices
      and warnings, respectively.
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        You should be as specific as possible when testing exceptions. Testing
        for classes that are too generic might lead to undesirable
        side-effects. Accordingly, testing for the <code class="literal">Exception</code>
        class with <code class="literal">@expectedException</code> or
        <code class="literal">setExpectedException()</code> is no longer permitted.
      </p></div><p>
        When testing that relies on php functions that trigger errors like
        <code class="literal">fopen</code> it can sometimes be useful to use error
        suppression while testing. This allows you to check the return values by
        suppressing notices that would lead to a phpunit
        <code class="literal">PHPUnit_Framework_Error_Notice</code>.
        </p><div class="example"><a id="writing-tests-for-phpunit.exceptions.examples.TriggerErrorReturnValue.php"></a><p class="title"><strong>Example 4.14: Testing return values of code that uses PHP Errors</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class ErrorSuppressionTest extends PHPUnit_Framework_TestCase
{
    public function testFileWriting() {
        $writer = new FileWriter;
        $this-&gt;assertFalse(@$writer-&gt;write('/is-not-writeable/file', 'stuff'));
    }
}
class FileWriter
{
    public function write($file, $content) {
        $file = fopen($file, 'w');
        if($file == false) {
            return false;
        }
        // ...
    }
}

?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit ErrorSuppressionTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

.

Time: 1 seconds, Memory: 5.25Mb

OK (1 test, 1 assertion)</pre></div></div><p><br class="example-break" />
    Without the error suppression the test would fail reporting
    <code class="literal">fopen(/is-not-writeable/file): failed to open stream:
    No such file or directory</code>.

    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="writing-tests-for-phpunit.output"></a>Testing Output</h2></div></div></div><p>
      Sometimes you want to assert that the execution of a method, for
      instance, generates an expected output (via <code class="literal">echo</code> or
      <code class="literal">print</code>, for example). The
      <code class="literal">PHPUnit_Framework_TestCase</code> class uses PHP's
      <a class="ulink" href="http://www.php.net/manual/en/ref.outcontrol.php" target="_top">Output
      Buffering</a> feature to provide the functionality that is
      necessary for this.
    </p><p>
      <a class="xref" href="#writing-tests-for-phpunit.output.examples.OutputTest.php" title="Example 4.15: Testing the output of a function or method">Example 4.15</a>
      shows how to use the <code class="literal">expectOutputString()</code> method to
      set the expected output. If this expected output is not generated, the
      test will be counted as a failure.
    </p><div class="example"><a id="writing-tests-for-phpunit.output.examples.OutputTest.php"></a><p class="title"><strong>Example 4.15: Testing the output of a function or method</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class OutputTest extends PHPUnit_Framework_TestCase
{
    public function testExpectFooActualFoo()
    {
        $this-&gt;expectOutputString('foo');
        print 'foo';
    }

    public function testExpectBarActualBaz()
    {
        $this-&gt;expectOutputString('bar');
        print 'baz';
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit OutputTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

.F

Time: 0 seconds, Memory: 5.75Mb

There was 1 failure:

1) OutputTest::testExpectBarActualBaz
Failed asserting that two strings are equal.
--- Expected
+++ Actual
@@ @@
-'bar'
+'baz'


FAILURES!
Tests: 2, Assertions: 2, Failures: 1.</pre></div></div><br class="example-break" /><p>
      <a class="xref" href="#writing-tests-for-phpunit.output.tables.api" title="Table 4.2. Methods for testing output">Table 4.2</a>
      shows the methods provided for testing output
    </p><div class="table"><a id="writing-tests-for-phpunit.output.tables.api"></a><p class="title"><strong>Table 4.2. Methods for testing output</strong></p><div class="table-contents"><table class="table" summary="Methods for testing output" border="1"><colgroup><col /><col /></colgroup><thead><tr><th align="left">Method</th><th align="left">Meaning</th></tr></thead><tbody><tr><td align="left"><code class="literal">void expectOutputRegex(string $regularExpression)</code></td><td align="left">Set up the expectation that the output matches a <code class="literal">$regularExpression</code>.</td></tr><tr><td align="left"><code class="literal">void expectOutputString(string $expectedString)</code></td><td align="left">Set up the expectation that the output is equal to an <code class="literal">$expectedString</code>.</td></tr><tr><td align="left"><code class="literal">bool setOutputCallback(callable $callback)</code></td><td align="left">Sets up a callback that is used to, for instance, normalize the actual output.</td></tr></tbody></table></div></div><br class="table-break" /><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        A test that emits output will fail in strict mode.
      </p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="writing-tests-for-phpunit.assertions"></a>Assertions</h2></div></div></div><p>
      This section lists the various assertion methods that are available.
    </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertArrayHasKey"></a>assertArrayHasKey()</h3></div></div></div><a id="idm140124620895632" class="indexterm"></a><a id="idm140124620895056" class="indexterm"></a><p><code class="literal">assertArrayHasKey(mixed $key, array $array[, string $message = ''])</code></p><p>Reports an error identified by <code class="literal">$message</code> if <code class="literal">$array</code> does not have the <code class="literal">$key</code>.</p><p><code class="literal">assertArrayNotHasKey()</code> is the inverse of this assertion and takes the same arguments.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertArrayHasKey.example"></a><p class="title"><strong>Example 4.16: Usage of assertArrayHasKey()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class ArrayHasKeyTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertArrayHasKey('foo', array('bar' =&gt; 'baz'));
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit ArrayHasKeyTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) ArrayHasKeyTest::testFailure
Failed asserting that an array has the key 'foo'.

/home/sb/ArrayHasKeyTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertClassHasAttribute"></a>assertClassHasAttribute()</h3></div></div></div><a id="idm140124620887216" class="indexterm"></a><a id="idm140124620886624" class="indexterm"></a><p><code class="literal">assertClassHasAttribute(string $attributeName, string $className[, string $message = ''])</code></p><p>Reports an error identified by <code class="literal">$message</code> if <code class="literal">$className::attributeName</code> does not exist.</p><p><code class="literal">assertClassNotHasAttribute()</code> is the inverse of this assertion and takes the same arguments.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertClassHasAttribute.example"></a><p class="title"><strong>Example 4.17: Usage of assertClassHasAttribute()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class ClassHasAttributeTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertClassHasAttribute('foo', 'stdClass');
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit ClassHasAttributeTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 4.75Mb

There was 1 failure:

1) ClassHasAttributeTest::testFailure
Failed asserting that class "stdClass" has attribute "foo".

/home/sb/ClassHasAttributeTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertClassHasStaticAttribute"></a>assertClassHasStaticAttribute()</h3></div></div></div><a id="idm140124620879104" class="indexterm"></a><a id="idm140124620878512" class="indexterm"></a><p><code class="literal">assertClassHasStaticAttribute(string $attributeName, string $className[, string $message = ''])</code></p><p>Reports an error identified by <code class="literal">$message</code> if <code class="literal">$className::attributeName</code> does not exist.</p><p><code class="literal">assertClassNotHasStaticAttribute()</code> is the inverse of this assertion and takes the same arguments.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertClassHasStaticAttribute.example"></a><p class="title"><strong>Example 4.18: Usage of assertClassHasStaticAttribute()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class ClassHasStaticAttributeTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertClassHasStaticAttribute('foo', 'stdClass');
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit ClassHasStaticAttributeTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 4.75Mb

There was 1 failure:

1) ClassHasStaticAttributeTest::testFailure
Failed asserting that class "stdClass" has static attribute "foo".

/home/sb/ClassHasStaticAttributeTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertContains"></a>assertContains()</h3></div></div></div><a id="idm140124620870960" class="indexterm"></a><a id="idm140124620870384" class="indexterm"></a><a id="idm140124620869808" class="indexterm"></a><a id="idm140124620869216" class="indexterm"></a><p><code class="literal">assertContains(mixed $needle, Iterator|array $haystack[, string $message = ''])</code></p><p>Reports an error identified by <code class="literal">$message</code> if <code class="literal">$needle</code> is not an element of <code class="literal">$haystack</code>.</p><p><code class="literal">assertNotContains()</code> is the inverse of this assertion and takes the same arguments.</p><p><code class="literal">assertAttributeContains()</code> and <code class="literal">assertAttributeNotContains()</code> are convenience wrappers that use a <code class="literal">public</code>, <code class="literal">protected</code>, or <code class="literal">private</code> attribute of a class or object as the haystack.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertContains.example"></a><p class="title"><strong>Example 4.19: Usage of assertContains()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class ContainsTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertContains(4, array(1, 2, 3));
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit ContainsTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) ContainsTest::testFailure
Failed asserting that an array contains 4.

/home/sb/ContainsTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /><p><code class="literal">assertContains(string $needle, string $haystack[, string $message = '', boolean $ignoreCase = FALSE])</code></p><p>Reports an error identified by <code class="literal">$message</code> if <code class="literal">$needle</code> is not a substring of <code class="literal">$haystack</code>.</p><p>If <code class="literal">$ignoreCase</code> is <code class="literal">TRUE</code>, the test will be case insensitive.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertContains.example2"></a><p class="title"><strong>Example 4.20: Usage of assertContains()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class ContainsTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertContains('baz', 'foobar');
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit ContainsTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) ContainsTest::testFailure
Failed asserting that 'foobar' contains "baz".

/home/sb/ContainsTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /><div class="example"><a id="appendixes.assertions.assertContains.example3"></a><p class="title"><strong>Example 4.21: Usage of assertContains() with $ignoreCase</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class ContainsTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertContains('foo', 'FooBar');
    }

    public function testOK()
    {
        $this-&gt;assertContains('foo', 'FooBar', '', true);
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit ContainsTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F.

Time: 0 seconds, Memory: 2.75Mb

There was 1 failure:

1) ContainsTest::testFailure
Failed asserting that 'FooBar' contains "foo".

/home/sb/ContainsTest.php:6

FAILURES!
Tests: 2, Assertions: 2, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertContainsOnly"></a>assertContainsOnly()</h3></div></div></div><a id="idm140124620849280" class="indexterm"></a><a id="idm140124620848704" class="indexterm"></a><a id="idm140124620848128" class="indexterm"></a><a id="idm140124620847536" class="indexterm"></a><p><code class="literal">assertContainsOnly(string $type, Iterator|array $haystack[, boolean $isNativeType = NULL, string $message = ''])</code></p><p>Reports an error identified by <code class="literal">$message</code> if <code class="literal">$haystack</code> does not contain only variables of type <code class="literal">$type</code>.</p><p><code class="literal">$isNativeType</code> is a flag used to indicate whether <code class="literal">$type</code> is a native PHP type or not.</p><p><code class="literal">assertNotContainsOnly()</code> is the inverse of this assertion and takes the same arguments.</p><p><code class="literal">assertAttributeContainsOnly()</code> and <code class="literal">assertAttributeNotContainsOnly()</code> are convenience wrappers that use a <code class="literal">public</code>, <code class="literal">protected</code>, or <code class="literal">private</code> attribute of a class or object as the haystack.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertContainsOnly.example"></a><p class="title"><strong>Example 4.22: Usage of assertContainsOnly()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class ContainsOnlyTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertContainsOnly('string', array('1', '2', 3));
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit ContainsOnlyTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) ContainsOnlyTest::testFailure
Failed asserting that Array (
    0 =&gt; '1'
    1 =&gt; '2'
    2 =&gt; 3
) contains only values of type "string".

/home/sb/ContainsOnlyTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertContainsOnlyInstancesOf"></a>assertContainsOnlyInstancesOf()</h3></div></div></div><a id="idm140124620835696" class="indexterm"></a><p><code class="literal">assertContainsOnlyInstancesOf(string $classname, Traversable|array $haystack[, string $message = ''])</code></p><p>Reports an error identified by <code class="literal">$message</code> if <code class="literal">$haystack</code> does not contain only instances of class <code class="literal">$classname</code>.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertContainsOnlyInstancesOf.example"></a><p class="title"><strong>Example 4.23: Usage of assertContainsOnlyInstancesOf()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class ContainsOnlyInstancesOfTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertContainsOnlyInstancesOf('Foo', array(new Foo(), new Bar(), new Foo()));
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit ContainsOnlyInstancesOfTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) ContainsOnlyInstancesOfTest::testFailure
Failed asserting that Array ([0]=&gt; Bar Object(...)) is an instance of class "Foo".

/home/sb/ContainsOnlyInstancesOfTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertCount"></a>assertCount()</h3></div></div></div><a id="idm140124620828432" class="indexterm"></a><a id="idm140124620827856" class="indexterm"></a><p><code class="literal">assertCount($expectedCount, $haystack[, string $message = ''])</code></p><p>Reports an error identified by <code class="literal">$message</code> if the number of elements in <code class="literal">$haystack</code> is not <code class="literal">$expectedCount</code>.</p><p><code class="literal">assertNotCount()</code> is the inverse of this assertion and takes the same arguments.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertCount.example"></a><p class="title"><strong>Example 4.24: Usage of assertCount()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class CountTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertCount(0, array('foo'));
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit CountTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 4.75Mb

There was 1 failure:

1) CountTest::testFailure
Failed asserting that actual size 1 matches expected size 0.

/home/sb/CountTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertEmpty"></a>assertEmpty()</h3></div></div></div><a id="idm140124620820064" class="indexterm"></a><a id="idm140124620819488" class="indexterm"></a><a id="idm140124620818912" class="indexterm"></a><a id="idm140124620818336" class="indexterm"></a><p><code class="literal">assertEmpty(mixed $actual[, string $message = ''])</code></p><p>Reports an error identified by <code class="literal">$message</code> if <code class="literal">$actual</code> is not empty.</p><p><code class="literal">assertNotEmpty()</code> is the inverse of this assertion and takes the same arguments.</p><p><code class="literal">assertAttributeEmpty()</code> and <code class="literal">assertAttributeNotEmpty()</code> are convenience wrappers that can be applied to a <code class="literal">public</code>, <code class="literal">protected</code>, or <code class="literal">private</code> attribute of a class or object.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertEmpty.example"></a><p class="title"><strong>Example 4.25: Usage of assertEmpty()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class EmptyTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertEmpty(array('foo'));
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit EmptyTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 4.75Mb

There was 1 failure:

1) EmptyTest::testFailure
Failed asserting that an array is empty.

/home/sb/EmptyTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertEqualXMLStructure"></a>assertEqualXMLStructure()</h3></div></div></div><a id="idm140124620808416" class="indexterm"></a><p><code class="literal">assertEqualXMLStructure(DOMElement $expectedElement, DOMElement $actualElement[, boolean $checkAttributes = FALSE, string $message = ''])</code></p><p>Reports an error identified by <code class="literal">$message</code> if the XML Structure of the DOMElement in <code class="literal">$actualElement</code> is not equal to the XML structure of the DOMElement in <code class="literal">$expectedElement</code>.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertEqualXMLStructure.example"></a><p class="title"><strong>Example 4.26: Usage of assertEqualXMLStructure()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class EqualXMLStructureTest extends PHPUnit_Framework_TestCase
{
    public function testFailureWithDifferentNodeNames()
    {
        $expected = new DOMElement('foo');
        $actual = new DOMElement('bar');

        $this-&gt;assertEqualXMLStructure($expected, $actual);
    }

    public function testFailureWithDifferentNodeAttributes()
    {
        $expected = new DOMDocument;
        $expected-&gt;loadXML('&lt;foo bar="true" /&gt;');

        $actual = new DOMDocument;
        $actual-&gt;loadXML('&lt;foo/&gt;');

        $this-&gt;assertEqualXMLStructure(
          $expected-&gt;firstChild, $actual-&gt;firstChild, TRUE
        );
    }

    public function testFailureWithDifferentChildrenCount()
    {
        $expected = new DOMDocument;
        $expected-&gt;loadXML('&lt;foo&gt;&lt;bar/&gt;&lt;bar/&gt;&lt;bar/&gt;&lt;/foo&gt;');

        $actual = new DOMDocument;
        $actual-&gt;loadXML('&lt;foo&gt;&lt;bar/&gt;&lt;/foo&gt;');

        $this-&gt;assertEqualXMLStructure(
          $expected-&gt;firstChild, $actual-&gt;firstChild
        );
    }

    public function testFailureWithDifferentChildren()
    {
        $expected = new DOMDocument;
        $expected-&gt;loadXML('&lt;foo&gt;&lt;bar/&gt;&lt;bar/&gt;&lt;bar/&gt;&lt;/foo&gt;');

        $actual = new DOMDocument;
        $actual-&gt;loadXML('&lt;foo&gt;&lt;baz/&gt;&lt;baz/&gt;&lt;baz/&gt;&lt;/foo&gt;');

        $this-&gt;assertEqualXMLStructure(
          $expected-&gt;firstChild, $actual-&gt;firstChild
        );
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit EqualXMLStructureTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

FFFF

Time: 0 seconds, Memory: 5.75Mb

There were 4 failures:

1) EqualXMLStructureTest::testFailureWithDifferentNodeNames
Failed asserting that two strings are equal.
--- Expected
+++ Actual
@@ @@
-'foo'
+'bar'

/home/sb/EqualXMLStructureTest.php:9

2) EqualXMLStructureTest::testFailureWithDifferentNodeAttributes
Number of attributes on node "foo" does not match
Failed asserting that 0 matches expected 1.

/home/sb/EqualXMLStructureTest.php:22

3) EqualXMLStructureTest::testFailureWithDifferentChildrenCount
Number of child nodes of "foo" differs
Failed asserting that 1 matches expected 3.

/home/sb/EqualXMLStructureTest.php:35

4) EqualXMLStructureTest::testFailureWithDifferentChildren
Failed asserting that two strings are equal.
--- Expected
+++ Actual
@@ @@
-'bar'
+'baz'

/home/sb/EqualXMLStructureTest.php:48

FAILURES!
Tests: 4, Assertions: 8, Failures: 4.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertEquals"></a>assertEquals()</h3></div></div></div><a id="idm140124620799360" class="indexterm"></a><a id="idm140124620798784" class="indexterm"></a><a id="idm140124620798208" class="indexterm"></a><a id="idm140124620797632" class="indexterm"></a><p><code class="literal">assertEquals(mixed $expected, mixed $actual[, string $message = ''])</code></p><p>Reports an error identified by <code class="literal">$message</code> if the two variables <code class="literal">$expected</code> and <code class="literal">$actual</code> are not equal.</p><p><code class="literal">assertNotEquals()</code> is the inverse of this assertion and takes the same arguments.</p><p><code class="literal">assertAttributeEquals()</code> and <code class="literal">assertAttributeNotEquals()</code> are convenience wrappers that use a <code class="literal">public</code>, <code class="literal">protected</code>, or <code class="literal">private</code> attribute of a class or object as the actual value.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertEquals.example"></a><p class="title"><strong>Example 4.27: Usage of assertEquals()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class EqualsTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertEquals(1, 0);
    }

    public function testFailure2()
    {
        $this-&gt;assertEquals('bar', 'baz');
    }

    public function testFailure3()
    {
        $this-&gt;assertEquals("foo\nbar\nbaz\n", "foo\nbah\nbaz\n");
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit EqualsTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

FFF

Time: 0 seconds, Memory: 5.25Mb

There were 3 failures:

1) EqualsTest::testFailure
Failed asserting that 0 matches expected 1.

/home/sb/EqualsTest.php:6

2) EqualsTest::testFailure2
Failed asserting that two strings are equal.
--- Expected
+++ Actual
@@ @@
-'bar'
+'baz'

/home/sb/EqualsTest.php:11

3) EqualsTest::testFailure3
Failed asserting that two strings are equal.
--- Expected
+++ Actual
@@ @@
 'foo
-bar
+bah
 baz
 '

/home/sb/EqualsTest.php:16

FAILURES!
Tests: 3, Assertions: 3, Failures: 3.</pre></div></div><br class="example-break" /><p>More specialized comparisons are used for specific argument types for <code class="literal">$expected</code> and <code class="literal">$actual</code>, see below.</p><p><code class="literal">assertEquals(float $expected, float $actual[, string $message = '', float $delta = 0])</code></p><p>Reports an error identified by <code class="literal">$message</code> if the two floats <code class="literal">$expected</code> and <code class="literal">$actual</code> are not within <code class="literal">$delta</code> of each other.</p><p>Please read "<a class="ulink" href="http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html" target="_top">What Every Computer Scientist Should Know About Floating-Point Arithmetic</a>" to understand why <code class="literal">$delta</code> is neccessary.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertEquals.example2"></a><p class="title"><strong>Example 4.28: Usage of assertEquals() with floats</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class EqualsTest extends PHPUnit_Framework_TestCase
{
    public function testSuccess()
    {
        $this-&gt;assertEquals(1.0, 1.1, '', 0.2);
    }

    public function testFailure()
    {
        $this-&gt;assertEquals(1.0, 1.1);
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit EqualsTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

.F

Time: 0 seconds, Memory: 5.75Mb

There was 1 failure:

1) EqualsTest::testFailure
Failed asserting that 1.1 matches expected 1.0.

/home/sb/EqualsTest.php:11

FAILURES!
Tests: 2, Assertions: 2, Failures: 1.</pre></div></div><br class="example-break" /><p><code class="literal">assertEquals(DOMDocument $expected, DOMDocument $actual[, string $message = ''])</code></p><p>Reports an error identified by <code class="literal">$message</code> if the uncommented canonical form of the XML documents represented by the two DOMDocument objects <code class="literal">$expected</code> and <code class="literal">$actual</code> are not equal.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertEquals.example3"></a><p class="title"><strong>Example 4.29: Usage of assertEquals() with DOMDocument objects</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class EqualsTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $expected = new DOMDocument;
        $expected-&gt;loadXML('&lt;foo&gt;&lt;bar/&gt;&lt;/foo&gt;');

        $actual = new DOMDocument;
        $actual-&gt;loadXML('&lt;bar&gt;&lt;foo/&gt;&lt;/bar&gt;');

        $this-&gt;assertEquals($expected, $actual);
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit EqualsTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) EqualsTest::testFailure
Failed asserting that two DOM documents are equal.
--- Expected
+++ Actual
@@ @@
 &lt;?xml version="1.0"?&gt;
-&lt;foo&gt;
-  &lt;bar/&gt;
-&lt;/foo&gt;
+&lt;bar&gt;
+  &lt;foo/&gt;
+&lt;/bar&gt;

/home/sb/EqualsTest.php:12

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /><p><code class="literal">assertEquals(object $expected, object $actual[, string $message = ''])</code></p><p>Reports an error identified by <code class="literal">$message</code> if the two objects <code class="literal">$expected</code> and <code class="literal">$actual</code> do not have equal attribute values.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertEquals.example4"></a><p class="title"><strong>Example 4.30: Usage of assertEquals() with objects</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class EqualsTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $expected = new stdClass;
        $expected-&gt;foo = 'foo';
        $expected-&gt;bar = 'bar';

        $actual = new stdClass;
        $actual-&gt;foo = 'bar';
        $actual-&gt;baz = 'bar';

        $this-&gt;assertEquals($expected, $actual);
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit EqualsTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.25Mb

There was 1 failure:

1) EqualsTest::testFailure
Failed asserting that two objects are equal.
--- Expected
+++ Actual
@@ @@
 stdClass Object (
-    'foo' =&gt; 'foo'
-    'bar' =&gt; 'bar'
+    'foo' =&gt; 'bar'
+    'baz' =&gt; 'bar'
 )

/home/sb/EqualsTest.php:14

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /><p><code class="literal">assertEquals(array $expected, array $actual[, string $message = ''])</code></p><p>Reports an error identified by <code class="literal">$message</code> if the two arrays <code class="literal">$expected</code> and <code class="literal">$actual</code> are not equal.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertEquals.example5"></a><p class="title"><strong>Example 4.31: Usage of assertEquals() with arrays</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class EqualsTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertEquals(array('a', 'b', 'c'), array('a', 'c', 'd'));
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit EqualsTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.25Mb

There was 1 failure:

1) EqualsTest::testFailure
Failed asserting that two arrays are equal.
--- Expected
+++ Actual
@@ @@
 Array (
     0 =&gt; 'a'
-    1 =&gt; 'b'
-    2 =&gt; 'c'
+    1 =&gt; 'c'
+    2 =&gt; 'd'
 )

/home/sb/EqualsTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertFalse"></a>assertFalse()</h3></div></div></div><a id="idm140124620761344" class="indexterm"></a><p><code class="literal">assertFalse(bool $condition[, string $message = ''])</code></p><p>Reports an error identified by <code class="literal">$message</code> if <code class="literal">$condition</code> is <code class="literal">TRUE</code>.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertFalse.example"></a><p class="title"><strong>Example 4.32: Usage of assertFalse()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class FalseTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertFalse(TRUE);
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit FalseTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) FalseTest::testFailure
Failed asserting that true is false.

/home/sb/FalseTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertFileEquals"></a>assertFileEquals()</h3></div></div></div><a id="idm140124620754400" class="indexterm"></a><a id="idm140124620753824" class="indexterm"></a><p><code class="literal">assertFileEquals(string $expected, string $actual[, string $message = ''])</code></p><p>Reports an error identified by <code class="literal">$message</code>  if the file specified by <code class="literal">$expected</code> does not have the same contents as the file specified by <code class="literal">$actual</code>.</p><p><code class="literal">assertFileNotEquals()</code> is the inverse of this assertion and takes the same arguments.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertFileEquals.example"></a><p class="title"><strong>Example 4.33: Usage of assertFileEquals()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class FileEqualsTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertFileEquals('/home/sb/expected', '/home/sb/actual');
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit FileEqualsTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.25Mb

There was 1 failure:

1) FileEqualsTest::testFailure
Failed asserting that two strings are equal.
--- Expected
+++ Actual
@@ @@
-'expected
+'actual
 '

/home/sb/FileEqualsTest.php:6

FAILURES!
Tests: 1, Assertions: 3, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertFileExists"></a>assertFileExists()</h3></div></div></div><a id="idm140124620745872" class="indexterm"></a><a id="idm140124620745296" class="indexterm"></a><p><code class="literal">assertFileExists(string $filename[, string $message = ''])</code></p><p>Reports an error identified by <code class="literal">$message</code> if the file specified by <code class="literal">$filename</code> does not exist.</p><p><code class="literal">assertFileNotExists()</code> is the inverse of this assertion and takes the same arguments.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertFileExists.example"></a><p class="title"><strong>Example 4.34: Usage of assertFileExists()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class FileExistsTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertFileExists('/path/to/file');
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit FileExistsTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 4.75Mb

There was 1 failure:

1) FileExistsTest::testFailure
Failed asserting that file "/path/to/file" exists.

/home/sb/FileExistsTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertGreaterThan"></a>assertGreaterThan()</h3></div></div></div><a id="idm140124620737936" class="indexterm"></a><a id="idm140124620737360" class="indexterm"></a><p><code class="literal">assertGreaterThan(mixed $expected, mixed $actual[, string $message = ''])</code></p><p>Reports an error identified by <code class="literal">$message</code> if the value of <code class="literal">$actual</code> is not greater than the value of <code class="literal">$expected</code>.</p><p><code class="literal">assertAttributeGreaterThan()</code> is a convenience wrapper that uses a <code class="literal">public</code>, <code class="literal">protected</code>, or <code class="literal">private</code> attribute of a class or object as the actual value.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertGreaterThan.example"></a><p class="title"><strong>Example 4.35: Usage of assertGreaterThan()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class GreaterThanTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertGreaterThan(2, 1);
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit GreaterThanTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) GreaterThanTest::testFailure
Failed asserting that 1 is greater than 2.

/home/sb/GreaterThanTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertGreaterThanOrEqual"></a>assertGreaterThanOrEqual()</h3></div></div></div><a id="idm140124620728128" class="indexterm"></a><a id="idm140124620727536" class="indexterm"></a><p><code class="literal">assertGreaterThanOrEqual(mixed $expected, mixed $actual[, string $message = ''])</code></p><p>Reports an error identified by <code class="literal">$message</code> if the value of <code class="literal">$actual</code> is not greater than or equal to the value of <code class="literal">$expected</code>.</p><p><code class="literal">assertAttributeGreaterThanOrEqual()</code> is a convenience wrapper that uses a <code class="literal">public</code>, <code class="literal">protected</code>, or <code class="literal">private</code> attribute of a class or object as the actual value.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertGreaterThanOrEqual.example"></a><p class="title"><strong>Example 4.36: Usage of assertGreaterThanOrEqual()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class GreatThanOrEqualTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertGreaterThanOrEqual(2, 1);
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit GreaterThanOrEqualTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.25Mb

There was 1 failure:

1) GreatThanOrEqualTest::testFailure
Failed asserting that 1 is equal to 2 or is greater than 2.

/home/sb/GreaterThanOrEqualTest.php:6

FAILURES!
Tests: 1, Assertions: 2, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertInstanceOf"></a>assertInstanceOf()</h3></div></div></div><a id="idm140124620718272" class="indexterm"></a><a id="idm140124620717696" class="indexterm"></a><a id="idm140124620717120" class="indexterm"></a><a id="idm140124620716528" class="indexterm"></a><p><code class="literal">assertInstanceOf($expected, $actual[, $message = ''])</code></p><p>Reports an error identified by <code class="literal">$message</code> if <code class="literal">$actual</code> is not an instance of <code class="literal">$expected</code>.</p><p><code class="literal">assertNotInstanceOf()</code> is the inverse of this assertion and takes the same arguments.</p><p><code class="literal">assertAttributeInstanceOf()</code> and <code class="literal">assertAttributeNotInstanceOf()</code> are convenience wrappers that can be applied to a <code class="literal">public</code>, <code class="literal">protected</code>, or <code class="literal">private</code> attribute of a class or object.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertInstanceOf.example"></a><p class="title"><strong>Example 4.37: Usage of assertInstanceOf()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class InstanceOfTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertInstanceOf('RuntimeException', new Exception);
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit InstanceOfTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) InstanceOfTest::testFailure
Failed asserting that Exception Object (...) is an instance of class "RuntimeException".

/home/sb/InstanceOfTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertInternalType"></a>assertInternalType()</h3></div></div></div><a id="idm140124620706064" class="indexterm"></a><a id="idm140124620705488" class="indexterm"></a><a id="idm140124620704912" class="indexterm"></a><a id="idm140124620704320" class="indexterm"></a><p><code class="literal">assertInternalType($expected, $actual[, $message = ''])</code></p><p>Reports an error identified by <code class="literal">$message</code> if <code class="literal">$actual</code> is not of the <code class="literal">$expected</code> type.</p><p><code class="literal">assertNotInternalType()</code> is the inverse of this assertion and takes the same arguments.</p><p><code class="literal">assertAttributeInternalType()</code> and <code class="literal">assertAttributeNotInternalType()</code> are convenience wrappers that can be applied to a <code class="literal">public</code>, <code class="literal">protected</code>, or <code class="literal">private</code> attribute of a class or object.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertInternalType.example"></a><p class="title"><strong>Example 4.38: Usage of assertInternalType()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class InternalTypeTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertInternalType('string', 42);
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit InternalTypeTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) InternalTypeTest::testFailure
Failed asserting that 42 is of type "string".

/home/sb/InternalTypeTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertJsonFileEqualsJsonFile"></a>assertJsonFileEqualsJsonFile()</h3></div></div></div><a id="idm140124620693872" class="indexterm"></a><a id="idm140124620693280" class="indexterm"></a><p><code class="literal">assertJsonFileEqualsJsonFile(mixed $expectedFile, mixed $actualFile[, string $message = ''])</code></p><p>
        Reports an error identified by <code class="literal">$message</code> if the value of <code class="literal">$actualFile</code> does not match the value of
        <code class="literal">$expectedFile</code>.
      </p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertJsonFileEqualsJsonFile.example"></a><p class="title"><strong>Example 4.39: Usage of assertJsonFileEqualsJsonFile()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class JsonFileEqualsJsonFileTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertJsonFileEqualsJsonFile(
          'path/to/fixture/file', 'path/to/actual/file');
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit JsonFileEqualsJsonFileTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) JsonFileEqualsJsonFile::testFailure
Failed asserting that '{"Mascot":"Tux"}' matches JSON string "["Mascott", "Tux", "OS", "Linux"]".

/home/sb/JsonFileEqualsJsonFileTest.php:5

FAILURES!
Tests: 1, Assertions: 3, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertJsonStringEqualsJsonFile"></a>assertJsonStringEqualsJsonFile()</h3></div></div></div><a id="idm140124620686000" class="indexterm"></a><a id="idm140124620685408" class="indexterm"></a><p><code class="literal">assertJsonStringEqualsJsonFile(mixed $expectedFile, mixed $actualJson[, string $message = ''])</code></p><p>
        Reports an error identified by <code class="literal">$message</code> if the value of <code class="literal">$actualJson</code> does not match the value of
        <code class="literal">$expectedFile</code>.
      </p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertJsonStringEqualsJsonFile.example"></a><p class="title"><strong>Example 4.40: Usage of assertJsonStringEqualsJsonFile()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class JsonStringEqualsJsonFileTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertJsonStringEqualsJsonFile(
          'path/to/fixture/file', json_encode(array("Mascot" =&gt; "ux"))
        );
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit JsonStringEqualsJsonFileTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) JsonStringEqualsJsonFile::testFailure
Failed asserting that '{"Mascot":"ux"}' matches JSON string "{"Mascott":"Tux"}".

/home/sb/JsonStringEqualsJsonFileTest.php:5

FAILURES!
Tests: 1, Assertions: 3, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertJsonStringEqualsJsonString"></a>assertJsonStringEqualsJsonString()</h3></div></div></div><a id="idm140124620678080" class="indexterm"></a><a id="idm140124620677488" class="indexterm"></a><p><code class="literal">assertJsonStringEqualsJsonString(mixed $expectedJson, mixed $actualJson[, string $message = ''])</code></p><p>
        Reports an error identified by <code class="literal">$message</code> if the value of <code class="literal">$actualJson</code> does not match the value of
        <code class="literal">$expectedJson</code>.
      </p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertJsonStringEqualsJsonString.example"></a><p class="title"><strong>Example 4.41: Usage of assertJsonStringEqualsJsonString()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class JsonStringEqualsJsonStringTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertJsonStringEqualsJsonString(
          json_encode(array("Mascot" =&gt; "Tux")), json_encode(array("Mascott" =&gt; "ux"))
        );
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit JsonStringEqualsJsonStringTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) JsonStringEqualsJsonStringTest::testFailure
Failed asserting that two objects are equal.
--- Expected
+++ Actual
@@ @@
 stdClass Object (
 -    'Mascot' =&gt; 'Tux'
 +    'Mascot' =&gt; 'ux'
)

/home/sb/JsonStringEqualsJsonStringTest.php:5

FAILURES!
Tests: 1, Assertions: 3, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertLessThan"></a>assertLessThan()</h3></div></div></div><a id="idm140124620670112" class="indexterm"></a><a id="idm140124620669536" class="indexterm"></a><p><code class="literal">assertLessThan(mixed $expected, mixed $actual[, string $message = ''])</code></p><p>Reports an error identified by <code class="literal">$message</code> if the value of <code class="literal">$actual</code> is not less than the value of <code class="literal">$expected</code>.</p><p><code class="literal">assertAttributeLessThan()</code> is a convenience wrapper that uses a <code class="literal">public</code>, <code class="literal">protected</code>, or <code class="literal">private</code> attribute of a class or object as the actual value.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertLessThan.example"></a><p class="title"><strong>Example 4.42: Usage of assertLessThan()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class LessThanTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertLessThan(1, 2);
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit LessThanTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) LessThanTest::testFailure
Failed asserting that 2 is less than 1.

/home/sb/LessThanTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertLessThanOrEqual"></a>assertLessThanOrEqual()</h3></div></div></div><a id="idm140124620660368" class="indexterm"></a><a id="idm140124620659792" class="indexterm"></a><p><code class="literal">assertLessThanOrEqual(mixed $expected, mixed $actual[, string $message = ''])</code></p><p>Reports an error identified by <code class="literal">$message</code> if the value of <code class="literal">$actual</code> is not less than or equal to the value of <code class="literal">$expected</code>.</p><p><code class="literal">assertAttributeLessThanOrEqual()</code> is a convenience wrapper that uses a <code class="literal">public</code>, <code class="literal">protected</code>, or <code class="literal">private</code> attribute of a class or object as the actual value.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertLessThanOrEqual.example"></a><p class="title"><strong>Example 4.43: Usage of assertLessThanOrEqual()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class LessThanOrEqualTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertLessThanOrEqual(1, 2);
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit LessThanOrEqualTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.25Mb

There was 1 failure:

1) LessThanOrEqualTest::testFailure
Failed asserting that 2 is equal to 1 or is less than 1.

/home/sb/LessThanOrEqualTest.php:6

FAILURES!
Tests: 1, Assertions: 2, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertNull"></a>assertNull()</h3></div></div></div><a id="idm140124620650544" class="indexterm"></a><a id="idm140124620649968" class="indexterm"></a><p><code class="literal">assertNull(mixed $variable[, string $message = ''])</code></p><p>Reports an error identified by <code class="literal">$message</code> if <code class="literal">$variable</code> is not <code class="literal">NULL</code>.</p><p><code class="literal">assertNotNull()</code> is the inverse of this assertion and takes the same arguments.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertNull.example"></a><p class="title"><strong>Example 4.44: Usage of assertNull()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class NullTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertNull('foo');
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit NotNullTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) NullTest::testFailure
Failed asserting that 'foo' is null.

/home/sb/NotNullTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertObjectHasAttribute"></a>assertObjectHasAttribute()</h3></div></div></div><a id="idm140124620642224" class="indexterm"></a><a id="idm140124620641632" class="indexterm"></a><p><code class="literal">assertObjectHasAttribute(string $attributeName, object $object[, string $message = ''])</code></p><p>Reports an error identified by <code class="literal">$message</code> if <code class="literal">$object-&gt;attributeName</code> does not exist.</p><p><code class="literal">assertObjectNotHasAttribute()</code> is the inverse of this assertion and takes the same arguments.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertObjectHasAttribute.example"></a><p class="title"><strong>Example 4.45: Usage of assertObjectHasAttribute()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class ObjectHasAttributeTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertObjectHasAttribute('foo', new stdClass);
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit ObjectHasAttributeTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 4.75Mb

There was 1 failure:

1) ObjectHasAttributeTest::testFailure
Failed asserting that object of class "stdClass" has attribute "foo".

/home/sb/ObjectHasAttributeTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertRegExp"></a>assertRegExp()</h3></div></div></div><a id="idm140124620634160" class="indexterm"></a><a id="idm140124620633584" class="indexterm"></a><p><code class="literal">assertRegExp(string $pattern, string $string[, string $message = ''])</code></p><p>Reports an error identified by <code class="literal">$message</code> if <code class="literal">$string</code> does not match the regular expression <code class="literal">$pattern</code>.</p><p><code class="literal">assertNotRegExp()</code> is the inverse of this assertion and takes the same arguments.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertRegExp.example"></a><p class="title"><strong>Example 4.46: Usage of assertRegExp()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class RegExpTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertRegExp('/foo/', 'bar');
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit RegExpTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) RegExpTest::testFailure
Failed asserting that 'bar' matches PCRE pattern "/foo/".

/home/sb/RegExpTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertStringMatchesFormat"></a>assertStringMatchesFormat()</h3></div></div></div><a id="idm140124620625760" class="indexterm"></a><a id="idm140124620625168" class="indexterm"></a><p><code class="literal">assertStringMatchesFormat(string $format, string $string[, string $message = ''])</code></p><p>Reports an error identified by <code class="literal">$message</code> if the <code class="literal">$string</code> does not match the <code class="literal">$format</code> string.</p><p><code class="literal">assertStringNotMatchesFormat()</code> is the inverse of this assertion and takes the same arguments.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertStringMatchesFormat.example"></a><p class="title"><strong>Example 4.47: Usage of assertStringMatchesFormat()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class StringMatchesFormatTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertStringMatchesFormat('%i', 'foo');
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit StringMatchesFormatTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) StringMatchesFormatTest::testFailure
Failed asserting that 'foo' matches PCRE pattern "/^[+-]?\d+$/s".

/home/sb/StringMatchesFormatTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /><p>The format string may contain the following placeholders:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">%e</code>: Represents a directory separator, for example <code class="literal">/</code> on Linux. </p></li><li class="listitem"><p><code class="literal">%s</code>: One or more of anything (character or white space) except the end of line character.</p></li><li class="listitem"><p><code class="literal">%S</code>: Zero or more of anything (character or white space) except the end of line character.</p></li><li class="listitem"><p><code class="literal">%a</code>: One or more of anything (character or white space) including the end of line character.</p></li><li class="listitem"><p><code class="literal">%A</code>: Zero or more of anything (character or white space) including the end of line character.</p></li><li class="listitem"><p><code class="literal">%w</code>: Zero or more white space characters.</p></li><li class="listitem"><p><code class="literal">%i</code>: A signed integer value, for example <code class="literal">+3142</code>, <code class="literal">-3142</code>.</p></li><li class="listitem"><p><code class="literal">%d</code>: An unsigned integer value, for example <code class="literal">123456</code>.</p></li><li class="listitem"><p><code class="literal">%x</code>: One or more hexadecimal character. That is, characters in the range <code class="literal">0-9</code>, <code class="literal">a-f</code>, <code class="literal">A-F</code>.</p></li><li class="listitem"><p><code class="literal">%f</code>: A floating point number, for example: <code class="literal">3.142</code>, <code class="literal">-3.142</code>, <code class="literal">3.142E-10</code>, <code class="literal">3.142e+10</code>.</p></li><li class="listitem"><p><code class="literal">%c</code>: A single character of any sort.</p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertStringMatchesFormatFile"></a>assertStringMatchesFormatFile()</h3></div></div></div><a id="idm140124620601376" class="indexterm"></a><a id="idm140124620600784" class="indexterm"></a><p><code class="literal">assertStringMatchesFormatFile(string $formatFile, string $string[, string $message = ''])</code></p><p>Reports an error identified by <code class="literal">$message</code> if the <code class="literal">$string</code> does not match the contents of the <code class="literal">$formatFile</code>.</p><p><code class="literal">assertStringNotMatchesFormatFile()</code> is the inverse of this assertion and takes the same arguments.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertStringMatchesFormatFile.example"></a><p class="title"><strong>Example 4.48: Usage of assertStringMatchesFormatFile()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class StringMatchesFormatFileTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertStringMatchesFormatFile('/path/to/expected.txt', 'foo');
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit StringMatchesFormatFileTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) StringMatchesFormatFileTest::testFailure
Failed asserting that 'foo' matches PCRE pattern "/^[+-]?\d+
$/s".

/home/sb/StringMatchesFormatFileTest.php:6

FAILURES!
Tests: 1, Assertions: 2, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertSame"></a>assertSame()</h3></div></div></div><a id="idm140124620592768" class="indexterm"></a><a id="idm140124620592192" class="indexterm"></a><a id="idm140124620591616" class="indexterm"></a><a id="idm140124620591040" class="indexterm"></a><p><code class="literal">assertSame(mixed $expected, mixed $actual[, string $message = ''])</code></p><p>Reports an error identified by <code class="literal">$message</code> if the two variables <code class="literal">$expected</code> and <code class="literal">$actual</code> do not have the same type and value.</p><p><code class="literal">assertNotSame()</code> is the inverse of this assertion and takes the same arguments.</p><p><code class="literal">assertAttributeSame()</code> and <code class="literal">assertAttributeNotSame()</code> are convenience wrappers that use a <code class="literal">public</code>, <code class="literal">protected</code>, or <code class="literal">private</code> attribute of a class or object as the actual value.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertSame.example"></a><p class="title"><strong>Example 4.49: Usage of assertSame()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class SameTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertSame('2204', 2204);
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit SameTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) SameTest::testFailure
Failed asserting that 2204 is identical to '2204'.

/home/sb/SameTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /><p><code class="literal">assertSame(object $expected, object $actual[, string $message = ''])</code></p><p>Reports an error identified by <code class="literal">$message</code> if the two variables <code class="literal">$expected</code> and <code class="literal">$actual</code> do not reference the same object.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertSame.example2"></a><p class="title"><strong>Example 4.50: Usage of assertSame() with objects</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class SameTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertSame(new stdClass, new stdClass);
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit SameTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 4.75Mb

There was 1 failure:

1) SameTest::testFailure
Failed asserting that two variables reference the same object.

/home/sb/SameTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertSelectCount"></a>assertSelectCount()</h3></div></div></div><a id="idm140124620575440" class="indexterm"></a><p><code class="literal">assertSelectCount(array $selector, integer $count, mixed $actual[, string $message = '', boolean $isHtml = TRUE])</code></p><p>Reports an error identified by <code class="literal">$message</code> if the CSS selector <code class="literal">$selector</code> does not match <code class="literal">$count</code> elements in the DOMNode <code class="literal">$actual</code>.</p><p><code class="literal">$count</code> can be one of the following types:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><code class="literal">boolean</code>: Asserts for presence of elements matching the selector (<code class="literal">TRUE</code>) or absence of elements (<code class="literal">FALSE</code>).</li><li class="listitem"><code class="literal">integer</code>: Asserts the count of elements.</li><li class="listitem"><code class="literal">array</code>: Asserts that the count is in a range specified by using <code class="literal">&lt;</code>, <code class="literal">&gt;</code>, <code class="literal">&lt;=</code>, and <code class="literal">&gt;=</code> as keys.</li></ul></div><div class="example"><a id="writing-tests-for-phpunit.assertions.assertSelectCount.example"></a><p class="title"><strong>Example 4.51: Usage of assertSelectCount()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class SelectCountTest extends PHPUnit_Framework_TestCase
{
    protected function setUp()
    {
        $this-&gt;xml = new DomDocument;
        $this-&gt;xml-&gt;loadXML('&lt;foo&gt;&lt;bar/&gt;&lt;bar/&gt;&lt;bar/&gt;&lt;/foo&gt;');
    }

    public function testAbsenceFailure()
    {
        $this-&gt;assertSelectCount('foo bar', FALSE, $this-&gt;xml);
    }

    public function testPresenceFailure()
    {
        $this-&gt;assertSelectCount('foo baz', TRUE, $this-&gt;xml);
    }

    public function testExactCountFailure()
    {
        $this-&gt;assertSelectCount('foo bar', 5, $this-&gt;xml);
    }

    public function testRangeFailure()
    {
        $this-&gt;assertSelectCount('foo bar', array('&gt;'=&gt;6, '&lt;'=&gt;8), $this-&gt;xml);
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit SelectCountTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

FFFF

Time: 0 seconds, Memory: 5.50Mb

There were 4 failures:

1) SelectCountTest::testAbsenceFailure
Failed asserting that true is false.

/home/sb/SelectCountTest.php:12

2) SelectCountTest::testPresenceFailure
Failed asserting that false is true.

/home/sb/SelectCountTest.php:17

3) SelectCountTest::testExactCountFailure
Failed asserting that 3 matches expected 5.

/home/sb/SelectCountTest.php:22

4) SelectCountTest::testRangeFailure
Failed asserting that false is true.

/home/sb/SelectCountTest.php:27

FAILURES!
Tests: 4, Assertions: 4, Failures: 4.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertSelectEquals"></a>assertSelectEquals()</h3></div></div></div><a id="idm140124620560816" class="indexterm"></a><p><code class="literal">assertSelectEquals(array $selector, string $content, integer $count, mixed $actual[, string $message = '', boolean $isHtml = TRUE])</code></p><p>Reports an error identified by <code class="literal">$message</code> if the CSS selector <code class="literal">$selector</code> does not match <code class="literal">$count</code> elements in the DOMNode <code class="literal">$actual</code> with the value <code class="literal">$content</code>.</p><p><code class="literal">$count</code> can be one of the following types:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><code class="literal">boolean</code>: Asserts for presence of elements matching the selector (<code class="literal">TRUE</code>) or absence of elements (<code class="literal">FALSE</code>).</li><li class="listitem"><code class="literal">integer</code>: Asserts the count of elements.</li><li class="listitem"><code class="literal">array</code>: Asserts that the count is in a range specified by using <code class="literal">&lt;</code>, <code class="literal">&gt;</code>, <code class="literal">&lt;=</code>, and <code class="literal">&gt;=</code> as keys.</li></ul></div><div class="example"><a id="writing-tests-for-phpunit.assertions.assertSelectEquals.example"></a><p class="title"><strong>Example 4.52: Usage of assertSelectEquals()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class SelectEqualsTest extends PHPUnit_Framework_TestCase
{
    protected function setUp()
    {
        $this-&gt;xml = new DomDocument;
        $this-&gt;xml-&gt;loadXML('&lt;foo&gt;&lt;bar&gt;Baz&lt;/bar&gt;&lt;bar&gt;Baz&lt;/bar&gt;&lt;/foo&gt;');
    }

    public function testAbsenceFailure()
    {
        $this-&gt;assertSelectEquals('foo bar', 'Baz', FALSE, $this-&gt;xml);
    }

    public function testPresenceFailure()
    {
        $this-&gt;assertSelectEquals('foo bar', 'Bat', TRUE, $this-&gt;xml);
    }

    public function testExactCountFailure()
    {
        $this-&gt;assertSelectEquals('foo bar', 'Baz', 5, $this-&gt;xml);
    }

    public function testRangeFailure()
    {
        $this-&gt;assertSelectEquals('foo bar', 'Baz', array('&gt;'=&gt;6, '&lt;'=&gt;8), $this-&gt;xml);
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit SelectEqualsTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

FFFF

Time: 0 seconds, Memory: 5.50Mb

There were 4 failures:

1) SelectEqualsTest::testAbsenceFailure
Failed asserting that true is false.

/home/sb/SelectEqualsTest.php:12

2) SelectEqualsTest::testPresenceFailure
Failed asserting that false is true.

/home/sb/SelectEqualsTest.php:17

3) SelectEqualsTest::testExactCountFailure
Failed asserting that 2 matches expected 5.

/home/sb/SelectEqualsTest.php:22

4) SelectEqualsTest::testRangeFailure
Failed asserting that false is true.

/home/sb/SelectEqualsTest.php:27

FAILURES!
Tests: 4, Assertions: 4, Failures: 4.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertSelectRegExp"></a>assertSelectRegExp()</h3></div></div></div><a id="idm140124620545664" class="indexterm"></a><p><code class="literal">assertSelectRegExp(array $selector, string $pattern, integer $count, mixed $actual[, string $message = '', boolean $isHtml = TRUE])</code></p><p>Reports an error identified by <code class="literal">$message</code> if the CSS selector <code class="literal">$selector</code> does not match <code class="literal">$count</code> elements in the DOMNode <code class="literal">$actual</code> with a value that matches <code class="literal">$pattern</code>.</p><p><code class="literal">$count</code> can be one of the following types:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><code class="literal">boolean</code>: Asserts for presence of elements matching the selector (<code class="literal">TRUE</code>) or absence of elements (<code class="literal">FALSE</code>).</li><li class="listitem"><code class="literal">integer</code>: Asserts the count of elements.</li><li class="listitem"><code class="literal">array</code>: Asserts that the count is in a range specified by using <code class="literal">&lt;</code>, <code class="literal">&gt;</code>, <code class="literal">&lt;=</code>, and <code class="literal">&gt;=</code> as keys.</li></ul></div><div class="example"><a id="writing-tests-for-phpunit.assertions.assertSelectRegExp.example"></a><p class="title"><strong>Example 4.53: Usage of assertSelectRegExp()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class SelectRegExpTest extends PHPUnit_Framework_TestCase
{
    protected function setUp()
    {
        $this-&gt;xml = new DomDocument;
        $this-&gt;xml-&gt;loadXML('&lt;foo&gt;&lt;bar&gt;Baz&lt;/bar&gt;&lt;bar&gt;Baz&lt;/bar&gt;&lt;/foo&gt;');
    }

    public function testAbsenceFailure()
    {
        $this-&gt;assertSelectRegExp('foo bar', '/Ba.*/', FALSE, $this-&gt;xml);
    }

    public function testPresenceFailure()
    {
        $this-&gt;assertSelectRegExp('foo bar', '/B[oe]z]/', TRUE, $this-&gt;xml);
    }

    public function testExactCountFailure()
    {
        $this-&gt;assertSelectRegExp('foo bar', '/Ba.*/', 5, $this-&gt;xml);
    }

    public function testRangeFailure()
    {
        $this-&gt;assertSelectRegExp('foo bar', '/Ba.*/', array('&gt;'=&gt;6, '&lt;'=&gt;8), $this-&gt;xml);
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit SelectRegExpTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

FFFF

Time: 0 seconds, Memory: 5.50Mb

There were 4 failures:

1) SelectRegExpTest::testAbsenceFailure
Failed asserting that true is false.

/home/sb/SelectRegExpTest.php:12

2) SelectRegExpTest::testPresenceFailure
Failed asserting that false is true.

/home/sb/SelectRegExpTest.php:17

3) SelectRegExpTest::testExactCountFailure
Failed asserting that 2 matches expected 5.

/home/sb/SelectRegExpTest.php:22

4) SelectRegExpTest::testRangeFailure
Failed asserting that false is true.

/home/sb/SelectRegExpTest.php:27

FAILURES!
Tests: 4, Assertions: 4, Failures: 4.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertStringEndsWith"></a>assertStringEndsWith()</h3></div></div></div><a id="idm140124620530464" class="indexterm"></a><a id="idm140124620529888" class="indexterm"></a><p><code class="literal">assertStringEndsWith(string $suffix, string $string[, string $message = ''])</code></p><p>Reports an error identified by <code class="literal">$message</code> if the <code class="literal">$string</code> does not end with <code class="literal">$suffix</code>.</p><p><code class="literal">assertStringEndsNotWith()</code> is the inverse of this assertion and takes the same arguments.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertStringEndsWith.example"></a><p class="title"><strong>Example 4.54: Usage of assertStringEndsWith()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class StringEndsWithTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertStringEndsWith('suffix', 'foo');
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit StringEndsWithTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 1 second, Memory: 5.00Mb

There was 1 failure:

1) StringEndsWithTest::testFailure
Failed asserting that 'foo' ends with "suffix".

/home/sb/StringEndsWithTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertStringEqualsFile"></a>assertStringEqualsFile()</h3></div></div></div><a id="idm140124620521984" class="indexterm"></a><a id="idm140124620521392" class="indexterm"></a><p><code class="literal">assertStringEqualsFile(string $expectedFile, string $actualString[, string $message = ''])</code></p><p>Reports an error identified by <code class="literal">$message</code>  if the file specified by <code class="literal">$expectedFile</code> does not have <code class="literal">$actualString</code> as its contents.</p><p><code class="literal">assertStringNotEqualsFile()</code> is the inverse of this assertion and takes the same arguments.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertStringEqualsFile.example"></a><p class="title"><strong>Example 4.55: Usage of assertStringEqualsFile()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class StringEqualsFileTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertStringEqualsFile('/home/sb/expected', 'actual');
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit StringEqualsFileTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.25Mb

There was 1 failure:

1) StringEqualsFileTest::testFailure
Failed asserting that two strings are equal.
--- Expected
+++ Actual
@@ @@
-'expected
-'
+'actual'

/home/sb/StringEqualsFileTest.php:6

FAILURES!
Tests: 1, Assertions: 2, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertStringStartsWith"></a>assertStringStartsWith()</h3></div></div></div><a id="idm140124620513376" class="indexterm"></a><a id="idm140124620512784" class="indexterm"></a><p><code class="literal">assertStringStartsWith(string $prefix, string $string[, string $message = ''])</code></p><p>Reports an error identified by <code class="literal">$message</code> if the <code class="literal">$string</code> does not start with <code class="literal">$prefix</code>.</p><p><code class="literal">assertStringStartsNotWith()</code> is the inverse of this assertion and takes the same arguments.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertStringStartsWith.example"></a><p class="title"><strong>Example 4.56: Usage of assertStringStartsWith()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class StringStartsWithTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertStringStartsWith('prefix', 'foo');
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit StringStartsWithTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) StringStartsWithTest::testFailure
Failed asserting that 'foo' starts with "prefix".

/home/sb/StringStartsWithTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertTag"></a>assertTag()</h3></div></div></div><a id="idm140124620504896" class="indexterm"></a><a id="idm140124620504320" class="indexterm"></a><p><code class="literal">assertTag(array $matcher, string $actual[, string $message = '', boolean $isHtml = TRUE])</code></p><p>Reports an error identified by <code class="literal">$message</code> if <code class="literal">$actual</code> is not matched by the <code class="literal">$matcher</code>.</p><p><code class="literal">$matcher</code> is an associative array that specifies the match criteria for the assertion:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><code class="literal">id</code>: The node with the given <code class="literal">id</code> attribute must match the corresponsing value.</li><li class="listitem"><code class="literal">tag</code>: The node type must match the corresponding value.</li><li class="listitem"><code class="literal">attributes</code>: The node's attributes must match the corresponsing values in the <code class="literal">$attributes</code> associative array.</li><li class="listitem"><code class="literal">content</code>: The text content must match the given value.</li><li class="listitem"><code class="literal">parent</code>: The node's parent must match the <code class="literal">$parent</code> associative array.</li><li class="listitem"><code class="literal">child</code>: At least one of the node's immediate children must meet the criteria described by the <code class="literal">$child</code> associative array.</li><li class="listitem"><code class="literal">ancestor</code>: At least one of the node's ancestors must meet the criteria described by the <code class="literal">$ancestor</code> associative array.</li><li class="listitem"><code class="literal">descendant</code>: At least one of the node's descendants must meet the criteria described by the <code class="literal">$descendant</code> associative array.</li><li class="listitem"><code class="literal">children</code>: Associative array for counting children of a node.
          <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><code class="literal">count</code>: The number of matching children must be equal to this number.</li><li class="listitem"><code class="literal">less_than</code>: The number of matching children must be less than this number.</li><li class="listitem"><code class="literal">greater_than</code>: The number of matching children must be greater than this number.</li><li class="listitem"><code class="literal">only</code>: Another associative array consisting of the keys to use to match on the children, and only matching children will be counted.</li></ul></div></li></ul></div><p><code class="literal">assertNotTag()</code> is the inverse of this assertion and takes the same arguments.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertTag.example"></a><p class="title"><strong>Example 4.57: Usage of assertTag()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
// Matcher that asserts that there is an element with an id="my_id".
$matcher = array('id' =&gt; 'my_id');

// Matcher that asserts that there is a "span" tag.
$matcher = array('tag' =&gt; 'span');

// Matcher that asserts that there is a "span" tag with the content
// "Hello World".
$matcher = array('tag' =&gt; 'span', 'content' =&gt; 'Hello World');

// Matcher that asserts that there is a "span" tag with content matching the
// regular expression pattern.
$matcher = array('tag' =&gt; 'span', 'content' =&gt; 'regexp:/Try P(HP|ython)/');

// Matcher that asserts that there is a "span" with an "list" class attribute.
$matcher = array(
  'tag'        =&gt; 'span',
  'attributes' =&gt; array('class' =&gt; 'list')
);

// Matcher that asserts that there is a "span" inside of a "div".
$matcher = array(
  'tag'    =&gt; 'span',
  'parent' =&gt; array('tag' =&gt; 'div')
);

// Matcher that asserts that there is a "span" somewhere inside a "table".
$matcher = array(
  'tag'      =&gt; 'span',
  'ancestor' =&gt; array('tag' =&gt; 'table')
);

// Matcher that asserts that there is a "span" with at least one "em" child.
$matcher = array(
  'tag'   =&gt; 'span',
  'child' =&gt; array('tag' =&gt; 'em')
);

// Matcher that asserts that there is a "span" containing a (possibly nested)
// "strong" tag.
$matcher = array(
  'tag'        =&gt; 'span',
  'descendant' =&gt; array('tag' =&gt; 'strong')
);

// Matcher that asserts that there is a "span" containing 5-10 "em" tags as
// immediate children.
$matcher = array(
  'tag'      =&gt; 'span',
  'children' =&gt; array(
    'less_than'    =&gt; 11,
    'greater_than' =&gt; 4,
    'only'         =&gt; array('tag' =&gt; 'em')
  )
);

// Matcher that asserts that there is a "div", with an "ul" ancestor and a "li"
// parent (with class="enum"), and containing a "span" descendant that contains
// an element with id="my_test" and the text "Hello World".
$matcher = array(
  'tag'        =&gt; 'div',
  'ancestor'   =&gt; array('tag' =&gt; 'ul'),
  'parent'     =&gt; array(
    'tag'        =&gt; 'li',
    'attributes' =&gt; array('class' =&gt; 'enum')
  ),
  'descendant' =&gt; array(
    'tag'   =&gt; 'span',
    'child' =&gt; array(
      'id'      =&gt; 'my_test',
      'content' =&gt; 'Hello World'
    )
  )
);

// Use assertTag() to apply a $matcher to a piece of $html.
$this-&gt;assertTag($matcher, $html);

// Use assertTag() to apply a $matcher to a piece of $xml.
$this-&gt;assertTag($matcher, $xml, '', FALSE);
?&gt;</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertThat"></a>assertThat()</h3></div></div></div><a id="idm140124620480656" class="indexterm"></a><p>
        More complex assertions can be formulated using the
        <code class="literal">PHPUnit_Framework_Constraint</code> classes. They can be
        evaluated using the <code class="literal">assertThat()</code> method.
        <a class="xref" href="#writing-tests-for-phpunit.assertions.assertThat.example" title="Example 4.58: Usage of assertThat()">Example 4.58</a> shows how the
        <code class="literal">logicalNot()</code> and <code class="literal">equalTo()</code>
        constraints can be used to express the same assertion as
        <code class="literal">assertNotEquals()</code>.
      </p><p><code class="literal">assertThat(mixed $value, PHPUnit_Framework_Constraint $constraint[, $message = ''])</code></p><p>Reports an error identified by <code class="literal">$message</code> if the <code class="literal">$value</code> does not match the <code class="literal">$constraint</code>.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertThat.example"></a><p class="title"><strong>Example 4.58: Usage of assertThat()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class BiscuitTest extends PHPUnit_Framework_TestCase
{
    public function testEquals()
    {
        $theBiscuit = new Biscuit('Ginger');
        $myBiscuit  = new Biscuit('Ginger');

        $this-&gt;assertThat(
          $theBiscuit,
          $this-&gt;logicalNot(
            $this-&gt;equalTo($myBiscuit)
          )
        );
    }
}
?&gt;</pre></div></div><br class="example-break" /><p>
        <a class="xref" href="#writing-tests-for-phpunit.assertions.assertThat.tables.constraints" title="Table 4.3. Constraints">Table 4.3</a> shows the
        available <code class="literal">PHPUnit_Framework_Constraint</code> classes.
      </p><div class="table"><a id="writing-tests-for-phpunit.assertions.assertThat.tables.constraints"></a><p class="title"><strong>Table 4.3. Constraints</strong></p><div class="table-contents"><table class="table" summary="Constraints" border="1"><colgroup><col /><col /></colgroup><thead><tr><th align="left">Constraint</th><th align="left">Meaning</th></tr></thead><tbody><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_Attribute attribute(PHPUnit_Framework_Constraint $constraint, $attributeName)</code></td><td align="left">Constraint that applies another constraint to an attribute of a class or an object.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_IsAnything anything()</code></td><td align="left">Constraint that accepts any input value.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_ArrayHasKey arrayHasKey(mixed $key)</code></td><td align="left">Constraint that asserts that the array it is evaluated for has a given key.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_TraversableContains contains(mixed $value)</code></td><td align="left">Constraint that asserts that the <code class="literal">array</code> or object that implements the <code class="literal">Iterator</code> interface it is evaluated for contains a given value.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_TraversableContainsOnly containsOnly(string $type)</code></td><td align="left">Constraint that asserts that the <code class="literal">array</code> or object that implements the <code class="literal">Iterator</code> interface it is evaluated for contains only values of a given type.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_TraversableContainsOnly containsOnlyInstancesOf(string $classname)</code></td><td align="left">Constraint that asserts that the <code class="literal">array</code> or object that implements the <code class="literal">Iterator</code> interface it is evaluated for contains only instances of a given classname.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_IsEqual equalTo($value, $delta = 0, $maxDepth = 10)</code></td><td align="left">Constraint that checks if one value is equal to another.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_Attribute attributeEqualTo($attributeName, $value, $delta = 0, $maxDepth = 10)</code></td><td align="left">Constraint that checks if a value is equal to an attribute of a class or of an object.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_FileExists fileExists()</code></td><td align="left">Constraint that checks if the file(name) that it is evaluated for exists.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_GreaterThan greaterThan(mixed $value)</code></td><td align="left">Constraint that asserts that the value it is evaluated for is greater than a given value.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_Or greaterThanOrEqual(mixed $value)</code></td><td align="left">Constraint that asserts that the value it is evaluated for is greater than or equal to a given value.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_ClassHasAttribute classHasAttribute(string $attributeName)</code></td><td align="left">Constraint that asserts that the class it is evaluated for has a given attribute.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_ClassHasStaticAttribute classHasStaticAttribute(string $attributeName)</code></td><td align="left">Constraint that asserts that the class it is evaluated for has a given static attribute.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_ObjectHasAttribute hasAttribute(string $attributeName)</code></td><td align="left">Constraint that asserts that the object it is evaluated for has a given attribute.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_IsIdentical identicalTo(mixed $value)</code></td><td align="left">Constraint that asserts that one value is identical to another.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_IsFalse isFalse()</code></td><td align="left">Constraint that asserts that the value it is evaluated is <code class="literal">FALSE</code>.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_IsInstanceOf isInstanceOf(string $className)</code></td><td align="left">Constraint that asserts that the object it is evaluated for is an instance of a given class.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_IsNull isNull()</code></td><td align="left">Constraint that asserts that the value it is evaluated is <code class="literal">NULL</code>.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_IsTrue isTrue()</code></td><td align="left">Constraint that asserts that the value it is evaluated is <code class="literal">TRUE</code>.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_IsType isType(string $type)</code></td><td align="left">Constraint that asserts that the value it is evaluated for is of a specified type.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_LessThan lessThan(mixed $value)</code></td><td align="left">Constraint that asserts that the value it is evaluated for is smaller than a given value.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_Or lessThanOrEqual(mixed $value)</code></td><td align="left">Constraint that asserts that the value it is evaluated for is smaller than or equal to a given value.</td></tr><tr><td align="left"><code class="literal">logicalAnd()</code></td><td align="left">Logical AND.</td></tr><tr><td align="left"><code class="literal">logicalNot(PHPUnit_Framework_Constraint $constraint)</code></td><td align="left">Logical NOT.</td></tr><tr><td align="left"><code class="literal">logicalOr()</code></td><td align="left">Logical OR.</td></tr><tr><td align="left"><code class="literal">logicalXor()</code></td><td align="left">Logical XOR.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_PCREMatch matchesRegularExpression(string $pattern)</code></td><td align="left">Constraint that asserts that the string it is evaluated for matches a regular expression.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_StringContains stringContains(string $string, bool $case)</code></td><td align="left">Constraint that asserts that the string it is evaluated for contains a given string.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_StringEndsWith stringEndsWith(string $suffix)</code></td><td align="left">Constraint that asserts that the string it is evaluated for ends with a given suffix.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_StringStartsWith stringStartsWith(string $prefix)</code></td><td align="left">Constraint that asserts that the string it is evaluated for starts with a given prefix.</td></tr></tbody></table></div></div><br class="table-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertTrue"></a>assertTrue()</h3></div></div></div><a id="idm140124620395760" class="indexterm"></a><p><code class="literal">assertTrue(bool $condition[, string $message = ''])</code></p><p>Reports an error identified by <code class="literal">$message</code> if <code class="literal">$condition</code> is <code class="literal">FALSE</code>.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertTrue.example"></a><p class="title"><strong>Example 4.59: Usage of assertTrue()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class TrueTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertTrue(FALSE);
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit TrueTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) TrueTest::testFailure
Failed asserting that false is true.

/home/sb/TrueTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertXmlFileEqualsXmlFile"></a>assertXmlFileEqualsXmlFile()</h3></div></div></div><a id="idm140124620388800" class="indexterm"></a><a id="idm140124620388208" class="indexterm"></a><p><code class="literal">assertXmlFileEqualsXmlFile(string $expectedFile, string $actualFile[, string $message = ''])</code></p><p>Reports an error identified by <code class="literal">$message</code> if the XML document in <code class="literal">$actualFile</code> is not equal to the XML document in <code class="literal">$expectedFile</code>.</p><p><code class="literal">assertXmlFileNotEqualsXmlFile()</code> is the inverse of this assertion and takes the same arguments.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertXmlFileEqualsXmlFile.example"></a><p class="title"><strong>Example 4.60: Usage of assertXmlFileEqualsXmlFile()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class XmlFileEqualsXmlFileTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertXmlFileEqualsXmlFile(
          '/home/sb/expected.xml', '/home/sb/actual.xml');
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit XmlFileEqualsXmlFileTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.25Mb

There was 1 failure:

1) XmlFileEqualsXmlFileTest::testFailure
Failed asserting that two DOM documents are equal.
--- Expected
+++ Actual
@@ @@
 &lt;?xml version="1.0"?&gt;
 &lt;foo&gt;
-  &lt;bar/&gt;
+  &lt;baz/&gt;
 &lt;/foo&gt;

/home/sb/XmlFileEqualsXmlFileTest.php:7

FAILURES!
Tests: 1, Assertions: 3, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertXmlStringEqualsXmlFile"></a>assertXmlStringEqualsXmlFile()</h3></div></div></div><a id="idm140124620380096" class="indexterm"></a><a id="idm140124620379504" class="indexterm"></a><p><code class="literal">assertXmlStringEqualsXmlFile(string $expectedFile, string $actualXml[, string $message = ''])</code></p><p>Reports an error identified by <code class="literal">$message</code> if the XML document in <code class="literal">$actualXml</code> is not equal to the XML document in <code class="literal">$expectedFile</code>.</p><p><code class="literal">assertXmlStringNotEqualsXmlFile()</code> is the inverse of this assertion and takes the same arguments.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertXmlStringEqualsXmlFile.example"></a><p class="title"><strong>Example 4.61: Usage of assertXmlStringEqualsXmlFile()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class XmlStringEqualsXmlFileTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertXmlStringEqualsXmlFile(
          '/home/sb/expected.xml', '&lt;foo&gt;&lt;baz/&gt;&lt;/foo&gt;');
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit XmlStringEqualsXmlFileTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.25Mb

There was 1 failure:

1) XmlStringEqualsXmlFileTest::testFailure
Failed asserting that two DOM documents are equal.
--- Expected
+++ Actual
@@ @@
 &lt;?xml version="1.0"?&gt;
 &lt;foo&gt;
-  &lt;bar/&gt;
+  &lt;baz/&gt;
 &lt;/foo&gt;

/home/sb/XmlStringEqualsXmlFileTest.php:7

FAILURES!
Tests: 1, Assertions: 2, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertXmlStringEqualsXmlString"></a>assertXmlStringEqualsXmlString()</h3></div></div></div><a id="idm140124620371376" class="indexterm"></a><a id="idm140124620370784" class="indexterm"></a><p><code class="literal">assertXmlStringEqualsXmlString(string $expectedXml, string $actualXml[, string $message = ''])</code></p><p>Reports an error identified by <code class="literal">$message</code> if the XML document in <code class="literal">$actualXml</code> is not equal to the XML document in <code class="literal">$expectedXml</code>.</p><p><code class="literal">assertXmlStringNotEqualsXmlString()</code> is the inverse of this assertion and takes the same arguments.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertXmlStringEqualsXmlString.example"></a><p class="title"><strong>Example 4.62: Usage of assertXmlStringEqualsXmlString()</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class XmlStringEqualsXmlStringTest extends PHPUnit_Framework_TestCase
{
    public function testFailure()
    {
        $this-&gt;assertXmlStringEqualsXmlString(
          '&lt;foo&gt;&lt;bar/&gt;&lt;/foo&gt;', '&lt;foo&gt;&lt;baz/&gt;&lt;/foo&gt;');
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit XmlStringEqualsXmlStringTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) XmlStringEqualsXmlStringTest::testFailure
Failed asserting that two DOM documents are equal.
--- Expected
+++ Actual
@@ @@
 &lt;?xml version="1.0"?&gt;
 &lt;foo&gt;
-  &lt;bar/&gt;
+  &lt;baz/&gt;
 &lt;/foo&gt;

/home/sb/XmlStringEqualsXmlStringTest.php:7

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="writing-tests-for-phpunit.error-output"></a>Error output</h2></div></div></div><p>
      Whenever a test fails PHPUnit tries its best to provide you with as much
      context as possible that can help to identify the problem.
    </p><div class="example"><a id="writing-tests-for-phpunit.error-output.examples.ArrayDiffTest.php"></a><p class="title"><strong>Example 4.63: Error output generated when an array comparison fails</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class ArrayDiffTest extends PHPUnit_Framework_TestCase
{
    public function testEquality() {
        $this-&gt;assertEquals(
            array(1,2,3 ,4,5,6),
            array(1,2,33,4,5,6)
        );
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit ArrayDiffTest</code></strong>
PHPUnit 3.6.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.25Mb

There was 1 failure:

1) ArrayDiffTest::testEquality
Failed asserting that two arrays are equal.
--- Expected
+++ Actual
@@ @@
 Array (
     0 =&gt; 1
     1 =&gt; 2
-    2 =&gt; 3
+    2 =&gt; 33
     3 =&gt; 4
     4 =&gt; 5
     5 =&gt; 6
 )

/home/sb/ArrayDiffTest.php:7

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /><p>
      In this example only one of the array values differs and the other values
      are shown to provide context on where the error occurred.
    </p><p>
      When the generated output would be long to read PHPUnit will split it up
      and provide a few lines of context around every difference.
    </p><div class="example"><a id="writing-tests-for-phpunit.error-output.examples.LongArrayDiffTest.php"></a><p class="title"><strong>Example 4.64: Error output when an array comparison of an long array fails</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class LongArrayDiffTest extends PHPUnit_Framework_TestCase
{
    public function testEquality() {
        $this-&gt;assertEquals(
            array(0,0,0,0,0,0,0,0,0,0,0,0,1,2,3 ,4,5,6),
            array(0,0,0,0,0,0,0,0,0,0,0,0,1,2,33,4,5,6)
        );
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit LongArrayDiffTest</code></strong>
PHPUnit 3.6.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.25Mb

There was 1 failure:

1) LongArrayDiffTest::testEquality
Failed asserting that two arrays are equal.
--- Expected
+++ Actual
@@ @@
     13 =&gt; 2
-    14 =&gt; 3
+    14 =&gt; 33
     15 =&gt; 4
     16 =&gt; 5
     17 =&gt; 6
 )


/home/sb/LongArrayDiffTest.php:7

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.error-output.edge-cases"></a>Edge cases</h3></div></div></div><p>
        When a comparison fails PHPUnit creates textual representations of the
        input values and compares those. Due to that implementation a diff
        might show more problems than actually exist.
      </p><p>
        This only happens when using assertEquals or other 'weak' comparison
        functions on arrays or objects.
      </p><div class="example"><a id="writing-tests-for-phpunit.error-output.edge-cases.examples.ArrayWeakComparisonTest.php"></a><p class="title"><strong>Example 4.65: Edge case in the diff generation when using weak comparison</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class ArrayWeakComparisonTest extends PHPUnit_Framework_TestCase
{
    public function testEquality() {
        $this-&gt;assertEquals(
            array(1  ,2,3 ,4,5,6),
            array('1',2,33,4,5,6)
        );
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit ArrayWeakComparisonTest</code></strong>
PHPUnit 3.6.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.25Mb

There was 1 failure:

1) ArrayWeakComparisonTest::testEquality
Failed asserting that two arrays are equal.
--- Expected
+++ Actual
@@ @@
 Array (
-    0 =&gt; 1
+    0 =&gt; '1'
     1 =&gt; 2
-    2 =&gt; 3
+    2 =&gt; 33
     3 =&gt; 4
     4 =&gt; 5
     5 =&gt; 6
 )


/home/sb/ArrayWeakComparisonTest.php:7

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /><p>
        In this example the difference in the first index between
        <code class="literal">1</code> and <code class="literal">'1'</code> is
        reported even so assertEquals considers the values as a match.
      </p></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="textui"></a>Chapter 5. The Command-Line Test Runner</h1></div></div></div><p>
    The PHPUnit command-line test runner can be invoked through the
    <code class="filename">phpunit</code> command. The following code shows how to run
    tests with the PHPUnit command-line test runner:
  </p><pre class="screen"><strong class="userinput"><code>phpunit ArrayTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

..

Time: 0 seconds


OK (2 tests, 2 assertions)</pre><p>
    When invoked as shown above, the PHPUnit command-line test runner will look
    for a <code class="filename">ArrayTest.php</code> sourcefile in the current working
    directory, load it, and expect to find a <code class="literal">ArrayTest</code> test
    case class. It will then execute the tests of that class.
  </p><p>
    For each test run, the PHPUnit command-line tool prints one character to
    indicate progress:
  </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">.</code></span></dt><dd><p>
          Printed when the test succeeds.
        </p></dd><dt><span class="term"><code class="literal">F</code></span></dt><dd><p>
          Printed when an assertion fails while running the test method.
        </p></dd><dt><span class="term"><code class="literal">E</code></span></dt><dd><p>
          Printed when an error occurs while running the test method.
        </p></dd><dt><span class="term"><code class="literal">S</code></span></dt><dd><p>
          Printed when the test has been skipped (see
          <a class="xref" href="#incomplete-and-skipped-tests" title="Chapter 9. Incomplete and Skipped Tests">Chapter 9</a>).
        </p></dd><dt><span class="term"><code class="literal">I</code></span></dt><dd><p>
          Printed when the test is marked as being incomplete or not yet
          implemented (see <a class="xref" href="#incomplete-and-skipped-tests" title="Chapter 9. Incomplete and Skipped Tests">Chapter 9</a>).
        </p></dd></dl></div><p>
    <a id="idm140124621730688" class="indexterm"></a>
    <a id="idm140124621730112" class="indexterm"></a>

    PHPUnit distinguishes between <span class="emphasis"><em>failures</em></span> and
    <span class="emphasis"><em>errors</em></span>. A failure is a violated PHPUnit
    assertion such as a failing <code class="literal">assertEquals()</code> call.
    An error is an unexpected exception or a PHP error. Sometimes
    this distinction proves useful since errors tend to be easier to fix
    than failures. If you have a big list of problems, it is best to
    tackle the errors first and see if you have any failures left when
    they are all fixed.
  </p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="textui.clioptions"></a>Command-Line Options</h2></div></div></div><p>
      Let's take a look at the command-line test runner's options in
      the following code:
    </p><pre class="screen"><strong class="userinput"><code>phpunit --help</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

Usage: phpunit [options] UnitTest [UnitTest.php]
       phpunit [options] &lt;directory&gt;

  --log-junit &lt;file&gt;        Log test execution in JUnit XML format to file.
  --log-tap &lt;file&gt;          Log test execution in TAP format to file.
  --log-json &lt;file&gt;         Log test execution in JSON format.

  --coverage-clover &lt;file&gt;  Generate code coverage report in Clover XML format.
  --coverage-html &lt;dir&gt;     Generate code coverage report in HTML format.
  --coverage-php &lt;file&gt;     Serialize PHP_CodeCoverage object to file.
  --coverage-text=&lt;file&gt;    Generate code coverage report in text format.
                            Default to writing to the standard output.

  --testdox-html &lt;file&gt;     Write agile documentation in HTML format to file.
  --testdox-text &lt;file&gt;     Write agile documentation in Text format to file.

  --filter &lt;pattern&gt;        Filter which tests to run.
  --testsuite &lt;pattern&gt;     Filter which testsuite to run.
  --group ...               Only runs tests from the specified group(s).
  --exclude-group ...       Exclude tests from the specified group(s).
  --list-groups             List available test groups.
  --test-suffix ...         Only search for test in files with specified
                            suffix(es). Default: Test.php,.phpt

  --loader &lt;loader&gt;         TestSuiteLoader implementation to use.
  --printer &lt;printer&gt;       TestSuiteListener implementation to use.
  --repeat &lt;times&gt;          Runs the test(s) repeatedly.

  --tap                     Report test execution progress in TAP format.
  --testdox                 Report test execution progress in TestDox format.

  --colors                  Use colors in output.
  --stderr                  Write to STDERR instead of STDOUT.
  --stop-on-error           Stop execution upon first error.
  --stop-on-failure         Stop execution upon first error or failure.
  --stop-on-skipped         Stop execution upon first skipped test.
  --stop-on-incomplete      Stop execution upon first incomplete test.
  --strict                  Run tests in strict mode.
  -v|--verbose              Output more verbose information.
  --debug                   Display debugging information during test execution.

  --process-isolation       Run each test in a separate PHP process.
  --no-globals-backup       Do not backup and restore $GLOBALS for each test.
  --static-backup           Backup and restore static attributes for each test.

  --bootstrap &lt;file&gt;        A "bootstrap" PHP file that is run before the tests.
  -c|--configuration &lt;file&gt; Read configuration from XML file.
  --no-configuration        Ignore default configuration file (phpunit.xml).
  --include-path &lt;path(s)&gt;  Prepend PHP's include_path with given path(s).
  -d key[=value]            Sets a php.ini value.

  -h|--help                 Prints this usage information.
  --version                 Prints the version and exits.</pre><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">phpunit UnitTest</code></span></dt><dd><p>
            Runs the tests that are provided by the class
            <code class="literal">UnitTest</code>. This class is expected to be declared
            in the <code class="filename">UnitTest.php</code> sourcefile.
          </p><p>
            <code class="literal">UnitTest</code> must be either a class that inherits
            from <code class="literal">PHPUnit_Framework_TestCase</code> or a class that
            provides a <code class="literal">public static suite()</code> method which
            returns a <code class="literal">PHPUnit_Framework_Test</code> object, for
            example an instance of the
            <code class="literal">PHPUnit_Framework_TestSuite</code> class.
          </p></dd><dt><span class="term"><code class="literal">phpunit UnitTest UnitTest.php</code></span></dt><dd><p>
            Runs the tests that are provided by the class
            <code class="literal">UnitTest</code>. This class is expected to be declared
            in the specified sourcefile.
          </p></dd><dt><span class="term"><code class="literal">--log-junit</code></span></dt><dd><p>
            Generates a logfile in JUnit XML format for the tests run.
            See <a class="xref" href="#logging" title="Chapter 18. Logging">Chapter 18</a> for more details.
          </p></dd><dt><span class="term"><code class="literal">--log-tap</code></span></dt><dd><p>
            Generates a logfile using the <a class="ulink" href="http://testanything.org/" target="_top">Test Anything Protocol (TAP)</a>
            format for the tests run. See <a class="xref" href="#logging" title="Chapter 18. Logging">Chapter 18</a> for more
            details.
          </p></dd><dt><span class="term"><code class="literal">--log-json</code></span></dt><dd><p>
            Generates a logfile using the
            <a class="ulink" href="http://www.json.org/" target="_top">JSON</a> format.
            See <a class="xref" href="#logging" title="Chapter 18. Logging">Chapter 18</a> for more details.
          </p></dd><dt><span class="term"><code class="literal">--coverage-html</code></span></dt><dd><p>
            Generates a code coverage report in HTML format. See
            <a class="xref" href="#code-coverage-analysis" title="Chapter 14. Code Coverage Analysis">Chapter 14</a> for more details.
          </p><p>
            Please note that this functionality is only available when the
            tokenizer and Xdebug extensions are installed.
          </p></dd><dt><span class="term"><code class="literal">--coverage-clover</code></span></dt><dd><p>
            Generates a logfile in XML format with the code coverage information
            for the tests run. See <a class="xref" href="#logging" title="Chapter 18. Logging">Chapter 18</a> for more details.
          </p><p>
            Please note that this functionality is only available when the
            tokenizer and Xdebug extensions are installed.
          </p></dd><dt><span class="term"><code class="literal">--coverage-php</code></span></dt><dd><p>
            Generates a serialized PHP_CodeCoverage object with the
            code coverage information.
          </p><p>
            Please note that this functionality is only available when the
            tokenizer and Xdebug extensions are installed.
          </p></dd><dt><span class="term"><code class="literal">--coverage-text</code></span></dt><dd><p>
            Generates a logfile or command-line output in human readable format
            with the code coverage information for the tests run.
            See <a class="xref" href="#logging" title="Chapter 18. Logging">Chapter 18</a> for more details.
          </p><p>
            Please note that this functionality is only available when the
            tokenizer and Xdebug extensions are installed.
          </p></dd><dt><span class="term"><code class="literal">--testdox-html</code> and <code class="literal">--testdox-text</code></span></dt><dd><p>
            Generates agile documentation in HTML or plain text format for the
            tests that are run. See <a class="xref" href="#other-uses-for-tests" title="Chapter 15. Other Uses for Tests">Chapter 15</a> for
            more details.
          </p></dd><dt><span class="term"><code class="literal">--filter</code></span></dt><dd><p>
            Only runs tests whose name matches the given regular expression
            pattern. If the pattern is not enclosed in delimiters, PHPUnit
            will enclose the pattern in <code class="literal">/</code> delimiters.
          </p><p>
            The test names to match will be in one of the following formats:
          </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">TestNamespace\TestCaseClass::testMethod</code></span></dt><dd><p>
                  The default test name format is the equivalent of using
                  the <code class="literal">__METHOD__</code> magic constant inside
                  the test method.
                </p></dd><dt><span class="term"><code class="literal">TestNamespace\TestCaseClass::testMethod with data set #0</code></span></dt><dd><p>
                  When a test has a data provider, each iteration of the
                  data gets the current index appended to the end of the
                  default test name.
                </p></dd><dt><span class="term"><code class="literal">TestNamespace\TestCaseClass::testMethod with data set "my named data"</code></span></dt><dd><p>
                  When a test has a data provider that uses named sets, each
                  iteration of the data gets the current name appended to the
                  end of the default test name. See
                  <a class="xref" href="#textui.examples.TestCaseClass.php" title="Example 5.1: Named data sets">Example 5.1</a> for an
                  example of named data sets.
                </p><div class="example"><a id="textui.examples.TestCaseClass.php"></a><p class="title"><strong>Example 5.1: Named data sets</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
namespace TestNamespace;

class TestCaseClass extends \PHPUnit_Framework_TestCase
{
    /**
     * @dataProvider provider
     */
    public function testMethod($data)
    {
        $this-&gt;assertTrue($data);
    }

    public function provider()
    {
        return array(
           'my named data' =&gt; array(true),
           'my data'       =&gt; array(true)
        );
    }
}
?&gt;</pre></div></div><br class="example-break" /></dd><dt><span class="term"><code class="literal">/path/to/my/test.phpt</code></span></dt><dd><p>
                  The test name for a PHPT test is the filesystem path.
                </p></dd></dl></div><p>
            See <a class="xref" href="#textui.examples.filter-patterns" title="Example 5.2: Filter pattern examples">Example 5.2</a> for examples
            of valid filter patterns.
          </p><div class="example"><a id="textui.examples.filter-patterns"></a><p class="title"><strong>Example 5.2: Filter pattern examples</strong></p><div class="example-contents"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">--filter 'TestNamespace\\TestCaseClass::testMethod'</code></p></li><li class="listitem"><p><code class="literal">--filter 'TestNamespace\\TestCaseClass'</code></p></li><li class="listitem"><p><code class="literal">--filter TestNamespace</code></p></li><li class="listitem"><p><code class="literal">--filter TestCaseClass</code></p></li><li class="listitem"><p><code class="literal">--filter testMethod</code></p></li><li class="listitem"><p><code class="literal">--filter '/::testMethod .*"my named data"/'</code></p></li><li class="listitem"><p><code class="literal">--filter '/::testMethod .*#5$/'</code></p></li><li class="listitem"><p><code class="literal">--filter '/::testMethod .*#(5|6|7)$/'</code></p></li></ul></div></div></div><br class="example-break" /></dd><dt><span class="term"><code class="literal">--testsuite</code></span></dt><dd><p>
            Only runs the test suite whose name matches the given pattern.
          </p></dd><dt><span class="term"><code class="literal">--group</code></span></dt><dd><p>
            Only runs tests from the specified group(s). A test can be tagged as
            belonging to a group using the <code class="literal">@group</code> annotation.
          </p><p>
            The <code class="literal">@author</code> annotation is an alias for
            <code class="literal">@group</code> allowing to filter tests based on their
            authors.
          </p></dd><dt><span class="term"><code class="literal">--exclude-group</code></span></dt><dd><p>
            Exclude tests from the specified group(s). A test can be tagged as
            belonging to a group using the <code class="literal">@group</code> annotation.
          </p></dd><dt><span class="term"><code class="literal">--list-groups</code></span></dt><dd><p>
            List available test groups.
          </p></dd><dt><span class="term"><code class="literal">--test-suffix</code></span></dt><dd><p>
            Only search for test files with specified suffix(es).
          </p></dd><dt><span class="term"><code class="literal">--loader</code></span></dt><dd><p>
            Specifies the <code class="literal">PHPUnit_Runner_TestSuiteLoader</code>
            implementation to use.
          </p><p>
            The standard test suite loader will look for the sourcefile in the
            current working directory and in each directory that is specified in
            PHP's <code class="literal">include_path</code> configuration directive.
            A class name such as <code class="literal">Project_Package_Class</code> is
            mapped to the source filename
            <code class="filename">Project/Package/Class.php</code>.
          </p></dd><dt><span class="term"><code class="literal">--printer</code></span></dt><dd><p>
            Specifies the result printer to use. The printer class must extend
            <code class="literal">PHPUnit_Util_Printer</code> and implement the
            <code class="literal">PHPUnit_Framework_TestListener</code> interface.
          </p></dd><dt><span class="term"><code class="literal">--repeat</code></span></dt><dd><p>
            Repeatedly runs the test(s) the specified number of times.
          </p></dd><dt><span class="term"><code class="literal">--tap</code></span></dt><dd><p>
            Reports the test progress using the <a class="ulink" href="http://testanything.org/" target="_top">Test Anything Protocol (TAP)</a>.
            See <a class="xref" href="#logging" title="Chapter 18. Logging">Chapter 18</a> for more details.
          </p></dd><dt><span class="term"><code class="literal">--testdox</code></span></dt><dd><p>
            Reports the test progress as agile documentation. See
            <a class="xref" href="#other-uses-for-tests" title="Chapter 15. Other Uses for Tests">Chapter 15</a> for more details.
          </p></dd><dt><span class="term"><code class="literal">--colors</code></span></dt><dd><p>
            Use colors in output.
            On Windows, use <a class="ulink" href="https://github.com/adoxa/ansicon" target="_top">ANSICON</a> or <a class="ulink" href="https://github.com/Maximus5/ConEmu" target="_top">ConEmu</a>.
          </p></dd><dt><span class="term"><code class="literal">--stderr</code></span></dt><dd><p>
            Optionally print to <code class="literal">STDERR</code> instead of
            <code class="literal">STDOUT</code>.
          </p></dd><dt><span class="term"><code class="literal">--stop-on-error</code></span></dt><dd><p>
            Stop execution upon first error.
          </p></dd><dt><span class="term"><code class="literal">--stop-on-failure</code></span></dt><dd><p>
            Stop execution upon first error or failure.
          </p></dd><dt><span class="term"><code class="literal">--stop-on-skipped</code></span></dt><dd><p>
            Stop execution upon first skipped test.
          </p></dd><dt><span class="term"><code class="literal">--stop-on-incomplete</code></span></dt><dd><p>
            Stop execution upon first incomplete test.
          </p></dd><dt><span class="term"><code class="literal">--strict</code></span></dt><dd><p>
            Run tests in strict mode. When strict mode is enabled:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                Tests that emit output will fail.
              </p></li><li class="listitem"><p>
                Tests with no assertions will fail and will not generate code
                coverage information.
              </p></li><li class="listitem"><p>
                If the <code class="literal">PHP_Invoker</code> package is installed:
              </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                    A test marked as <code class="literal">@large</code> will fail if it
                    takes longer than 60 seconds to execute. This timeout is
                    configurable via the
                    <code class="literal">timeoutForLargeTests</code> attribute in the
                    XML configuration file.
                  </p></li><li class="listitem"><p>
                    A test marked as <code class="literal">@medium</code> will fail if it
                    takes longer than 10 seconds to execute. This timeout is
                    configurable via the
                    <code class="literal">timeoutForMediumTests</code> attribute in the
                    XML configuration file.
                  </p></li><li class="listitem"><p>
                    A test not marked as <code class="literal">@medium</code> or
                    <code class="literal">@large</code> will fail if it takes longer than
                    1 second to execute. This timeout is configurable via the
                    <code class="literal">timeoutForSmallTests</code> attribute in the
                    XML configuration file.
                  </p></li></ul></div></li></ul></div></dd><dt><span class="term"><code class="literal">--verbose</code></span></dt><dd><p>
            Output more verbose information, for instance the names of tests
            that were incomplete or have been skipped.
          </p></dd><dt><span class="term"><code class="literal">--process-isolation</code></span></dt><dd><p>
            Run each test in a separate PHP process.
          </p></dd><dt><span class="term"><code class="literal">--no-globals-backup</code></span></dt><dd><p>
            Do not backup and restore $GLOBALS. See <a class="xref" href="#fixtures.global-state" title="Global State">the section called “Global State”</a>
            for more details.
          </p></dd><dt><span class="term"><code class="literal">--static-backup</code></span></dt><dd><p>
            Backup and restore static attributes of user-defined classes.
            See <a class="xref" href="#fixtures.global-state" title="Global State">the section called “Global State”</a> for more details.
          </p></dd><dt><span class="term"><code class="literal">--bootstrap</code></span></dt><dd><p>
            A "bootstrap" PHP file that is run before the tests.
          </p></dd><dt><span class="term"><code class="literal">--configuration</code>, </span><span class="term"><code class="literal">-c</code></span></dt><dd><p>
            Read configuration from XML file.
            See <a class="xref" href="#appendixes.configuration" title="Appendix C. The XML Configuration File">Appendix C</a> for more details.
          </p><p>
            If <code class="filename">phpunit.xml</code> or
            <code class="filename">phpunit.xml.dist</code> (in that order) exist in the
            current working directory and <code class="literal">--configuration</code> is
            <span class="emphasis"><em>not</em></span> used, the configuration will be automatically
            read from that file.
          </p></dd><dt><span class="term"><code class="literal">--no-configuration</code></span></dt><dd><p>
            Ignore <code class="filename">phpunit.xml</code> and
            <code class="filename">phpunit.xml.dist</code> from the current working
            directory.
          </p></dd><dt><span class="term"><code class="literal">--include-path</code></span></dt><dd><p>
            Prepend PHP's <code class="literal">include_path</code> with given path(s).
          </p></dd><dt><span class="term"><code class="literal">-d</code></span></dt><dd><p>
            Sets the value of the given PHP configuration option.
          </p></dd><dt><span class="term"><code class="literal">--debug</code></span></dt><dd><p>
            Output debug information such as the name of a test when its
            execution starts.
          </p></dd></dl></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="fixtures"></a>Chapter 6. Fixtures</h1></div></div></div><p>
    <a id="idm140124621557776" class="indexterm"></a>

    One of the most time-consuming parts of writing tests is writing the
    code to set the world up in a known state and then return it to its
    original state when the test is complete. This known state is called
    the <span class="emphasis"><em>fixture</em></span> of the test.
  </p><p>
    In <a class="xref" href="#writing-tests-for-phpunit.examples.StackTest.php" title="Example 4.1: Testing array operations with PHPUnit">Example 4.1</a>, the
    fixture was simply the array that is stored in the <code class="literal">$stack</code>
    variable. Most of the time, though, the fixture will be more complex
    than a simple array, and the amount of code needed to set it up will
    grow accordingly. The actual content of the test gets lost in the noise
    of setting up the fixture. This problem gets even worse when you write
    several tests with similar fixtures. Without some help from the testing
    framework, we would have to duplicate the code that sets up the fixture
    for each test we write.
  </p><p>
    <a id="idm140124621554384" class="indexterm"></a>
    <a id="idm140124621553808" class="indexterm"></a>
    <a id="idm140124621553232" class="indexterm"></a>

    PHPUnit supports sharing the setup code. Before a test method is run, a
    template method called <code class="literal">setUp()</code> is invoked.
    <code class="literal">setUp()</code> is where you create the objects against which
    you will test. Once the test method has finished running, whether it
    succeeded or failed, another template method called
    <code class="literal">tearDown()</code> is invoked. <code class="literal">tearDown()</code>
    is where you clean up the objects against which you tested.
  </p><p>
    In <a class="xref" href="#writing-tests-for-phpunit.examples.StackTest2.php" title="Example 4.2: Using the @depends annotation to express dependencies">Example 4.2</a> we
    used the producer-consumer relationship between tests to share a fixture. This
    is not always desired or even possible. <a class="xref" href="#fixtures.examples.StackTest.php" title="Example 6.1: Using setUp() to create the stack fixture">Example 6.1</a>
    shows how we can write the tests of the <code class="literal">StackTest</code> in such
    a way that not the fixture itself is reused but the code that creates it.
    First we declare the instance variable, <code class="literal">$stack</code>, that we
    are going to use instead of a method-local variable. Then we put the
    creation of the <code class="literal">array</code> fixture into the
    <code class="literal">setUp()</code> method. Finally, we remove the redundant code
    from the test methods and use the newly introduced instance variable,
    <code class="literal">$this-&gt;stack</code>, instead of the method-local variable
    <code class="literal">$stack</code> with the <code class="literal">assertEquals()</code>
    assertion method.
  </p><div class="example"><a id="fixtures.examples.StackTest.php"></a><p class="title"><strong>Example 6.1: Using setUp() to create the stack fixture</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class StackTest extends PHPUnit_Framework_TestCase
{
    protected $stack;

    protected function setUp()
    {
        $this-&gt;stack = array();
    }

    public function testEmpty()
    {
        $this-&gt;assertTrue(empty($this-&gt;stack));
    }

    public function testPush()
    {
        array_push($this-&gt;stack, 'foo');
        $this-&gt;assertEquals('foo', $this-&gt;stack[count($this-&gt;stack)-1]);
        $this-&gt;assertFalse(empty($this-&gt;stack));
    }

    public function testPop()
    {
        array_push($this-&gt;stack, 'foo');
        $this-&gt;assertEquals('foo', array_pop($this-&gt;stack));
        $this-&gt;assertTrue(empty($this-&gt;stack));
    }
}
?&gt;</pre></div></div><br class="example-break" /><p>
    <a id="idm140124621480656" class="indexterm"></a>
    <a id="idm140124621480080" class="indexterm"></a>
    <a id="idm140124621479504" class="indexterm"></a>
    <a id="idm140124621478928" class="indexterm"></a>
    <a id="idm140124621478352" class="indexterm"></a>

    The <code class="literal">setUp()</code> and <code class="literal">tearDown()</code> template
    methods are run once for each test method (and on fresh instances) of the
    test case class.
  </p><p>
    <a id="idm140124621476336" class="indexterm"></a>
    <a id="idm140124621475760" class="indexterm"></a>
    <a id="idm140124621475184" class="indexterm"></a>
    <a id="idm140124621474608" class="indexterm"></a>
    <a id="idm140124621474032" class="indexterm"></a>
    <a id="idm140124621473456" class="indexterm"></a>
    <a id="idm140124621472880" class="indexterm"></a>
    <a id="idm140124621472304" class="indexterm"></a>

    In addition, the <code class="literal">setUpBeforeClass()</code> and
    <code class="literal">tearDownAfterClass()</code> template methods are called before
    the first test of the test case class is run and after the last test of the
    test case class is run, respectively.
  </p><p>
    <a id="idm140124621608624" class="indexterm"></a>

    The example below shows all template methods that are available in a test
    case class.
  </p><div class="example"><a id="fixtures.examples.TemplateMethodsTest.php"></a><p class="title"><strong>Example 6.2: Example showing all template methods available</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class TemplateMethodsTest extends PHPUnit_Framework_TestCase
{
    public static function setUpBeforeClass()
    {
        fwrite(STDOUT, __METHOD__ . "\n");
    }

    protected function setUp()
    {
        fwrite(STDOUT, __METHOD__ . "\n");
    }

    protected function assertPreConditions()
    {
        fwrite(STDOUT, __METHOD__ . "\n");
    }

    public function testOne()
    {
        fwrite(STDOUT, __METHOD__ . "\n");
        $this-&gt;assertTrue(TRUE);
    }

    public function testTwo()
    {
        fwrite(STDOUT, __METHOD__ . "\n");
        $this-&gt;assertTrue(FALSE);
    }

    protected function assertPostConditions()
    {
        fwrite(STDOUT, __METHOD__ . "\n");
    }

    protected function tearDown()
    {
        fwrite(STDOUT, __METHOD__ . "\n");
    }

    public static function tearDownAfterClass()
    {
        fwrite(STDOUT, __METHOD__ . "\n");
    }

    protected function onNotSuccessfulTest(Exception $e)
    {
        fwrite(STDOUT, __METHOD__ . "\n");
        throw $e;
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit TemplateMethodsTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

TemplateMethodsTest::setUpBeforeClass
TemplateMethodsTest::setUp
TemplateMethodsTest::assertPreConditions
TemplateMethodsTest::testOne
TemplateMethodsTest::assertPostConditions
TemplateMethodsTest::tearDown
.TemplateMethodsTest::setUp
TemplateMethodsTest::assertPreConditions
TemplateMethodsTest::testTwo
TemplateMethodsTest::tearDown
TemplateMethodsTest::onNotSuccessfulTest
FTemplateMethodsTest::tearDownAfterClass


Time: 0 seconds, Memory: 5.25Mb

There was 1 failure:

1) TemplateMethodsTest::testTwo
Failed asserting that &lt;boolean:false&gt; is true.
/home/sb/TemplateMethodsTest.php:30

FAILURES!
Tests: 2, Assertions: 2, Failures: 1.</pre></div></div><br class="example-break" /><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="fixtures.more-setup-than-teardown"></a>More setUp() than tearDown()</h2></div></div></div><p>
      <code class="literal">setUp()</code> and <code class="literal">tearDown()</code> are nicely
      symmetrical in theory but not in practice. In practice, you only need
      to implement <code class="literal">tearDown()</code> if you have allocated
      external resources like files or sockets in <code class="literal">setUp()</code>.
      If your <code class="literal">setUp()</code> just creates plain PHP objects, you
      can generally ignore <code class="literal">tearDown()</code>. However, if you
      create many objects in your <code class="literal">setUp()</code>, you might want
      to <code class="literal">unset()</code> the variables pointing to those objects
      in your <code class="literal">tearDown()</code> so they can be garbage collected.
      The garbage collection of test case objects is not predictable.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="fixtures.variations"></a>Variations</h2></div></div></div><p>
      What happens when you have two tests with slightly different setups?
      There are two possibilities:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          If the <code class="literal">setUp()</code> code differs only slightly, move
          the code that differs from the <code class="literal">setUp()</code> code to
          the test method.
        </p></li><li class="listitem"><p>
          If you really have a different <code class="literal">setUp()</code>, you need
          a different test case class. Name the class after the difference in
          the setup.
        </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="fixtures.sharing-fixture"></a>Sharing Fixture</h2></div></div></div><p>
      There are few good reasons to share fixtures between tests, but in most
      cases the need to share a fixture between tests stems from an unresolved
      design problem.
    </p><p>
      A good example of a fixture that makes sense to share across several
      tests is a database connection: you log into the database once and reuse
      the database connection instead of creating a new connection for each
      test. This makes your tests run faster.
    </p><p>
      <a id="idm140124621533440" class="indexterm"></a>
      <a id="idm140124621532864" class="indexterm"></a>

      <a class="xref" href="#fixtures.sharing-fixture.examples.DatabaseTest.php" title="Example 6.3: Sharing fixture between the tests of a test suite">Example 6.3</a>
      uses the <code class="literal">setUpBeforeClass()</code> and
      <code class="literal">tearDownAfterClass()</code> template methods to connect to the
      database before the test case class' first test and to disconnect from the
      database after the last test of the test case, respectively.
    </p><div class="example"><a id="fixtures.sharing-fixture.examples.DatabaseTest.php"></a><p class="title"><strong>Example 6.3: Sharing fixture between the tests of a test suite</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class DatabaseTest extends PHPUnit_Framework_TestCase
{
    protected static $dbh;

    public static function setUpBeforeClass()
    {
        self::$dbh = new PDO('sqlite::memory:');
    }

    public static function tearDownAfterClass()
    {
        self::$dbh = NULL;
    }
}
?&gt;</pre></div></div><br class="example-break" /><p>
      It cannot be emphasized enough that sharing fixtures between tests
      reduces the value of the tests. The underlying design problem is
      that objects are not loosely coupled. You will achieve better
      results solving the underlying design problem and then writing tests
      using stubs (see <a class="xref" href="#test-doubles" title="Chapter 10. Test Doubles">Chapter 10</a>), than by creating
      dependencies between tests at runtime and ignoring the opportunity
      to improve your design.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="fixtures.global-state"></a>Global State</h2></div></div></div><p>
      <a class="ulink" href="http://googletesting.blogspot.com/2008/05/tott-using-dependancy-injection-to.html" target="_top">It is hard to test code that uses singletons.</a>
      The same is true for code that uses global variables. Typically, the code
      you want to test is coupled strongly with a global variable and you cannot
      control its creation. An additional problem is the fact that one test's
      change to a global variable might break another test.
    </p><p>
      In PHP, global variables work like this:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>A global variable <code class="literal">$foo = 'bar';</code> is stored as <code class="literal">$GLOBALS['foo'] = 'bar';</code>.</p></li><li class="listitem"><p>The <code class="literal">$GLOBALS</code> variable is a so-called <span class="emphasis"><em>super-global</em></span> variable.</p></li><li class="listitem"><p>Super-global variables are built-in variables that are always available in all scopes.</p></li><li class="listitem"><p>In the scope of a function or method, you may access the global variable <code class="literal">$foo</code> by either directly accessing <code class="literal">$GLOBALS['foo']</code> or by using <code class="literal">global $foo;</code> to create a local variable with a reference to the global variable.</p></li></ul></div><p>
      Besides global variables, static attributes of classes are also part of
      the global state.
    </p><p>
      <a id="idm140124621517040" class="indexterm"></a>
      <a id="idm140124621516464" class="indexterm"></a>

      By default, PHPUnit runs your tests in a way where changes to global
      and super-global variables (<code class="literal">$GLOBALS</code>,
      <code class="literal">$_ENV</code>, <code class="literal">$_POST</code>,
      <code class="literal">$_GET</code>, <code class="literal">$_COOKIE</code>,
      <code class="literal">$_SERVER</code>, <code class="literal">$_FILES</code>,
      <code class="literal">$_REQUEST</code>) do not affect other tests. Optionally, this
      isolation can be extended to static attributes of classes.
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        The implementation of the backup and restore operations for global
        variables and static attributes of classes uses <code class="literal">serialize()</code>
        and <code class="literal">unserialize()</code>.
      </p><p>
        Objects of some classes that are provided by PHP itself, such as
        <code class="literal">PDO</code> for example, cannot be serialized and the backup
        operation will break when such an object is stored in the
        <code class="literal">$GLOBALS</code> array, for instance.
      </p></div><p>
      <a id="idm140124621508224" class="indexterm"></a>
      <a id="idm140124621507520" class="indexterm"></a>

      The <code class="literal">@backupGlobals</code> annotation that is discussed in
      <a class="xref" href="#appendixes.annotations.backupGlobals" title="@backupGlobals">the section called “@backupGlobals”</a> can be used to
      control the backup and restore operations for global variables.
      Alternatively, you can provide a blacklist of global variables that are to
      be excluded from the backup and restore operations like this
      </p><pre class="programlisting">class MyTest extends PHPUnit_Framework_TestCase
{
    protected $backupGlobalsBlacklist = array('globalVariable');

    // ...
}</pre><p>
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        Please note that setting the <code class="literal">$backupGlobalsBlacklist</code>
        attribute inside the <code class="literal">setUp()</code> method, for instance,
        has no effect.
      </p></div><p>
      <a id="idm140124621502688" class="indexterm"></a>
      <a id="idm140124621501984" class="indexterm"></a>

      The <code class="literal">@backupStaticAttributes</code> annotation that is
      discussed in <a class="xref" href="#appendixes.annotations.backupStaticAttributes" title="@backupStaticAttributes">the section called “@backupStaticAttributes”</a>
      can be used to control the backup and restore operations for static
      attributes. Alternatively, you can provide a blacklist of static
      attributes that are to be excluded from the backup and restore operations
      like this </p><pre class="programlisting">class MyTest extends PHPUnit_Framework_TestCase
{
    protected $backupStaticAttributesBlacklist = array(
      'className' =&gt; array('attributeName')
    );

    // ...
}</pre><p>
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        Please note that setting the <code class="literal">$backupStaticAttributesBlacklist</code>
        attribute inside the <code class="literal">setUp()</code> method, for instance,
        has no effect.
      </p></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="organizing-tests"></a>Chapter 7. Organizing Tests</h1></div></div></div><p>
    <a id="idm140124621800768" class="indexterm"></a>

    One of the goals of PHPUnit (see <a class="xref" href="#goals" title="Chapter 2. PHPUnit's Goals">Chapter 2</a>) is that tests
    should be composable: we want to be able to run any number or combination
    of tests together, for instance all tests for the whole project, or the
    tests for all classes of a component that is part of the project, or just
    the tests for a single class.
  </p><p>
    PHPUnit supports different ways of organizing tests and composing them into
    a test suite. This chapter shows the most commonly used approaches.
  </p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="organizing-tests.filesystem"></a>Composing a Test Suite Using the Filesystem</h2></div></div></div><p>
      Probably the easiest way to compose a test suite is to keep all test case
      source files in a test directory. PHPUnit can automatically discover and
      run the tests by recursively traversing the test directory.
    </p><p>
      Lets take a look at the test suite of the
      <a class="ulink" href="http://github.com/sebastianbergmann/money/" target="_top">sebastianbergmann/money</a>
      library. Looking at this project's directory structure, we see that the
      test case classes in the <code class="filename">tests</code> directory mirror the
      package and class structure of the System Under Test (SUT) in the
      <code class="filename">src</code> directory:
    </p><pre class="screen">src                                 tests
`-- Currency.php                    `-- CurrencyTest.php
`-- IntlFormatter.php               `-- IntlFormatterTest.php
`-- Money.php                       `-- MoneyTest.php
`-- autoload.php</pre><p>
      To run all tests for the library we just need to point the PHPUnit
      command-line test runner to the test directory:
    </p><pre class="screen"><strong class="userinput"><code>phpunit tests</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

.................................

Time: 0 seconds

OK (33 tests, 52 assertions)</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        If you point the PHPUnit command-line test runner to a directory it will
        look for <code class="filename">*Test.php</code> files.
      </p></div><p>
      To run only the tests that are declared in the <code class="literal">CurrencyTest</code>
      test case class in <code class="filename">tests/CurrencyTest.php</code> we can use
      the following command:
    </p><pre class="screen"><strong class="userinput"><code>phpunit tests/CurrencyTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

........

Time: 0 seconds

OK (8 tests, 8 assertions)</pre><p>
      For more fine-grained control of which tests to run we can use the
      <code class="literal">--filter</code> option:
    </p><pre class="screen"><strong class="userinput"><code>phpunit --filter testObjectCanBeConstructedForValidConstructorArgument tests</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

..

Time: 0 seconds

OK (2 test, 2 assertions)</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        A drawback of this approach is that we have no control over the order in
        which the tests are run. This can lead to problems with regard to test
        dependencies, see <a class="xref" href="#writing-tests-for-phpunit.test-dependencies" title="Test Dependencies">the section called “Test Dependencies”</a>.
        In the next section you will see how you can make the test execution
        order explicit by using the XML configuration file.
      </p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="organizing-tests.xml-configuration"></a>Composing a Test Suite Using XML Configuration</h2></div></div></div><a id="idm140124621875616" class="indexterm"></a><p>
      PHPUnit's XML configuration file (<a class="xref" href="#appendixes.configuration" title="Appendix C. The XML Configuration File">Appendix C</a>)
      can also be used to compose a test suite.
      <a class="xref" href="#organizing-tests.xml-configuration.examples.phpunit.xml" title="Example 7.1: Composing a Test Suite Using XML Configuration">Example 7.1</a>
      shows a minimal example that will add all <code class="literal">*Test</code> classes
      that are found in <code class="filename">*Test.php</code> files when the
      <code class="filename">tests</code> directory is recursively traversed.
    </p><div class="example"><a id="organizing-tests.xml-configuration.examples.phpunit.xml"></a><p class="title"><strong>Example 7.1: Composing a Test Suite Using XML Configuration</strong></p><div class="example-contents"><pre class="programlisting">&lt;phpunit&gt;
  &lt;testsuites&gt;
    &lt;testsuite name="money"&gt;
      &lt;directory&gt;tests&lt;/directory&gt;
    &lt;/testsuite&gt;
  &lt;/testsuites&gt;
&lt;/phpunit&gt;</pre></div></div><br class="example-break" /><p>
      The order in which tests are executed can be made explicit:
    </p><div class="example"><a id="organizing-tests.xml-configuration.examples.phpunit.xml2"></a><p class="title"><strong>Example 7.2: Composing a Test Suite Using XML Configuration</strong></p><div class="example-contents"><pre class="programlisting">&lt;phpunit&gt;
  &lt;testsuites&gt;
    &lt;testsuite name="money"&gt;
      &lt;file&gt;tests/IntlFormatterTest.php&lt;/file&gt;
      &lt;file&gt;tests/MoneyTest.php&lt;/file&gt;
      &lt;file&gt;tests/CurrencyTest.php&lt;/file&gt;
    &lt;/testsuite&gt;
  &lt;/testsuites&gt;
&lt;/phpunit&gt;</pre></div></div><br class="example-break" /></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="database"></a>Chapter 8. Database Testing</h1></div></div></div><p>
    Many beginner and intermediate unit testing examples in any programming
    language suggest that it is perfectly easy to test your application's logic with
    simple tests. For database-centric applications this is far away from the
    reality. Start using WordPress, TYPO3 or Symfony with Doctrine or Propel,
    for example, and you will easily experience considerable problems with
    PHPUnit: just because the database is so tightly coupled to these libraries.
  </p><p>
    You probably know this scenario from your daily work and projects,
    where you want to put your fresh or experienced PHPUnit skills to
    work and get stuck by one of the following problems:
  </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
        The method you want to test executes a rather large JOIN operation and
        uses the data to calculate some important results.
      </p></li><li class="listitem"><p>
        Your business logic performs a mix of SELECT, INSERT, UPDATE and
        DELETE statements.
      </p></li><li class="listitem"><p>
        You need to setup test data in (possibly much) more than two tables
        to get reasonable initial data for the methods you want to test.
      </p></li></ol></div><p>
    The DbUnit extension considerably simplifies the setup of a database for
    testing purposes and allows you to verify the contents of a database after
    performing a series of operations.
  </p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="database.supported-vendors-for-database-testing"></a>Supported Vendors for Database Testing</h2></div></div></div><p>
      DbUnit currently supports MySQL, PostgreSQL, Oracle and SQLite. Through
      <a class="ulink" href="http://framework.zend.com" target="_top">Zend Framework</a> or
      <a class="ulink" href="http://www.doctrine-project.org" target="_top">Doctrine 2</a>
      integrations it has access to other database systems such as IBM DB2 or
      Microsoft SQL Server.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="database.difficulties-in-database-testing"></a>Difficulties in Database Testing</h2></div></div></div><p>
      There is a good reason why all the examples on unit testing do not include
      interactions with the database: these kind of tests are both complex to
      setup and maintain. While testing against your database you need to take
      care of the following variables:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          The database schema and tables
        </p></li><li class="listitem"><p>
          Inserting the rows required for the test into these tables
        </p></li><li class="listitem"><p>
          Verifying the state of the database after your test has run
        </p></li><li class="listitem"><p>
          Cleanup the database for each new test
        </p></li></ul></div><p>
      Because many database APIs such as PDO, MySQLi or OCI8 are cumbersome to
      use and verbose in writing doing these steps manually is an absolute
      nightmare.
    </p><p>
      Test code should be as short and precise as possible for several reasons:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          You do not want to modify considerable amount of test code for little
          changes in your production code.
        </p></li><li class="listitem"><p>
          You want to be able to read and understand the test code easily,
          even months after writing it.
        </p></li></ul></div><p>
      Additionally you have to realize that the database is essentially a
      global input variable to your code. Two tests in your test suite
      could run against the same database, possibly reusing data multiple
      times. Failures in one test can easily affect the result of the
      following tests making your testing experience very difficult. The
      previously mentioned cleanup step is of major importance
      to solve the <span class="quote">“<span class="quote">database is a global input</span>”</span> problem.
    </p><p>
      DbUnit helps to simplify all these problems with database testing in an
      elegant way.
    </p><p>
      What PHPUnit cannot help you with is the fact that database tests
      are very slow compared to tests not using the database. Depending
      on how large the interactions with your database are your tests
      could run a considerable amount of time. However if you keep the amount of
      data used for each test small and try to test as much code using
      non-database tests you can easily get away in under a minute even
      for large test suites.
    </p><p>
      The <a class="ulink" href="http://www.doctrine-project.org" target="_top">Doctrine 2
      project</a>'s test suite, for example, currently has a test suite of
      about 1000 tests where nearly half of them accesses the database
      and still runs in 15 seconds against a MySQL database on a standard
      desktop computer.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="database.the-four-stages-of-a-database-test"></a>The four stages of a database test</h2></div></div></div><p>
      In his book on xUnit Test Patterns Gerard Meszaros lists the four
      stages of a unit-test:
    </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
          Set up fixture
        </p></li><li class="listitem"><p>
          Exercise System Under Test
        </p></li><li class="listitem"><p>
          Verify outcome
        </p></li><li class="listitem"><p>
          Teardown
        </p></li></ol></div><div class="blockquote"><blockquote class="blockquote"><p>
        <span class="strong"><strong>What is a Fixture?</strong></span>
      </p><p>
        A fixture describes the initial state your application and database
        are in when you execute a test.
      </p></blockquote></div><p>
      Testing the database requires you to hook into at least the
      setup and teardown to clean-up and write the required fixture data
      into your tables. However the database extension has good reason to
      revert the four stages in a database test to resemble the following
      workflow that is executed for each single test:
    </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="database.clean-up-database"></a>1. Clean-Up Database</h3></div></div></div><p>
        Since there is always a first test that runs against the database
        you do not know exactly if there is already data in the tables.
        PHPUnit will execute a TRUNCATE against all the tables you
        specified to reset their status to empty.
      </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="database.set-up-fixture"></a>2. Set up fixture</h3></div></div></div><p>
        PHPUnit will then iterate over all the fixture rows specified and
        insert them into their respective tables.
      </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="database.run-test-verify-outcome-and-teardown"></a>3–5. Run Test, Verify outcome and Teardown</h3></div></div></div><p>
        After the database is reset and loaded with its initial state the
        actual test is executed by PHPUnit. This part of the test code does
        not require awareness of the Database Extension at all, you can
        go on and test whatever you like with your code.
      </p><p>
        In your test use a special assertion called
        <code class="literal">assertDataSetsEqual()</code> for verification purposes,
        however this is entirely optional. This feature will be explained
        in the section <span class="quote">“<span class="quote">Database Assertions</span>”</span>.
      </p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="database.configuration-of-a-phpunit-database-testcase"></a>Configuration of a PHPUnit Database TestCase</h2></div></div></div><p>
      Usually when using PHPUnit your testcases would extend the
      <code class="literal">PHPUnit_Framework_TestCase</code> class in the
      following way:
    </p><pre class="programlisting">&lt;?php
class MyTest extends PHPUnit_Framework_TestCase
{
    public function testCalculate()
    {
        $this-&gt;assertEquals(2, 1 + 1);
    }
}
?&gt;</pre><p>
      If you want to test code that works with the Database Extension the
      setup is a bit more complex and you have to extend a different
      abstract TestCase requiring you to implement two abstract methods
      <code class="literal">getConnection()</code> and
      <code class="literal">getDataSet()</code>:
    </p><pre class="programlisting">&lt;?php
class MyGuestbookTest extends PHPUnit_Extensions_Database_TestCase
{
    /**
     * @return PHPUnit_Extensions_Database_DB_IDatabaseConnection
     */
    public function getConnection()
    {
        $pdo = new PDO('sqlite::memory:');
        return $this-&gt;createDefaultDBConnection($pdo, ':memory:');
    }

    /**
     * @return PHPUnit_Extensions_Database_DataSet_IDataSet
     */
    public function getDataSet()
    {
        return $this-&gt;createFlatXMLDataSet(dirname(__FILE__).'/_files/guestbook-seed.xml');
    }
}
?&gt;</pre><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="database.implementing-getconnection"></a>Implementing getConnection()</h3></div></div></div><p>
        To allow the clean-up and fixture loading functionalities to work
        the PHPUnit Database Extension requires access to a database
        connection abstracted across vendors through the PDO library. It
        is important to note that your application does not need to be
        based on PDO to use PHPUnit's database extension, the connection is
        merely used for the clean-up and fixture setup.
      </p><p>
        In the previous example we create an in-memory Sqlite connection
        and pass it to the <code class="literal">createDefaultDBConnection</code>
        method which wraps the PDO instance and the second parameter (the
        database-name) in a very simple abstraction layer for database
        connections of the type
        <code class="literal">PHPUnit_Extensions_Database_DB_IDatabaseConnection</code>.
      </p><p>
        The section <span class="quote">“<span class="quote">Using the Database Connection</span>”</span> explains
        the API of this interface and how you can make the best use of it.
      </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="database.implementing-getdataset"></a>Implementing getDataSet()</h3></div></div></div><p>
        The <code class="literal">getDataSet()</code> method defines how the initial
        state of the database should look before each test is
        executed. The state of a database is abstracted through the
        concepts DataSet and DataTable both being represented by the
        interfaces
        <code class="literal">PHPUnit_Extensions_Database_DataSet_IDataSet</code> and
        <code class="literal">PHPUnit_Extensions_Database_DataSet_IDataTable</code>.
        The next section will describe in detail how these concepts work
        and what the benefits are for using them in database testing.
      </p><p>
        For the implementation we only need to know that the
        <code class="literal">getDataSet()</code> method is called once during
        <code class="literal">setUp()</code> to retrieve the fixture data-set and
        insert it into the database. In the example we are using a factory
        method <code class="literal">createFlatXMLDataSet($filename)</code> that
        represents a data-set through an XML representation.
      </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="database.what-about-the-database-schema-ddl"></a>What about the Database Schema (DDL)?</h3></div></div></div><p>
        PHPUnit assumes that the database schema with all its tables,
        triggers, sequences and views is created before a test is run. This
        means you as developer have to make sure that the database is
        correctly setup before running the suite.
      </p><p>
        There are several means to achieve this pre-condition to database
        testing.
      </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
            If you are using a persistent database (not Sqlite Memory) you can
            easily setup the database once with tools such as phpMyAdmin for
            MySQL and re-use the database for every test-run.
          </p></li><li class="listitem"><p>
            If you are using libraries such as
            <a class="ulink" href="http://www.doctrine-project.org" target="_top">Doctrine 2</a> or
            <a class="ulink" href="http://www.propelorm.org/" target="_top">Propel</a>
            you can use their APIs to create the database schema you
            need once before you run the tests. You can utilize
            <a class="ulink" href="http://www.phpunit.de/manual/current/en/textui.html" target="_top">PHPUnit's Bootstrap and Configuration</a>
            capabilities to execute this code whenever your tests are run.
          </p></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="database.tip-use-your-own-abstract-database-testcase"></a>Tip: Use your own Abstract Database TestCase</h3></div></div></div><p>
        From the previous implementation example you can easily see that
        <code class="literal">getConnection()</code> method is pretty static and
        could be re-used in different database test-cases. Additionally to
        keep performance of your tests good and database overhead low you
        can refactor the code a little bit to get a generic abstract test
        case for your application, which still allows you to specify a
        different data-fixture for each test case:
      </p><pre class="programlisting">&lt;?php
abstract class MyApp_Tests_DatabaseTestCase extends PHPUnit_Extensions_Database_TestCase
{
    // only instantiate pdo once for test clean-up/fixture load
    static private $pdo = null;

    // only instantiate PHPUnit_Extensions_Database_DB_IDatabaseConnection once per test
    private $conn = null;

    final public function getConnection()
    {
        if ($this-&gt;conn === null) {
            if (self::$pdo == null) {
                self::$pdo = new PDO('sqlite::memory:');
            }
            $this-&gt;conn = $this-&gt;createDefaultDBConnection(self::$pdo, ':memory:');
        }

        return $this-&gt;conn;
    }
}
?&gt;</pre><p>
        This has the database connection hardcoded in the PDO connection
        though. PHPUnit has another awesome feature that could make this
        testcase even more generic. If you use the
        <a class="ulink" href="http://www.phpunit.de/manual/current/en/appendixes.configuration.html#appendixes.configuration.php-ini-constants-variables" target="_top">XML Configuration</a>
        you could make the database connection configurable per test-run.
        First let's create a <span class="quote">“<span class="quote">phpunit.xml</span>”</span> file in our tests/
        directory of the application that looks like:
      </p><pre class="screen">
&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;phpunit&gt;
    &lt;php&gt;
        &lt;var name="DB_DSN" value="mysql:dbname=myguestbook;host=localhost" /&gt;
        &lt;var name="DB_USER" value="user" /&gt;
        &lt;var name="DB_PASSWD" value="passwd" /&gt;
        &lt;var name="DB_DBNAME" value="myguestbook" /&gt;
    &lt;/php&gt;
&lt;/phpunit&gt;
</pre><p>
        We can now modify our test-case to look like:
      </p><pre class="programlisting">&lt;?php
abstract class Generic_Tests_DatabaseTestCase extends PHPUnit_Extensions_Database_TestCase
{
    // only instantiate pdo once for test clean-up/fixture load
    static private $pdo = null;

    // only instantiate PHPUnit_Extensions_Database_DB_IDatabaseConnection once per test
    private $conn = null;

    final public function getConnection()
    {
        if ($this-&gt;conn === null) {
            if (self::$pdo == null) {
                self::$pdo = new PDO( $GLOBALS['DB_DSN'], $GLOBALS['DB_USER'], $GLOBALS['DB_PASSWD'] );
            }
            $this-&gt;conn = $this-&gt;createDefaultDBConnection(self::$pdo, $GLOBALS['DB_DBNAME']);
        }

        return $this-&gt;conn;
    }
}
?&gt;</pre><p>
        We can now run the database test suite using different
        configurations from the command-line interface:
      </p><pre class="screen"><strong class="userinput"><code>user@desktop&gt; phpunit --configuration developer-a.xml MyTests/</code></strong>
<strong class="userinput"><code>user@desktop&gt; phpunit --configuration developer-b.xml MyTests/</code></strong></pre><p>
        The possibility to run the database tests against different
        database targets easily is very important if you are developing on
        the development machine. If several developers run the database
        tests against the same database connection you can easily
        experience test-failures because of race-conditions.
      </p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="database.understanding-datasets-and-datatables"></a>Understanding DataSets and DataTables</h2></div></div></div><p>
      A central concept of PHPUnit's Database Extension are DataSets and
      DataTables. You should try to understand this simple concept to
      master database testing with PHPUnit. The DataSet and DataTable are
      an abstraction layer around your database tables, rows and
      columns. A simple API hides the underlying database contents in an
      object structure, which can also be implemented by other
      non-database sources.
    </p><p>
      This abstraction is necessary to compare the actual contents of a
      database against the expected contents. Expectations can be
      represented as XML, YAML, CSV files or PHP array for example. The
      DataSet and DataTable interfaces enable the comparison of these
      conceptually different sources, emulating relational database
      storage in a semantically similar approach.
    </p><p>
      A workflow for database assertions in your tests then consists of
      three simple steps:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Specify one or more tables in your database by table name (actual
          dataset)
        </p></li><li class="listitem"><p>
          Specify the expected dataset in your preferred format (YAML, XML,
          ..)
        </p></li><li class="listitem"><p>
          Assert that both dataset representations equal each other.
        </p></li></ul></div><p>
      Assertions are not the only use-case for the DataSet and DataTable
      in PHPUnit's Database Extension. As shown in the previous section
      they also describe the initial contents of a database. You are
      forced to define a fixture dataset by the Database TestCase, which
      is then used to:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Delete all the rows from the tables specified in the dataset.
        </p></li><li class="listitem"><p>
          Write all the rows in the data-tables into the database.
        </p></li></ul></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="database.available-implementations"></a>Available Implementations</h3></div></div></div><p>
        There are three different types of datasets/datatables:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            File-Based DataSets and DataTables
          </p></li><li class="listitem"><p>
            Query-Based DataSet and DataTable
          </p></li><li class="listitem"><p>
            Filter and Composition DataSets and DataTables
          </p></li></ul></div><p>
        The file-based datasets and tables are generally used for the
        initial fixture and to describe the expected state of the database.
      </p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="database.flat-xml-dataset"></a>Flat XML DataSet</h4></div></div></div><p>
          The most common dataset is called Flat XML. It is a very simple xml
          format where a tag inside the root node
          <code class="literal">&lt;dataset&gt;</code> represents exactly one row in the
          database. The tags name equals the table to insert the row into and
          an attribute represents the column. An example for a simple guestbook
          application could look like this:
        </p><pre class="screen">
&lt;?xml version="1.0" ?&gt;
&lt;dataset&gt;
    &lt;guestbook id="1" content="Hello buddy!" user="joe" created="2010-04-24 17:15:23" /&gt;
    &lt;guestbook id="2" content="I like it!" user="nancy" created="2010-04-26 12:14:20" /&gt;
&lt;/dataset&gt;
</pre><p>
          This is obviously easy to write. Here
          <code class="literal">&lt;guestbook&gt;</code> is the table name where two rows
          are inserted into each with four columns <span class="quote">“<span class="quote">id</span>”</span>,
          <span class="quote">“<span class="quote">content</span>”</span>, <span class="quote">“<span class="quote">user</span>”</span> and
          <span class="quote">“<span class="quote">created</span>”</span> with their respective values.
        </p><p>
          However this simplicity comes at a cost.
        </p><p>
          From the previous example it isn't obvious how you would specify an
          empty table. You can insert a tag with no attributes with the name
          of the empty table. A flat xml file for an empty guestbook table
          would then look like:
        </p><pre class="screen">
&lt;?xml version="1.0" ?&gt;
&lt;dataset&gt;
    &lt;guestbook /&gt;
&lt;/dataset&gt;
</pre><p>
          The handling of NULL values with the flat xml dataset is tedious. A
          NULL value is different than an empty string value in almost any
          database (Oracle being an exception), something that is difficult
          to describe in the flat xml format. You can represent a NULL's value
          by omitting the attribute from the row specification. If our
          guestbook would allow anonymous entries represented by a NULL value
          in the user column, a hypothetical state of the guestbook table
          could look like:
        </p><pre class="screen">
&lt;?xml version="1.0" ?&gt;
&lt;dataset&gt;
    &lt;guestbook id="1" content="Hello buddy!" user="joe" created="2010-04-24 17:15:23" /&gt;
    &lt;guestbook id="2" content="I like it!" created="2010-04-26 12:14:20" /&gt;
&lt;/dataset&gt;
</pre><p>
          In this case the second entry is posted anonymously. However this
          leads to a serious problem with column recognition. During dataset
          equality assertions each dataset has to specify what columns a
          table holds. If an attribute is NULL for all the rows of a
          data-table, how would the Database Extension know that the column
          should be part of the table?
        </p><p>
          The flat xml dataset makes a crucial assumption now, defining that
          the attributes on the first defined row of a table define the
          columns of this table. In the previous example this would mean
          <span class="quote">“<span class="quote">id</span>”</span>, <span class="quote">“<span class="quote">content</span>”</span>, <span class="quote">“<span class="quote">user</span>”</span> and
          <span class="quote">“<span class="quote">created</span>”</span> are columns of the guestbook table. For the
          second row where <span class="quote">“<span class="quote">user</span>”</span> is not defined a NULL would be
          inserted into the database.
        </p><p>
          When the first guestbook entry is deleted from the dataset only
          <span class="quote">“<span class="quote">id</span>”</span>, <span class="quote">“<span class="quote">content</span>”</span> and
          <span class="quote">“<span class="quote">created</span>”</span> would be columns of the guestbook table,
          since <span class="quote">“<span class="quote">user</span>”</span> is not specified.
        </p><p>
          To use the Flat XML dataset effectively when NULL values are
          relevant the first row of each table must not contain any NULL
          value and only successive rows are allowed to omit attributes. This
          can be awkward, since the order of the rows is a relevant factor
          for database assertions.
        </p><p>
          In turn, if you specify only a subset of the table columns in the
          Flat XML dataset all the omitted values are set to their default
          values. This will lead to errors if one of the omitted columns is
          defined as <span class="quote">“<span class="quote">NOT NULL DEFAULT NULL</span>”</span>.
        </p><p>
          In conclusion I can only advise using the Flat XML datasets if you
          do not need NULL values.
        </p><p>
          You can create a flat xml dataset instance from within your
          Database TestCase by calling the
          <code class="literal">createFlatXmlDataSet($filename)</code> method:
        </p><pre class="programlisting">&lt;?php
class MyTestCase extends PHPUnit_Extensions_Database_TestCase
{
    public function getDataSet()
    {
        return $this-&gt;createFlatXmlDataSet('myFlatXmlFixture.xml');
    }
}
?&gt;</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="database.xml-dataset"></a>XML DataSet</h4></div></div></div><p>
          There is another more structured XML dataset, which is a bit more
          verbose to write but avoids the NULL problems of the Flat XML
          dataset. Inside the root node <code class="literal">&lt;dataset&gt;</code> you
          can specify <code class="literal">&lt;table&gt;</code>,
          <code class="literal">&lt;column&gt;</code>, <code class="literal">&lt;row&gt;</code>,
          <code class="literal">&lt;value&gt;</code> and
          <code class="literal">&lt;null /&gt;</code> tags. An equivalent dataset to the
          previously defined Guestbook Flat XML looks like:
        </p><pre class="screen">
&lt;?xml version="1.0" ?&gt;
&lt;dataset&gt;
    &lt;table name="guestbook"&gt;
        &lt;column&gt;id&lt;/column&gt;
        &lt;column&gt;content&lt;/column&gt;
        &lt;column&gt;user&lt;/column&gt;
        &lt;column&gt;created&lt;/column&gt;
        &lt;row&gt;
            &lt;value&gt;1&lt;/value&gt;
            &lt;value&gt;Hello buddy!&lt;/value&gt;
            &lt;value&gt;joe&lt;/value&gt;
            &lt;value&gt;2010-04-24 17:15:23&lt;/value&gt;
        &lt;/row&gt;
        &lt;row&gt;
            &lt;value&gt;2&lt;/value&gt;
            &lt;value&gt;I like it!&lt;/value&gt;
            &lt;null /&gt;
            &lt;value&gt;2010-04-26 12:14:20&lt;/value&gt;
        &lt;/row&gt;
    &lt;/table&gt;
&lt;/dataset&gt;
</pre><p>
          Any defined <code class="literal">&lt;table&gt;</code> has a name and requires
          a definition of all the columns with their names. It can contain zero
          or any positive number of nested <code class="literal">&lt;row&gt;</code>
          elements. Defining no <code class="literal">&lt;row&gt;</code> element means
          the table is empty. The <code class="literal">&lt;value&gt;</code> and
          <code class="literal">&lt;null /&gt;</code> tags have to be specified in the
          order of the previously given <code class="literal">&lt;column&gt;</code>
          elements. The <code class="literal">&lt;null /&gt;</code> tag obviously means
          that the value is NULL.
        </p><p>
          You can create a xml dataset instance from within your
          Database TestCase by calling the
          <code class="literal">createXmlDataSet($filename)</code> method:
        </p><pre class="programlisting">&lt;?php
class MyTestCase extends PHPUnit_Extensions_Database_TestCase
{
    public function getDataSet()
    {
        return $this-&gt;createXMLDataSet('myXmlFixture.xml');
    }
}
?&gt;</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="database.mysql-xml-dataset"></a>MySQL XML DataSet</h4></div></div></div><p>
          This new XML format is specific to the
          <a class="ulink" href="http://www.mysql.com" target="_top">MySQL database server</a>.
          Support for it was added in PHPUnit 3.5. Files in this format can
          be generated using the
          <a class="ulink" href="http://dev.mysql.com/doc/refman/5.0/en/mysqldump.html" target="_top"><code class="literal">mysqldump</code></a>
          utility. Unlike CSV datasets, which <code class="literal">mysqldump</code>
          also supports, a single file in this XML format can contain data
          for multiple tables. You can create a file in this format by
          invoking <code class="literal">mysqldump</code> like so:
        </p><pre class="screen"><strong class="userinput"><code>mysqldump --xml -t -u [username] --password=[password] [database] &gt; /path/to/file.xml</code></strong></pre><p>
          This file can be used in your Database TestCase by calling the
          <code class="literal">createMySQLXMLDataSet($filename)</code> method:
        </p><pre class="programlisting">&lt;?php
class MyTestCase extends PHPUnit_Extensions_Database_TestCase
{
    public function getDataSet()
    {
        return $this-&gt;createMySQLXMLDataSet('/path/to/file.xml');
    }
}
?&gt;</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="database.yaml-dataset"></a>YAML DataSet</h4></div></div></div><p>
          Alternatively, you can use YAML dataset for the guestbook example:
        </p><pre class="screen">
guestbook:
  -
    id: 1
    content: "Hello buddy!"
    user: "joe"
    created: 2010-04-24 17:15:23
  -
    id: 2
    content: "I like it!"
    user:
    created: 2010-04-26 12:14:20
</pre><p>
          This is simple, convient AND it solves the NULL issue that the
          similar Flat XML dataset has. A NULL in YAML is just the column
          name without no value specified. An empty string is specified as
          <code class="literal">column1: ""</code>.
        </p><p>
          The YAML Dataset has no factory method on the Database TestCase
          currently, so you have to instantiate it manually:
        </p><pre class="programlisting">&lt;?php
class YamlGuestbookTest extends PHPUnit_Extensions_Database_TestCase
{
    protected function getDataSet()
    {
        return new PHPUnit_Extensions_Database_DataSet_YamlDataSet(
            dirname(__FILE__)."/_files/guestbook.yml"
        );
    }
}
?&gt;</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="database.csv-dataset"></a>CSV DataSet</h4></div></div></div><p>
          Another file-based dataset is based on CSV files. Each table of the
          dataset is represented as a single CSV file. For our guestbook
          example we would define a guestbook-table.csv file:
        </p><pre class="screen">
id,content,user,created
1,"Hello buddy!","joe","2010-04-24 17:15:23"
2,"I like it!","nancy","2010-04-26 12:14:20"
</pre><p>
          While this is very convenient for editing with Excel or OpenOffice,
          you cannot specify NULL values with the CSV dataset. An empty
          column will lead to the database default empty value being inserted
          into the column.
        </p><p>
          You can create a CSV DataSet by calling:
        </p><pre class="programlisting">&lt;?php
class CsvGuestbookTest extends PHPUnit_Extensions_Database_TestCase
{
    protected function getDataSet()
    {
        $dataSet = new PHPUnit_Extensions_Database_DataSet_CsvDataSet();
        $dataSet-&gt;addTable('guestbook', dirname(__FILE__)."/_files/guestbook.csv");
        return $dataSet;
    }
}
?&gt;</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="database.array-dataset"></a>Array DataSet</h4></div></div></div><p>
          There is no Array based DataSet in PHPUnit's Database Extension
          (yet), but we can implement our own easily. Our guestbook example
          should look like:
        </p><pre class="programlisting">&lt;?php
class ArrayGuestbookTest extends PHPUnit_Extensions_Database_TestCase
{
    protected function getDataSet()
    {
        return new MyApp_DbUnit_ArrayDataSet(array(
            'guestbook' =&gt; array(
                array('id' =&gt; 1, 'content' =&gt; 'Hello buddy!', 'user' =&gt; 'joe', 'created' =&gt; '2010-04-24 17:15:23'),
                array('id' =&gt; 2, 'content' =&gt; 'I like it!',   'user' =&gt; null,  'created' =&gt; '2010-04-26 12:14:20'),
            ),
        ));
    }
}
?&gt;</pre><p>
          A PHP DataSet has obvious advantages over all the other file-based
          datasets:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              PHP Arrays can obviously handle <code class="literal">NULL</code> values.
            </p></li><li class="listitem"><p>
              You won't need additional files for assertions and can specify them
              directly in the TestCase.
            </p></li></ul></div><p>
          For this dataset like the Flat XML, CSV and YAML DataSets the keys
          of the first specified row define the table's column names, in the
          previous case this would be <span class="quote">“<span class="quote">id</span>”</span>,
          <span class="quote">“<span class="quote">content</span>”</span>, <span class="quote">“<span class="quote">user</span>”</span> and
          <span class="quote">“<span class="quote">created</span>”</span>.
        </p><p>
          The implementation for this Array DataSet is simple and
          straightforward:
        </p><pre class="programlisting">&lt;?php
class MyApp_DbUnit_ArrayDataSet extends PHPUnit_Extensions_Database_DataSet_AbstractDataSet
{
    /**
     * @var array
     */
    protected $tables = array();

    /**
     * @param array $data
     */
    public function __construct(array $data)
    {
        foreach ($data AS $tableName =&gt; $rows) {
            $columns = array();
            if (isset($rows[0])) {
                $columns = array_keys($rows[0]);
            }

            $metaData = new PHPUnit_Extensions_Database_DataSet_DefaultTableMetaData($tableName, $columns);
            $table = new PHPUnit_Extensions_Database_DataSet_DefaultTable($metaData);

            foreach ($rows AS $row) {
                $table-&gt;addRow($row);
            }
            $this-&gt;tables[$tableName] = $table;
        }
    }

    protected function createIterator($reverse = FALSE)
    {
        return new PHPUnit_Extensions_Database_DataSet_DefaultTableIterator($this-&gt;tables, $reverse);
    }

    public function getTable($tableName)
    {
        if (!isset($this-&gt;tables[$tableName])) {
            throw new InvalidArgumentException("$tableName is not a table in the current database.");
        }

        return $this-&gt;tables[$tableName];
    }
}
?&gt;</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="database.query-sql-dataset"></a>Query (SQL) DataSet</h4></div></div></div><p>
          For database assertions you do not only need the file-based datasets
          but also a Query/SQL based Dataset that contains the actual
          contents of the database. This is where the Query DataSet shines:
        </p><pre class="programlisting">&lt;?php
$ds = new PHPUnit_Extensions_Database_DataSet_QueryDataSet($this-&gt;getConnection());
$ds-&gt;addTable('guestbook');
?&gt;</pre><p>
          Adding a table just by name is an implicit way to define the
          data-table with the following query:
        </p><pre class="programlisting">&lt;?php
$ds = new PHPUnit_Extensions_Database_DataSet_QueryDataSet($this-&gt;getConnection());
$ds-&gt;addTable('guestbook', 'SELECT * FROM guestbook');
?&gt;</pre><p>
          You can make use of this by specifying arbitrary queries for your
          tables, for example restricting rows, column or adding
          <code class="literal">ORDER BY</code> clauses:
        </p><pre class="programlisting">&lt;?php
$ds = new PHPUnit_Extensions_Database_DataSet_QueryDataSet($this-&gt;getConnection());
$ds-&gt;addTable('guestbook', 'SELECT id, content FROM guestbook ORDER BY created DESC');
?&gt;</pre><p>
          The section on Database Assertions will show some more details on
          how to make use of the Query DataSet.
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="database.database-db-dataset"></a>Database (DB) Dataset</h4></div></div></div><p>
          Accessing the Test Connection you can automatically create a
          DataSet that consists of all the tables with their content in the
          database specified as second parameter to the Connections Factory
          method.
        </p><p>
          You can either create a dataset for the complete database as shown
          in <code class="literal">testGuestbook()</code>, or restrict it to a set of
          specified table names with a whitelist as shown in
          <code class="literal">testFilteredGuestbook()</code> method.
        </p><pre class="programlisting">&lt;?php
class MySqlGuestbookTest extends PHPUnit_Extensions_Database_TestCase
{
    /**
     * @return PHPUnit_Extensions_Database_DB_IDatabaseConnection
     */
    public function getConnection()
    {
        $database = 'my_database';
        $user = 'my_user';
        $password = 'my_password';
        $pdo = new PDO('mysql:...', $user, $password);
        return $this-&gt;createDefaultDBConnection($pdo, $database);
    }

    public function testGuestbook()
    {
        $dataSet = $this-&gt;getConnection()-&gt;createDataSet();
        // ...
    }

    public function testFilteredGuestbook()
    {
        $tableNames = array('guestbook');
        $dataSet = $this-&gt;getConnection()-&gt;createDataSet($tableNames);
        // ...
    }
}
?&gt;</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="database.replacement-dataset"></a>Replacement DataSet</h4></div></div></div><p>
          I have been talking about NULL problems with the Flat XML and CSV
          DataSet, but there is a slightly complicated workaround to get both
          types of datasets working with NULLs.
        </p><p>
          The Replacement DataSet is a decorator for an existing dataset and
          allows you to replace values in any column of the dataset by another
          replacement value. To get our guestbook example working with NULL
          values we specify the file like:
        </p><pre class="screen">
&lt;?xml version="1.0" ?&gt;
&lt;dataset&gt;
    &lt;guestbook id="1" content="Hello buddy!" user="joe" created="2010-04-24 17:15:23" /&gt;
    &lt;guestbook id="2" content="I like it!" user="##NULL##" created="2010-04-26 12:14:20" /&gt;
&lt;/dataset&gt;
</pre><p>
          We then wrap the Flat XML DataSet into a Replacement DataSet:
        </p><pre class="programlisting">&lt;?php
class ReplacementTest extends PHPUnit_Extensions_Database_TestCase
{
    public function getDataSet()
    {
        $ds = $this-&gt;createFlatXmlDataSet('myFlatXmlFixture.xml');
        $rds = new PHPUnit_Extensions_Database_DataSet_ReplacementDataSet($ds);
        $rds-&gt;addFullReplacement('##NULL##', null);
        return $rds;
    }
}
?&gt;</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="database.dataset-filter"></a>DataSet Filter</h4></div></div></div><p>
          If you have a large fixture file you can use the DataSet Filter for
          white- and blacklisting of tables and columns that should be
          contained in a sub-dataset. This is especially handy in combination
          with the DB DataSet to filter the columns of the datasets.
        </p><pre class="programlisting">&lt;?php
class DataSetFilterTest extends PHPUnit_Extensions_Database_TestCase
{
    public function testIncludeFilteredGuestbook()
    {
        $tableNames = array('guestbook');
        $dataSet = $this-&gt;getConnection()-&gt;createDataSet();

        $filterDataSet = new PHPUnit_Extensions_Database_DataSet_DataSetFilter($dataSet);
        $filterDataSet-&gt;addIncludeTables(array('guestbook'));
        $filterDataSet-&gt;setIncludeColumnsForTable('guestbook', array('id', 'content'));
        // ..
    }

    public function testExcludeFilteredGuestbook()
    {
        $tableNames = array('guestbook');
        $dataSet = $this-&gt;getConnection()-&gt;createDataSet();

        $filterDataSet = new PHPUnit_Extensions_Database_DataSet_DataSetFilter($dataSet);
        $filterDataSet-&gt;addExcludeTables(array('foo', 'bar', 'baz')); // only keep the guestbook table!
        $filterDataSet-&gt;setExcludeColumnsForTable('guestbook', array('user', 'created'));
        // ..
    }
}
?&gt;</pre><div class="blockquote"><blockquote class="blockquote"><p>
            <span class="strong"><strong>NOTE</strong></span> You cannot use both exclude
            and include column filtering on the same table, only on different
            ones. Plus it is only possible to either white- or blacklist
            tables, not both of them.
          </p></blockquote></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="database.composite-dataset"></a>Composite DataSet</h4></div></div></div><p>
          The composite DataSet is very useful for aggregating several
          already existing datasets into a single dataset. When several
          datasets contain the same table the rows are appended in the
          specified order. For example if we have two datasets
          <span class="emphasis"><em>fixture1.xml</em></span>:
        </p><pre class="screen">
&lt;?xml version="1.0" ?&gt;
&lt;dataset&gt;
    &lt;guestbook id="1" content="Hello buddy!" user="joe" created="2010-04-24 17:15:23" /&gt;
&lt;/dataset&gt;
</pre><p>
          and <span class="emphasis"><em>fixture2.xml</em></span>:
        </p><pre class="screen">
&lt;?xml version="1.0" ?&gt;
&lt;dataset&gt;
    &lt;guestbook id="2" content="I like it!" user="##NULL##" created="2010-04-26 12:14:20" /&gt;
&lt;/dataset&gt;
</pre><p>
          Using the Composite DataSet we can aggregate both fixture files:
        </p><pre class="programlisting">&lt;?php
class CompositeTest extends PHPUnit_Extensions_Database_TestCase
{
    public function getDataSet()
    {
        $ds1 = $this-&gt;createFlatXmlDataSet('fixture1.xml');
        $ds2 = $this-&gt;createFlatXmlDataSet('fixture2.xml');

        $compositeDs = new PHPUnit_Extensions_Database_DataSet_CompositeDataSet();
        $compositeDs-&gt;addDataSet($ds1);
        $compositeDs-&gt;addDataSet($ds2);

        return $compositeDs;
    }
}
?&gt;</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="database.beware-of-foreign-keys"></a>Beware of Foreign Keys</h3></div></div></div><p>
        During Fixture SetUp PHPUnit's Database Extension inserts the rows
        into the database in the order they are specified in your fixture.
        If your database schema uses foreign keys this means you have to
        specify the tables in an order that does not cause foreign key
        constraints to fail.
      </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="database.implementing-your-own-datasetsdatatables"></a>Implementing your own DataSets/DataTables</h3></div></div></div><p>
        To understand the internals of DataSets and DataTables, lets have a
        look at the interface of a DataSet. You can skip this part if you
        do not plan to implement your own DataSet or DataTable.
      </p><pre class="programlisting">&lt;?php
interface PHPUnit_Extensions_Database_DataSet_IDataSet extends IteratorAggregate
{
    public function getTableNames();
    public function getTableMetaData($tableName);
    public function getTable($tableName);
    public function assertEquals(PHPUnit_Extensions_Database_DataSet_IDataSet $other);

    public function getReverseIterator();
}
?&gt;</pre><p>
        The public interface is used internally by the
        <code class="literal">assertDataSetsEqual()</code> assertion on the Database
        TestCase to check for dataset quality. From the
        <code class="literal">IteratorAggregate</code> interface the IDataSet
        inherits the <code class="literal">getIterator()</code> method to iterate
        over all tables of the dataset. The reverse iterator allows PHPUnit to 
        truncate tables opposite the order they were created to satisfy foreign 
        key constraints.
      </p><p>
        Depending on the implementation different approaches are taken to
        add table instances to a dataset. For example, tables are added
        internally during construction from the source file in all
        file-based datasets such as <code class="literal">YamlDataSet</code>,
        <code class="literal">XmlDataSet</code> or <code class="literal">FlatXmlDataSet</code>.
      </p><p>
        A table is also represented by the following interface:
      </p><pre class="programlisting">&lt;?php
interface PHPUnit_Extensions_Database_DataSet_ITable
{
    public function getTableMetaData();
    public function getRowCount();
    public function getValue($row, $column);
    public function getRow($row);
    public function assertEquals(PHPUnit_Extensions_Database_DataSet_ITable $other);
}
?&gt;</pre><p>
        Except the <code class="literal">getTableMetaData()</code> method it is
        pretty self-explainatory. The used methods are all required for
        the different assertions of the Database Extension that are
        explained in the next chapter. The
        <code class="literal">getTableMetaData()</code> method has to return an
        implementation of the
        <code class="literal">PHPUnit_Extensions_Database_DataSet_ITableMetaData</code>
        interface, which describes the structure of the table. It holds
        information on:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            The table name
          </p></li><li class="listitem"><p>
            An array of column-names of the table, ordered by their appearance
            in the result-set.
          </p></li><li class="listitem"><p>
            An array of the primary-key columns.
          </p></li></ul></div><p>
        This interface also has an assertion that checks if two instances
        of Table Metadata equal each other, which is used by the data-set
        equality assertion.
      </p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="database.the-connection-api"></a>The Connection API</h2></div></div></div><p>
      There are three interesting methods on the Connection interface
      which has to be returned from the
      <code class="literal">getConnection()</code> method on the Database TestCase:
    </p><pre class="programlisting">&lt;?php
interface PHPUnit_Extensions_Database_DB_IDatabaseConnection
{
    public function createDataSet(Array $tableNames = NULL);
    public function createQueryTable($resultName, $sql);
    public function getRowCount($tableName, $whereClause = NULL);

    // ...
}
?&gt;</pre><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
          The <code class="literal">createDataSet()</code> method creates a Database
          (DB) DataSet as described in the DataSet implementations section.
        </p><pre class="programlisting">&lt;?php
class ConnectionTest extends PHPUnit_Extensions_Database_TestCase
{
    public function testCreateDataSet()
    {
        $tableNames = array('guestbook');
        $dataSet = $this-&gt;getConnection()-&gt;createDataSet();
    }
}
?&gt;</pre></li><li class="listitem"><p>
          The <code class="literal">createQueryTable()</code> method can be used to
          create instances of a QueryTable, give them a result name and SQL
          query. This is a handy method when it comes to result/table
          assertions as will be shown in the next section on the Database
          Assertions API.
        </p><pre class="programlisting">&lt;?php
class ConnectionTest extends PHPUnit_Extensions_Database_TestCase
{
    public function testCreateQueryTable()
    {
        $tableNames = array('guestbook');
        $queryTable = $this-&gt;getConnection()-&gt;createQueryTable('guestbook', 'SELECT * FROM guestbook');
    }
}
?&gt;</pre></li><li class="listitem"><p>
          The <code class="literal">getRowCount()</code> method is a convienent way to
          access the number of rows in a table, optionally filtered by an
          additional where clause. This can be used with a simple equality
          assertion:
        </p><pre class="programlisting">&lt;?php
class ConnectionTest extends PHPUnit_Extensions_Database_TestCase
{
    public function testGetRowCount()
    {
        $this-&gt;assertEquals(2, $this-&gt;getConnection()-&gt;getRowCount('guestbook'));
    }
}
?&gt;</pre></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="database.database-assertions-api"></a>Database Assertions API</h2></div></div></div><p>
      For a testing tool the Database Extension surely provides some
      assertions that you can use to verify the current state of the
      database, tables and the row-count of tables. This section
      describes this functionality in detail:
    </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="database.asserting-the-row-count-of-a-table"></a>Asserting the Row-Count of a Table</h3></div></div></div><p>
        It is often helpful to check if a table contains a specific amount
        of rows. You can easily achieve this without additional glue code
        using the Connection API. Say we wanted to check that after
        insertion of a row into our guestbook we not only have the two
        initial entries that have accompanied us in all the previous
        examples, but a third one:
      </p><pre class="programlisting">&lt;?php
class GuestbookTest extends PHPUnit_Extensions_Database_TestCase
{
    public function testAddEntry()
    {
        $this-&gt;assertEquals(2, $this-&gt;getConnection()-&gt;getRowCount('guestbook'), "Pre-Condition");

        $guestbook = new Guestbook();
        $guestbook-&gt;addEntry("suzy", "Hello world!");

        $this-&gt;assertEquals(3, $this-&gt;getConnection()-&gt;getRowCount('guestbook'), "Inserting failed");
    }
}
?&gt;</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="database.asserting-the-state-of-a-table"></a>Asserting the State of a Table</h3></div></div></div><p>
        The previous assertion is helpful, but we surely want to check the
        actual contents of the table to verify that all the values were
        written into the correct columns. This can be achieved by a table
        assertion.
      </p><p>
        For this we would define a Query Table instance which derives its
        content from a table name and SQL query and compare it to a
        File/Array Based Data Set:
      </p><pre class="programlisting">&lt;?php
class GuestbookTest extends PHPUnit_Extensions_Database_TestCase
{
    public function testAddEntry()
    {
        $guestbook = new Guestbook();
        $guestbook-&gt;addEntry("suzy", "Hello world!");

        $queryTable = $this-&gt;getConnection()-&gt;createQueryTable(
            'guestbook', 'SELECT * FROM guestbook'
        );
        $expectedTable = $this-&gt;createFlatXmlDataSet("expectedBook.xml")
                              -&gt;getTable("guestbook");
        $this-&gt;assertTablesEqual($expectedTable, $queryTable);
    }
}
?&gt;</pre><p>
        Now we have to write the <span class="emphasis"><em>expectedBook.xml</em></span> Flat
        XML file for this assertion:
      </p><pre class="screen">
&lt;?xml version="1.0" ?&gt;
&lt;dataset&gt;
    &lt;guestbook id="1" content="Hello buddy!" user="joe" created="2010-04-24 17:15:23" /&gt;
    &lt;guestbook id="2" content="I like it!" user="nancy" created="2010-04-26 12:14:20" /&gt;
    &lt;guestbook id="3" content="Hello world!" user="suzy" created="2010-05-01 21:47:08" /&gt;
&lt;/dataset&gt;
</pre><p>
        This assertion would only pass on exactly one second of the
        universe though, on <span class="emphasis"><em>2010–05–01 21:47:08</em></span>. Dates
        pose a special problem to database testing and we can circumvent
        the failure by omitting the <span class="quote">“<span class="quote">created</span>”</span> column from the
        assertion.
      </p><p>
        The adjusted <span class="emphasis"><em>expectedBook.xml</em></span> Flat XML file
        would probably have to look like the following to make the
        assertion pass:
      </p><pre class="screen">
&lt;?xml version="1.0" ?&gt;
&lt;dataset&gt;
    &lt;guestbook id="1" content="Hello buddy!" user="joe" /&gt;
    &lt;guestbook id="2" content="I like it!" user="nancy" /&gt;
    &lt;guestbook id="3" content="Hello world!" user="suzy" /&gt;
&lt;/dataset&gt;
</pre><p>
        We have to fix up the Query Table call:
      </p><pre class="programlisting">&lt;?php
$queryTable = $this-&gt;getConnection()-&gt;createQueryTable(
    'guestbook', 'SELECT id, content, user FROM guestbook'
);
?&gt;</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="database.asserting-the-result-of-a-query"></a>Asserting the Result of a Query</h3></div></div></div><p>
        You can also assert the result of complex queries with the Query
        Table approach, just specify a result name with a query and
        compare it to a dataset:
      </p><pre class="programlisting">&lt;?php
class ComplexQueryTest extends PHPUnit_Extensions_Database_TestCase
{
    public function testComplexQuery()
    {
        $queryTable = $this-&gt;getConnection()-&gt;createQueryTable(
            'myComplexQuery', 'SELECT complexQuery...'
        );
        $expectedTable = $this-&gt;createFlatXmlDataSet("complexQueryAssertion.xml")
                              -&gt;getTable("myComplexQuery");
        $this-&gt;assertTablesEqual($expectedTable, $queryTable);
    }
}
?&gt;</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="database.asserting-the-state-of-multiple-tables"></a>Asserting the State of Multiple Tables</h3></div></div></div><p>
        For sure you can assert the state of multiple tables at once and
        compare a query dataset against a file based dataset. There are two
        different ways for DataSet assertions.
      </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
            You can use the Database (DB) DataSet from the Connection and
            compare it to a File-Based DataSet.
          </p><pre class="programlisting">&lt;?php
class DataSetAssertionsTest extends PHPUnit_Extensions_Database_TestCase
{
    public function testCreateDataSetAssertion()
    {
        $dataSet = $this-&gt;getConnection()-&gt;createDataSet(array('guestbook'));
        $expectedDataSet = $this-&gt;createFlatXmlDataSet('guestbook.xml');
        $this-&gt;assertDataSetsEqual($expectedDataSet, $dataSet);
    }
}
?&gt;</pre></li><li class="listitem"><p>
            You can construct the DataSet on your own:
          </p><pre class="programlisting">&lt;?php
class DataSetAssertionsTest extends PHPUnit_Extensions_Database_TestCase
{
    public function testManualDataSetAssertion()
    {
        $dataSet = new PHPUnit_Extensions_Database_DataSet_QueryDataSet();
        $dataSet-&gt;addTable('guestbook', 'SELECT id, content, user FROM guestbook'); // additional tables
        $expectedDataSet = $this-&gt;createFlatXmlDataSet('guestbook.xml');

        $this-&gt;assertDataSetsEqual($expectedDataSet, $dataSet);
    }
}
?&gt;</pre></li></ol></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="database.frequently-asked-questions"></a>Frequently Asked Questions</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="database.will-phpunit-re-create-the-database-schema-for-each-test"></a>Will PHPUnit (re-)create the database schema for each
             test?</h3></div></div></div><p>
        No, PHPUnit requires all database objects to be available when the
        suite is started. The Database, tables, sequences, triggers and
        views have to be created before you run the test suite.
      </p><p>
        <a class="ulink" href="http://www.doctrine-project.org" target="_top">Doctrine 2</a> or
        <a class="ulink" href="http://www.ezcomponents.org" target="_top">eZ Components</a> have
        powerful tools that allows you to create the database schema from
        pre-defined datastructures, however these have to be hooked into
        the PHPUnit extension to allow automatic database re-creation
        before the complete test-suite is run.
      </p><p>
        Since each test completely cleans the database you are not even
        required to re-create the database for each test-run. A permanently
        available database works perfectly.
      </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="database.am-i-required-to-use-pdo-in-my-application-for-the-database-extension-to-work"></a>Am I required to use PDO in my application for the Database
             Extension to work?</h3></div></div></div><p>
        No, PDO is only required for the fixture clean- and set-up and for
        assertions. You can use whatever database abstraction you want
        inside your own code.
      </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="database.what-can-i-do-when-i-get-a-too-much-connections-error"></a>What can I do, when I get a
             <span class="quote">“<span class="quote">Too much Connections</span>”</span> Error?</h3></div></div></div><p>
        If you do not cache the PDO instance that is created from the
        TestCase <code class="literal">getConnection()</code> method the number of
        connections to the database is increasing by one or more with each
        database test. With default configuration MySql only allows 100
        concurrent connections other vendors also have maximum connection
        limits.
      </p><p>
        The SubSection
        <span class="quote">“<span class="quote">Use your own Abstract Database TestCase</span>”</span> shows how
        you can prevent this error from happening by using a single cached
        PDO instance in all your tests.
      </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="database.how-to-handle-null-with-flat-xml-csv-datasets"></a>How to handle NULL with Flat XML / CSV Datasets?</h3></div></div></div><p>
        Do not do this. Instead, you should use either the XML or the YAML
        DataSets.
      </p></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="incomplete-and-skipped-tests"></a>Chapter 9. Incomplete and Skipped Tests</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="incomplete-and-skipped-tests.incomplete-tests"></a>Incomplete Tests</h2></div></div></div><p>
      When you are working on a new test case class, you might want to begin
      by writing empty test methods such as: </p><pre class="programlisting">public function testSomething()
{
}</pre><p> to keep track of the tests that you have to write. The
      problem with empty test methods is that they are interpreted as a
      success by the PHPUnit framework. This misinterpretation leads to the
      test reports being useless -- you cannot see whether a test is actually
      successful or just not yet implemented. Calling
      <code class="literal">$this-&gt;fail()</code> in the unimplemented test method
      does not help either, since then the test will be interpreted as a
      failure. This would be just as wrong as interpreting an unimplemented
      test as a success.
    </p><p>
      <a id="idm140124621135040" class="indexterm"></a>
      <a id="idm140124621134464" class="indexterm"></a>
      <a id="idm140124621133872" class="indexterm"></a>

      If we think of a successful test as a green light and a test failure
      as a red light, we need an additional yellow light to mark a test
      as being incomplete or not yet implemented.
      <code class="literal">PHPUnit_Framework_IncompleteTest</code> is a marker
      interface for marking an exception that is raised by a test method as
      the result of the test being incomplete or currently not implemented.
      <code class="literal">PHPUnit_Framework_IncompleteTestError</code> is the
      standard implementation of this interface.
    </p><p>
      <a class="xref" href="#incomplete-and-skipped-tests.incomplete-tests.examples.SampleTest.php" title="Example 9.1: Marking a test as incomplete">Example 9.1</a>
      shows a test case class, <code class="literal">SampleTest</code>, that contains one test
      method, <code class="literal">testSomething()</code>. By calling the convenience
      method <code class="literal">markTestIncomplete()</code> (which automatically
      raises an <code class="literal">PHPUnit_Framework_IncompleteTestError</code>
      exception) in the test method, we mark the test as being incomplete.
    </p><div class="example"><a id="incomplete-and-skipped-tests.incomplete-tests.examples.SampleTest.php"></a><p class="title"><strong>Example 9.1: Marking a test as incomplete</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class SampleTest extends PHPUnit_Framework_TestCase
{
    public function testSomething()
    {
        // Optional: Test anything here, if you want.
        $this-&gt;assertTrue(TRUE, 'This should already work.');

        // Stop here and mark this test as incomplete.
        $this-&gt;markTestIncomplete(
          'This test has not been implemented yet.'
        );
    }
}
?&gt;</pre></div></div><br class="example-break" /><p>
      An incomplete test is denoted by an <code class="literal">I</code> in the output
      of the PHPUnit command-line test runner, as shown in the following
      example:
    </p><pre class="screen"><strong class="userinput"><code>phpunit --verbose SampleTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

I

Time: 0 seconds, Memory: 3.75Mb

There was 1 incomplete test:

1) SampleTest::testSomething
This test has not been implemented yet.

/home/sb/SampleTest.php:12
OK, but incomplete or skipped tests!
Tests: 1, Assertions: 1, Incomplete: 1.</pre><p>
      <a class="xref" href="#incomplete-and-skipped-tests.incomplete-tests.tables.api" title="Table 9.1. API for Incomplete Tests">Table 9.1</a>
      shows the API for marking tests as incomplete.
    </p><div class="table"><a id="incomplete-and-skipped-tests.incomplete-tests.tables.api"></a><p class="title"><strong>Table 9.1. API for Incomplete Tests</strong></p><div class="table-contents"><table class="table" summary="API for Incomplete Tests" border="1"><colgroup><col /><col /></colgroup><thead><tr><th align="left">Method</th><th align="left">Meaning</th></tr></thead><tbody><tr><td align="left"><code class="literal">void markTestIncomplete()</code></td><td align="left">Marks the current test as incomplete.</td></tr><tr><td align="left"><code class="literal">void markTestIncomplete(string $message)</code></td><td align="left">Marks the current test as incomplete using <code class="literal">$message</code> as an explanatory message.</td></tr></tbody></table></div></div><br class="table-break" /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="incomplete-and-skipped-tests.skipping-tests"></a>Skipping Tests</h2></div></div></div><p>
      Not all tests can be run in every environment. Consider, for instance,
      a database abstraction layer that has several drivers for the different
      database systems it supports. The tests for the MySQL driver can of
      course only be run if a MySQL server is available.
    </p><p>
      <a class="xref" href="#incomplete-and-skipped-tests.skipping-tests.examples.DatabaseTest.php" title="Example 9.2: Skipping a test">Example 9.2</a>
      shows a test case class, <code class="literal">DatabaseTest</code>, that contains one test
      method, <code class="literal">testConnection()</code>. In the test case class'
      <code class="literal">setUp()</code> template method we check whether the MySQLi
      extension is available and use the <code class="literal">markTestSkipped()</code>
      method to skip the test if it is not.
    </p><div class="example"><a id="incomplete-and-skipped-tests.skipping-tests.examples.DatabaseTest.php"></a><p class="title"><strong>Example 9.2: Skipping a test</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class DatabaseTest extends PHPUnit_Framework_TestCase
{
    protected function setUp()
    {
        if (!extension_loaded('mysqli')) {
            $this-&gt;markTestSkipped(
              'The MySQLi extension is not available.'
            );
        }
    }

    public function testConnection()
    {
        // ...
    }
}
?&gt;</pre></div></div><br class="example-break" /><p>
      A test that has been skipped is denoted by an <code class="literal">S</code> in
      the output of the PHPUnit command-line test runner, as shown in the
      following example:
    </p><pre class="screen"><strong class="userinput"><code>phpunit --verbose DatabaseTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

S

Time: 0 seconds, Memory: 3.75Mb

There was 1 skipped test:

1) DatabaseTest::testConnection
The MySQLi extension is not available.

/home/sb/DatabaseTest.php:9
OK, but incomplete or skipped tests!
Tests: 1, Assertions: 0, Skipped: 1.</pre><p>
      <a class="xref" href="#incomplete-and-skipped-tests.skipped-tests.tables.api" title="Table 9.2. API for Skipping Tests">Table 9.2</a>
      shows the API for skipping tests.
    </p><div class="table"><a id="incomplete-and-skipped-tests.skipped-tests.tables.api"></a><p class="title"><strong>Table 9.2. API for Skipping Tests</strong></p><div class="table-contents"><table class="table" summary="API for Skipping Tests" border="1"><colgroup><col /><col /></colgroup><thead><tr><th align="left">Method</th><th align="left">Meaning</th></tr></thead><tbody><tr><td align="left"><code class="literal">void markTestSkipped()</code></td><td align="left">Marks the current test as skipped.</td></tr><tr><td align="left"><code class="literal">void markTestSkipped(string $message)</code></td><td align="left">Marks the current test as skipped using <code class="literal">$message</code> as an explanatory message.</td></tr></tbody></table></div></div><br class="table-break" /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="incomplete-and-skipped-tests.skipping-tests-using-requires"></a>Skipping Tests using @requires</h2></div></div></div><p>
      In addition to the above methods it is also possible to use the
      <code class="literal">@requires</code> annotation to express common preconditions for a test case.
    </p><div class="table"><a id="incomplete-and-skipped-tests.requires.tables.api"></a><p class="title"><strong>Table 9.3. Possible @requires usages</strong></p><div class="table-contents"><table class="table" summary="Possible @requires usages" border="1"><colgroup><col /><col /><col /><col /></colgroup><thead><tr><th align="left">Type</th><th align="left">Possible Values</th><th align="left">Examples</th><th align="left">Another example</th></tr></thead><tbody><tr><td align="left"><code class="literal">PHP</code></td><td align="left">Any PHP version identifier</td><td align="left">@requires PHP 5.3.3</td><td align="left">@requires PHP 5.4-dev</td></tr><tr><td align="left"><code class="literal">PHPUnit</code></td><td align="left">Any PHPUnit version identifier</td><td align="left">@requires PHPUnit 3.6.3</td><td align="left">@requires PHPUnit 3.7</td></tr><tr><td align="left"><code class="literal">function</code></td><td align="left">Any valid parameter to <a class="ulink" href="http://php.net/function_exists" target="_top">function_exists</a></td><td align="left">@requires function imap_open</td><td align="left">@requires function ReflectionMethod::setAccessible</td></tr><tr><td align="left"><code class="literal">extension</code></td><td align="left">Any extension name</td><td align="left">@requires extension mysqli</td><td align="left">@requires extension curl</td></tr></tbody></table></div></div><br class="table-break" /><div class="example"><a id="incomplete-and-skipped-tests.skipping-tests.examples.DatabaseClassSkippingTest.php"></a><p class="title"><strong>Example 9.3: Skipping test cases using @requires</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
/**
 * @requires extension mysqli
 */
class DatabaseTest extends PHPUnit_Framework_TestCase
{
    /**
     * @requires PHP 5.3
     */
    public function testConnection()
    {
        // Test requires the mysqli extension and PHP &gt;= 5.3
    }

    // ... All other tests require the mysqli extension
}
?&gt;</pre></div></div><br class="example-break" /><p>
      If you are using syntax that doesn't compile with a certain PHP Version look into the xml
      configuration for version dependent includes in <a class="xref" href="#appendixes.configuration.testsuites" title="Test Suites">the section called “Test Suites”</a>
    </p></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="test-doubles"></a>Chapter 10. Test Doubles</h1></div></div></div><p>
    Gerard Meszaros introduces the concept of Test Doubles in
    <a class="xref" href="#Meszaros2007" title="xUnit Test Patterns: Refactoring Test Code">[<abbr class="abbrev">Meszaros2007</abbr>]</a> like this:
  </p><div class="blockquote"><table border="0" class="blockquote" style="width: 100%; cellspacing: 0; cellpadding: 0;" summary="Block quote"><tr><td width="10%" valign="top"> </td><td width="80%" valign="top"><p>
      <a id="idm140124621239952" class="indexterm"></a>

      Sometimes it is just plain hard to test the system under test (SUT)
      because it depends on other components that cannot be used in the test
      environment. This could be because they aren't available, they will not
      return the results needed for the test or because executing them would
      have undesirable side effects. In other cases, our test strategy requires
      us to have more control or visibility of the internal behavior of the SUT.
    </p><p>
      <a id="idm140124621238464" class="indexterm"></a>
      <a id="idm140124621237888" class="indexterm"></a>

      When we are writing a test in which we cannot (or chose not to) use a real
      depended-on component (DOC), we can replace it with a Test Double. The
      Test Double doesn't have to behave exactly like the real DOC; it merely
      has to provide the same API as the real one so that the SUT thinks it is
      the real one!
    </p></td><td width="10%" valign="top"> </td></tr><tr><td width="10%" valign="top"> </td><td colspan="2" align="right" valign="top">--<span class="attribution">Gerard Meszaros</span></td></tr></table></div><p>
    The <code class="literal">getMock($className)</code> method provided by PHPUnit can be
    used in a test to automatically generate an object that can act as a test
    double for the specified original class. This test double object can be used
    in every context where an object of the original class is expected.
  </p><p>
    By default, all methods of the original class are replaced with a dummy
    implementation that just returns <code class="literal">NULL</code> (without calling
    the original method). Using the <code class="literal">will($this-&gt;returnValue())</code>
    method, for instance, you can configure these dummy implementations to
    return a value when called.
  </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Limitations</h3><p>
      Please note that <code class="literal">final</code>, <code class="literal">private</code>
      and <code class="literal">static</code> methods cannot be stubbed or mocked. They
      are ignored by PHPUnit's test double functionality and retain their
      original behavior.
    </p></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>
        Please pay attention to the fact that the parameters managing has been changed.
        The previous implementation clones all object parameters. It did not allow to check whether the same object was passed to method or not.
        <a class="xref" href="#test-doubles.mock-objects.examples.clone-object-parameters-usecase.php" title="Example 10.15: Testing that a method gets called once and with the identical object as was passed">Example 10.15</a> shows where the new implementation could be useful.
        <a class="xref" href="#test-doubles.mock-objects.examples.enable-clone-object-parameters.php" title="Example 10.16: Create a mock object with cloning parameters enabled">Example 10.16</a> shows how to switch back to previous behavior.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="test-doubles.stubs"></a>Stubs</h2></div></div></div><p>
      <a id="idm140124620217296" class="indexterm"></a>

      The practice of replacing an object with a test double that (optionally)
      returns configured return values is referred to as
      <span class="emphasis"><em>stubbing</em></span>. You can use a <span class="emphasis"><em>stub</em></span> to
      "replace a real component on which the SUT depends so that the test has a
      control point for the indirect inputs of the SUT. This allows the test to
      force the SUT down paths it might not otherwise execute".
    </p><p>
      <a id="idm140124620215024" class="indexterm"></a>

      <a class="xref" href="#test-doubles.stubs.examples.StubTest.php" title="Example 10.2: Stubbing a method call to return a fixed value">Example 10.2</a> shows how
      to stub method calls and set up return values. We first use the
      <code class="literal">getMock()</code> method that is provided by the
      <code class="literal">PHPUnit_Framework_TestCase</code> class to set up a stub
      object that looks like an object of <code class="literal">SomeClass</code>
      (<a class="xref" href="#test-doubles.stubs.examples.SomeClass.php" title="Example 10.1: The class we want to stub">Example 10.1</a>). We then
      use the <a class="ulink" href="http://martinfowler.com/bliki/FluentInterface.html" target="_top">Fluent Interface</a>
      that PHPUnit provides to specify the behavior for the stub. In essence,
      this means that you do not need to create several temporary objects and
      wire them together afterwards. Instead, you chain method calls as shown in
      the example. This leads to more readable and "fluent" code.
    </p><div class="example"><a id="test-doubles.stubs.examples.SomeClass.php"></a><p class="title"><strong>Example 10.1: The class we want to stub</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class SomeClass
{
    public function doSomething()
    {
        // Do something.
    }
}
?&gt;</pre></div></div><br class="example-break" /><div class="example"><a id="test-doubles.stubs.examples.StubTest.php"></a><p class="title"><strong>Example 10.2: Stubbing a method call to return a fixed value</strong></p><div class="example-contents"><a id="idm140124620208480" class="indexterm"></a><a id="idm140124620207904" class="indexterm"></a><a id="idm140124621268880" class="indexterm"></a><a id="idm140124621268304" class="indexterm"></a><a id="idm140124621267728" class="indexterm"></a><pre class="programlisting">&lt;?php
require_once 'SomeClass.php';

class StubTest extends PHPUnit_Framework_TestCase
{
    public function testStub()
    {
        // Create a stub for the SomeClass class.
        $stub = $this-&gt;getMock('SomeClass');

        // Configure the stub.
        $stub-&gt;expects($this-&gt;any())
             -&gt;method('doSomething')
             -&gt;will($this-&gt;returnValue('foo'));

        // Calling $stub-&gt;doSomething() will now return
        // 'foo'.
        $this-&gt;assertEquals('foo', $stub-&gt;doSomething());
    }
}
?&gt;</pre></div></div><br class="example-break" /><p>
      "Behind the scenes", PHPUnit automatically generates a new PHP class that
      implements the desired behavior when the <code class="literal">getMock()</code>
      method is used. The generated test double class can be configured through
      the optional arguments of the <code class="literal">getMock()</code> method.
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>By default, all methods of the given class are replaced with a test double that just returns <code class="literal">NULL</code> unless a return value is configured using <code class="literal">will($this-&gt;returnValue())</code>, for instance.</p></li><li class="listitem"><p>When the second (optional) parameter is provided, only the methods whose names are in the array are replaced with a configurable test double. The behavior of the other methods is not changed. Providing <code class="literal">NULL</code> as the parameter means that no methods will be replaced.</p></li><li class="listitem"><p>The third (optional) parameter may hold a parameter array that is passed to the original class' constructor (which is not replaced with a dummy implementation by default).</p></li><li class="listitem"><p>The fourth (optional) parameter can be used to specify a class name for the generated test double class.</p></li><li class="listitem"><p>The fifth (optional) parameter can be used to disable the call to the original class' constructor.</p></li><li class="listitem"><p>The sixth (optional) parameter can be used to disable the call to the original class' clone constructor.</p></li><li class="listitem"><p>The seventh (optional) parameter can be used to disable <code class="literal">__autoload()</code> during the generation of the test double class.</p></li></ul></div><p>
      Alternatively, the Mock Builder API can be used to configure the generated
      test double class. <a class="xref" href="#test-doubles.stubs.examples.StubTest2.php" title="Example 10.3: Using the Mock Builder API can be used to configure the generated test double class">Example 10.3</a>
      shows an example. Here's a list of the methods that can be used with the
      Mock Builder's fluent interface:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">setMethods(array $methods)</code> can be called on the Mock Builder object to specify the methods that are to be replaced with a configurable test double. The behavior of the other methods is not changed. If you call <code class="literal">setMethods(NULL)</code>, then no methods will be replaced.</p></li><li class="listitem"><p><code class="literal">setConstructorArgs(array $args)</code> can be called to provide a parameter array that is passed to the original class' constructor (which is not replaced with a dummy implementation by default).</p></li><li class="listitem"><p><code class="literal">setMockClassName($name)</code> can be used to specify a class name for the generated test double class.</p></li><li class="listitem"><p><code class="literal">disableOriginalConstructor()</code> can be used to disable the call to the original class' constructor.</p></li><li class="listitem"><p><code class="literal">disableOriginalClone()</code> can be used to disable the call to the original class' clone constructor.</p></li><li class="listitem"><p><code class="literal">disableAutoload()</code> can be used to disable <code class="literal">__autoload()</code> during the generation of the test double class.</p></li></ul></div><div class="example"><a id="test-doubles.stubs.examples.StubTest2.php"></a><p class="title"><strong>Example 10.3: Using the Mock Builder API can be used to configure the generated test double class</strong></p><div class="example-contents"><a id="idm140124621248160" class="indexterm"></a><a id="idm140124621247584" class="indexterm"></a><a id="idm140124621247008" class="indexterm"></a><a id="idm140124621246432" class="indexterm"></a><a id="idm140124621245856" class="indexterm"></a><pre class="programlisting">&lt;?php
require_once 'SomeClass.php';

class StubTest extends PHPUnit_Framework_TestCase
{
    public function testStub()
    {
        // Create a stub for the SomeClass class.
        $stub = $this-&gt;getMockBuilder('SomeClass')
                     -&gt;disableOriginalConstructor()
                     -&gt;getMock();

        // Configure the stub.
        $stub-&gt;expects($this-&gt;any())
             -&gt;method('doSomething')
             -&gt;will($this-&gt;returnValue('foo'));

        // Calling $stub-&gt;doSomething() will now return
        // 'foo'.
        $this-&gt;assertEquals('foo', $stub-&gt;doSomething());
    }
}
?&gt;</pre></div></div><br class="example-break" /><p>
      Sometimes you want to return one of the arguments of a method call
      (unchanged) as the result of a stubbed method call.
      <a class="xref" href="#test-doubles.stubs.examples.StubTest3.php" title="Example 10.4: Stubbing a method call to return one of the arguments">Example 10.4</a> shows how you
      can achieve this using <code class="literal">returnArgument()</code> instead of
      <code class="literal">returnValue()</code>.
    </p><div class="example"><a id="test-doubles.stubs.examples.StubTest3.php"></a><p class="title"><strong>Example 10.4: Stubbing a method call to return one of the arguments</strong></p><div class="example-contents"><a id="idm140124620186928" class="indexterm"></a><a id="idm140124620186352" class="indexterm"></a><a id="idm140124620185776" class="indexterm"></a><a id="idm140124620185200" class="indexterm"></a><a id="idm140124620184624" class="indexterm"></a><pre class="programlisting">&lt;?php
require_once 'SomeClass.php';

class StubTest extends PHPUnit_Framework_TestCase
{
    public function testReturnArgumentStub()
    {
        // Create a stub for the SomeClass class.
        $stub = $this-&gt;getMock('SomeClass');

        // Configure the stub.
        $stub-&gt;expects($this-&gt;any())
             -&gt;method('doSomething')
             -&gt;will($this-&gt;returnArgument(0));

        // $stub-&gt;doSomething('foo') returns 'foo'
        $this-&gt;assertEquals('foo', $stub-&gt;doSomething('foo'));

        // $stub-&gt;doSomething('bar') returns 'bar'
        $this-&gt;assertEquals('bar', $stub-&gt;doSomething('bar'));
    }
}
?&gt;</pre></div></div><br class="example-break" /><p>
      When testing a fluent interface, it is sometimes useful to have a stubbed
      method return a reference to the stubbed object.
      <a class="xref" href="#test-doubles.stubs.examples.StubTest4.php" title="Example 10.5: Stubbing a method call to return a reference to the stub object">Example 10.5</a> shows how you
      can use <code class="literal">returnSelf()</code> to achieve this.
    </p><div class="example"><a id="test-doubles.stubs.examples.StubTest4.php"></a><p class="title"><strong>Example 10.5: Stubbing a method call to return a reference to the stub object</strong></p><div class="example-contents"><a id="idm140124620180128" class="indexterm"></a><a id="idm140124620179552" class="indexterm"></a><a id="idm140124620178976" class="indexterm"></a><a id="idm140124620178400" class="indexterm"></a><a id="idm140124620177824" class="indexterm"></a><pre class="programlisting">&lt;?php
require_once 'SomeClass.php';

class StubTest extends PHPUnit_Framework_TestCase
{
    public function testReturnSelf()
    {
        // Create a stub for the SomeClass class.
        $stub = $this-&gt;getMock('SomeClass');

        // Configure the stub.
        $stub-&gt;expects($this-&gt;any())
             -&gt;method('doSomething')
             -&gt;will($this-&gt;returnSelf());

        // $stub-&gt;doSomething() returns $stub
        $this-&gt;assertSame($stub, $stub-&gt;doSomething());
    }
}
?&gt;</pre></div></div><br class="example-break" /><p>
      Sometimes a stubbed method should return different values depending on
      a predefined list of arguments.  You can use
      <code class="literal">returnValueMap()</code> to create a map that associates
      arguments with corresponding return values. See
      <a class="xref" href="#test-doubles.stubs.examples.StubTest5.php" title="Example 10.6: Stubbing a method call to return the value from a map">Example 10.6</a> for
      an example.
    </p><div class="example"><a id="test-doubles.stubs.examples.StubTest5.php"></a><p class="title"><strong>Example 10.6: Stubbing a method call to return the value from a map</strong></p><div class="example-contents"><a id="idm140124620173376" class="indexterm"></a><a id="idm140124620172800" class="indexterm"></a><a id="idm140124620172224" class="indexterm"></a><a id="idm140124620171648" class="indexterm"></a><a id="idm140124620171072" class="indexterm"></a><pre class="programlisting">&lt;?php
require_once 'SomeClass.php';

class StubTest extends PHPUnit_Framework_TestCase
{
    public function testReturnValueMapStub()
    {
        // Create a stub for the SomeClass class.
        $stub = $this-&gt;getMock('SomeClass');

        // Create a map of arguments to return values.
        $map = array(
          array('a', 'b', 'c', 'd'),
          array('e', 'f', 'g', 'h')
        );

        // Configure the stub.
        $stub-&gt;expects($this-&gt;any())
             -&gt;method('doSomething')
             -&gt;will($this-&gt;returnValueMap($map));

        // $stub-&gt;doSomething() returns different values depending on
        // the provided arguments.
        $this-&gt;assertEquals('d', $stub-&gt;doSomething('a', 'b', 'c'));
        $this-&gt;assertEquals('h', $stub-&gt;doSomething('e', 'f', 'g'));
    }
}
?&gt;</pre></div></div><br class="example-break" /><p>
      When the stubbed method call should return a calculated value instead of
      a fixed one (see <code class="literal">returnValue()</code>) or an (unchanged)
      argument (see <code class="literal">returnArgument()</code>), you can use
      <code class="literal">returnCallback()</code> to have the stubbed method return the
      result of a callback function or method. See
      <a class="xref" href="#test-doubles.stubs.examples.StubTest6.php" title="Example 10.7: Stubbing a method call to return a value from a callback">Example 10.7</a> for an example.
    </p><div class="example"><a id="test-doubles.stubs.examples.StubTest6.php"></a><p class="title"><strong>Example 10.7: Stubbing a method call to return a value from a callback</strong></p><div class="example-contents"><a id="idm140124620165456" class="indexterm"></a><a id="idm140124620164880" class="indexterm"></a><a id="idm140124620164304" class="indexterm"></a><a id="idm140124620163728" class="indexterm"></a><a id="idm140124620163152" class="indexterm"></a><pre class="programlisting">&lt;?php
require_once 'SomeClass.php';

class StubTest extends PHPUnit_Framework_TestCase
{
    public function testReturnCallbackStub()
    {
        // Create a stub for the SomeClass class.
        $stub = $this-&gt;getMock('SomeClass');

        // Configure the stub.
        $stub-&gt;expects($this-&gt;any())
             -&gt;method('doSomething')
             -&gt;will($this-&gt;returnCallback('str_rot13'));

        // $stub-&gt;doSomething($argument) returns str_rot13($argument)
        $this-&gt;assertEquals('fbzrguvat', $stub-&gt;doSomething('something'));
    }
}
?&gt;</pre></div></div><br class="example-break" /><p>
      A simpler alternative to setting up a callback method may be to
      specify a list of desired return values. You can do this with
      the <code class="literal">onConsecutiveCalls()</code> method. See
      <a class="xref" href="#test-doubles.stubs.examples.StubTest7.php" title="Example 10.8: Stubbing a method call to return a list of values in the specified order">Example 10.8</a> for
      an example.
    </p><div class="example"><a id="test-doubles.stubs.examples.StubTest7.php"></a><p class="title"><strong>Example 10.8: Stubbing a method call to return a list of values in the
      specified order</strong></p><div class="example-contents"><a id="idm140124620158704" class="indexterm"></a><a id="idm140124620158128" class="indexterm"></a><a id="idm140124620157552" class="indexterm"></a><a id="idm140124620156976" class="indexterm"></a><a id="idm140124620156400" class="indexterm"></a><pre class="programlisting">&lt;?php
require_once 'SomeClass.php';

class StubTest extends PHPUnit_Framework_TestCase
{
    public function testOnConsecutiveCallsStub()
    {
        // Create a stub for the SomeClass class.
        $stub = $this-&gt;getMock('SomeClass');

        // Configure the stub.
        $stub-&gt;expects($this-&gt;any())
             -&gt;method('doSomething')
             -&gt;will($this-&gt;onConsecutiveCalls(2, 3, 5, 7));

        // $stub-&gt;doSomething() returns a different value each time
        $this-&gt;assertEquals(2, $stub-&gt;doSomething());
        $this-&gt;assertEquals(3, $stub-&gt;doSomething());
        $this-&gt;assertEquals(5, $stub-&gt;doSomething());
    }
}
?&gt;</pre></div></div><br class="example-break" /><p>
      Instead of returning a value, a stubbed method can also raise an
      exception. <a class="xref" href="#test-doubles.stubs.examples.StubTest8.php" title="Example 10.9: Stubbing a method call to throw an exception">Example 10.9</a>
      shows how to use <code class="literal">throwException()</code> to do this.
    </p><div class="example"><a id="test-doubles.stubs.examples.StubTest8.php"></a><p class="title"><strong>Example 10.9: Stubbing a method call to throw an exception</strong></p><div class="example-contents"><a id="idm140124620151904" class="indexterm"></a><a id="idm140124620151328" class="indexterm"></a><a id="idm140124620150752" class="indexterm"></a><a id="idm140124620150176" class="indexterm"></a><a id="idm140124620149600" class="indexterm"></a><pre class="programlisting">&lt;?php
require_once 'SomeClass.php';

class StubTest extends PHPUnit_Framework_TestCase
{
    public function testThrowExceptionStub()
    {
        // Create a stub for the SomeClass class.
        $stub = $this-&gt;getMock('SomeClass');

        // Configure the stub.
        $stub-&gt;expects($this-&gt;any())
             -&gt;method('doSomething')
             -&gt;will($this-&gt;throwException(new Exception));

        // $stub-&gt;doSomething() throws Exception
        $stub-&gt;doSomething();
    }
}
?&gt;</pre></div></div><br class="example-break" /><p>
      Alternatively, you can write the stub yourself and improve your design
      along the way. Widely used resources are accessed through a single façade,
      so you can easily replace the resource with the stub. For example,
      instead of having direct database calls scattered throughout the code,
      you have a single <code class="literal">Database</code> object, an implementor of
      the <code class="literal">IDatabase</code> interface. Then, you can create a stub
      implementation of <code class="literal">IDatabase</code> and use it for your
      tests. You can even create an option for running the tests with the
      stub database or the real database, so you can use your tests for both
      local testing during development and integration testing with the real
      database.
    </p><p>
      Functionality that needs to be stubbed out tends to cluster in the same
      object, improving cohesion. By presenting the functionality with a
      single, coherent interface you reduce the coupling with the rest of the
      system.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="test-doubles.mock-objects"></a>Mock Objects</h2></div></div></div><p>
      The practice of replacing an object with a test double that verifies
      expectations, for instance asserting that a method has been called, is
      referred to as <span class="emphasis"><em>mocking</em></span>.
    </p><p>
      <a id="idm140124620141808" class="indexterm"></a>

      You can use a <span class="emphasis"><em>mock object</em></span> "as an observation point
      that is used to verify the indirect outputs of the SUT as it is exercised.
      Typically, the mock object also includes the functionality of a test stub
      in that it must return values to the SUT if it hasn't already failed the
      tests but the emphasis is on the verification of the indirect outputs.
      Therefore, a mock object is lot more than just a test stub plus
      assertions; it is used a fundamentally different way".
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Limitations</h3><p>
        Only mock objects generated within the scope of a test will be verified
        automatically by PHPUnit. Mock objects generated in data providers, for
        instance, will not be verified by PHPUnit.
      </p></div><p>
      Here is an example: suppose we want to test that the correct method,
      <code class="literal">update()</code> in our example, is called on an object that
      observes another object. <a class="xref" href="#test-doubles.mock-objects.examples.SUT.php" title="Example 10.10: The Subject and Observer classes that are part of the System under Test (SUT)">Example 10.10</a>
      shows the code for the <code class="literal">Subject</code> and <code class="literal">Observer</code>
      classes that are part of the System under Test (SUT).
    </p><div class="example"><a id="test-doubles.mock-objects.examples.SUT.php"></a><p class="title"><strong>Example 10.10: The Subject and Observer classes that are part of the System under Test (SUT)</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class Subject
{
    protected $observers = array();
    protected $name;

    public function __construct($name)
    {
        $this-&gt;name = $name;
    }

    public function getName()
    {
        return $this-&gt;name;
    }

    public function attach(Observer $observer)
    {
        $this-&gt;observers[] = $observer;
    }

    public function doSomething()
    {
        // Do something.
        // ...

        // Notify observers that we did something.
        $this-&gt;notify('something');
    }

    public function doSomethingBad()
    {
        foreach ($this-&gt;observers as $observer) {
            $observer-&gt;reportError(42, 'Something bad happened', $this);
        }
    }

    protected function notify($argument)
    {
        foreach ($this-&gt;observers as $observer) {
            $observer-&gt;update($argument);
        }
    }

    // Other methods.
}

class Observer
{
    public function update($argument)
    {
        // Do something.
    }

    public function reportError($errorCode, $errorMessage, Subject $subject)
    {
        // Do something
    }

    // Other methods.
}
?&gt;</pre></div></div><br class="example-break" /><p>
      <a id="idm140124620132944" class="indexterm"></a>

      <a class="xref" href="#test-doubles.mock-objects.examples.SubjectTest.php" title="Example 10.11: Testing that a method gets called once and with a specified argument">Example 10.11</a>
      shows how to use a mock object to test the interaction between
      <code class="literal">Subject</code> and <code class="literal">Observer</code> objects.
    </p><p>
      We first use the <code class="literal">getMock()</code> method that is provided by
      the <code class="literal">PHPUnit_Framework_TestCase</code> class to set up a mock
      object for the <code class="literal">Observer</code>. Since we give an array as the
      second (optional) parameter for the <code class="literal">getMock()</code> method,
      only the <code class="literal">update()</code> method of the
      <code class="literal">Observer</code> class is replaced by a mock implementation.
    </p><div class="example"><a id="test-doubles.mock-objects.examples.SubjectTest.php"></a><p class="title"><strong>Example 10.11: Testing that a method gets called once and with a specified argument</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class SubjectTest extends PHPUnit_Framework_TestCase
{
    public function testObserversAreUpdated()
    {
        // Create a mock for the Observer class,
        // only mock the update() method.
        $observer = $this-&gt;getMock('Observer', array('update'));

        // Set up the expectation for the update() method
        // to be called only once and with the string 'something'
        // as its parameter.
        $observer-&gt;expects($this-&gt;once())
                 -&gt;method('update')
                 -&gt;with($this-&gt;equalTo('something'));

        // Create a Subject object and attach the mocked
        // Observer object to it.
        $subject = new Subject('My subject');
        $subject-&gt;attach($observer);

        // Call the doSomething() method on the $subject object
        // which we expect to call the mocked Observer object's
        // update() method with the string 'something'.
        $subject-&gt;doSomething();
    }
}
?&gt;</pre></div></div><br class="example-break" /><p>
      The <code class="literal">with()</code> method can take any number of
      arguments, corresponding to the number of arguments to the
      method being mocked. You can specify more advanced constraints
      on the method's arguments than a simple match.
    </p><div class="example"><a id="test-doubles.mock-objects.examples.SubjectTest2.php"></a><p class="title"><strong>Example 10.12: Testing that a method gets called with a number of
      arguments constrained in different ways</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class SubjectTest extends PHPUnit_Framework_TestCase
{
    public function testErrorReported()
    {
        // Create a mock for the Observer class, mocking the
        // reportError() method
        $observer = $this-&gt;getMock('Observer', array('reportError'));

        $observer-&gt;expects($this-&gt;once())
                 -&gt;method('reportError')
                 -&gt;with($this-&gt;greaterThan(0),
                        $this-&gt;stringContains('Something'),
                        $this-&gt;anything());

        $subject = new Subject('My subject');
        $subject-&gt;attach($observer);

        // The doSomethingBad() method should report an error to the observer
        // via the reportError() method
        $subject-&gt;doSomethingBad();
    }
}
?&gt;</pre></div></div><br class="example-break" /><p>
      The <code class="literal">callback()</code> constraint can be used for more complex
      argument verification. This constraint takes a PHP callback as its only
      argument. The PHP callback will receive the argument to be verified as
      its only argument and should return <code class="literal">TRUE</code> if the
      argument passes verification and <code class="literal">FALSE</code> otherwise.
    </p><div class="example"><a id="test-doubles.mock-objects.examples.SubjectTest3.php"></a><p class="title"><strong>Example 10.13: More complex argument verification</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class SubjectTest extends PHPUnit_Framework_TestCase
{
    public function testErrorReported()
    {
        // Create a mock for the Observer class, mocking the
        // reportError() method
        $observer = $this-&gt;getMock('Observer', array('reportError'));

        $observer-&gt;expects($this-&gt;once())
                 -&gt;method('reportError')
                 -&gt;with($this-&gt;greaterThan(0),
                        $this-&gt;stringContains('Something'),
                        $this-&gt;callback(function($subject){
                          return is_callable(array($subject, 'getName')) &amp;&amp;
                                 $subject-&gt;getName() == 'My subject';
                        }));

        $subject = new Subject('My subject');
        $subject-&gt;attach($observer);

        // The doSomethingBad() method should report an error to the observer
        // via the reportError() method
        $subject-&gt;doSomethingBad();
    }
}
?&gt;</pre></div></div><br class="example-break" /><p>
      <a class="xref" href="#writing-tests-for-phpunit.assertions.assertThat.tables.constraints" title="Table 4.3. Constraints">Table 4.3</a>
      shows the constraints that can be applied to method arguments and
      <a class="xref" href="#test-doubles.mock-objects.tables.matchers" title="Table 10.1. Matchers">Table 10.1</a>
      shows the matchers that are available to specify the number of
      invocations.
    </p><div class="table"><a id="test-doubles.mock-objects.tables.matchers"></a><p class="title"><strong>Table 10.1. Matchers</strong></p><div class="table-contents"><table class="table" summary="Matchers" border="1"><colgroup><col /><col /></colgroup><thead><tr><th align="left">Matcher</th><th align="left">Meaning</th></tr></thead><tbody><tr><td align="left"><code class="literal">PHPUnit_Framework_MockObject_Matcher_AnyInvokedCount any()</code></td><td align="left">Returns a matcher that matches when the method it is evaluated for is executed zero or more times.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_MockObject_Matcher_InvokedCount never()</code></td><td align="left">Returns a matcher that matches when the method it is evaluated for is never executed.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_MockObject_Matcher_InvokedAtLeastOnce atLeastOnce()</code></td><td align="left">Returns a matcher that matches when the method it is evaluated for is executed at least once.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_MockObject_Matcher_InvokedCount once()</code></td><td align="left">Returns a matcher that matches when the method it is evaluated for is executed exactly once.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_MockObject_Matcher_InvokedCount exactly(int $count)</code></td><td align="left">Returns a matcher that matches when the method it is evaluated for is executed exactly <code class="literal">$count</code> times.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_MockObject_Matcher_InvokedAtIndex at(int $index)</code></td><td align="left">Returns a matcher that matches when the method it is evaluated for is invoked at the given <code class="literal">$index</code>.</td></tr></tbody></table></div></div><br class="table-break" /><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        The <code class="literal">$index</code> parameter for the <code class="literal">at()</code>
        matcher refers to the index, starting at zero, in <span class="emphasis"><em>all method
        invocations</em></span> for a given mock object. Exercise caution when
        using this matcher as it can lead to brittle tests which are too
        closely tied to specific implementation details.
      </p></div><p>
      <a id="idm140124620096480" class="indexterm"></a>

      The <code class="literal">getMockForAbstractClass()</code> method returns a mock
      object for an abstract class. All abstract methods of the given abstract
      class are mocked. This allows for testing the concrete methods of an
      abstract class.
    </p><div class="example"><a id="test-doubles.mock-objects.examples.AbstractClassTest.php"></a><p class="title"><strong>Example 10.14: Testing the concrete methods of an abstract class</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
abstract class AbstractClass
{
    public function concreteMethod()
    {
        return $this-&gt;abstractMethod();
    }

    public abstract function abstractMethod();
}

class AbstractClassTest extends PHPUnit_Framework_TestCase
{
    public function testConcreteMethod()
    {
        $stub = $this-&gt;getMockForAbstractClass('AbstractClass');
        $stub-&gt;expects($this-&gt;any())
             -&gt;method('abstractMethod')
             -&gt;will($this-&gt;returnValue(TRUE));

        $this-&gt;assertTrue($stub-&gt;concreteMethod());
    }
}
?&gt;</pre></div></div><br class="example-break" /><div class="example"><a id="test-doubles.mock-objects.examples.clone-object-parameters-usecase.php"></a><p class="title"><strong>Example 10.15: Testing that a method gets called once and with the identical object as was passed</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class FooTest extends PHPUnit_Framework_TestCase
{
    public function testIdenticalObjectPassed()
    {
        $expectedObject = new stdClass;

        $mock = $this-&gt;getMock('stdClass', array('foo'));
        $mock-&gt;expects($this-&gt;once())
             -&gt;method('foo')
             -&gt;with($this-&gt;identicalTo($expectedObject));

        $mock-&gt;foo($expectedObject);
    }
}
?&gt;</pre></div></div><br class="example-break" /><div class="example"><a id="test-doubles.mock-objects.examples.enable-clone-object-parameters.php"></a><p class="title"><strong>Example 10.16: Create a mock object with cloning parameters enabled</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class FooTest extends PHPUnit_Framework_TestCase
{
    public function testIdenticalObjectPassed()
    {
        $cloneArguments = true;

        $mock = $this-&gt;getMock(
            'stdClass',
            array(),
            array(),
            '',
            FALSE,
            TRUE,
            TRUE,
            $cloneArguments
        );

        // or using the mock builder
        $mock = $this-&gt;getMockBuilder('stdClass')-&gt;enableArgumentCloning()-&gt;getMock();

        // now your mock clones parameters so the identicalTo constraint will fail.
    }
}
?&gt;</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="test-doubles.stubbing-and-mocking-web-services"></a>Stubbing and Mocking Web Services</h2></div></div></div><p>
      <a id="idm140124620086992" class="indexterm"></a>

      When your application interacts with a web service you want to test it
      without actually interacting with the web service. To make the stubbing
      and mocking of web services easy, the <code class="literal">getMockFromWsdl()</code>
      can be used just like <code class="literal">getMock()</code> (see above). The only
      difference is that <code class="literal">getMockFromWsdl()</code> returns a stub or
      mock based on a web service description in WSDL and <code class="literal">getMock()</code>
      returns a stub or mock based on a PHP class or interface.
    </p><p>
      <a class="xref" href="#test-doubles.stubbing-and-mocking-web-services.examples.GoogleTest.php" title="Example 10.17: Stubbing a web service">Example 10.17</a>
      shows how <code class="literal">getMockFromWsdl()</code> can be used to stub, for
      example, the web service described in <code class="filename">GoogleSearch.wsdl</code>.
    </p><div class="example"><a id="test-doubles.stubbing-and-mocking-web-services.examples.GoogleTest.php"></a><p class="title"><strong>Example 10.17: Stubbing a web service</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class GoogleTest extends PHPUnit_Framework_TestCase
{
    public function testSearch()
    {
        $googleSearch = $this-&gt;getMockFromWsdl(
          'GoogleSearch.wsdl', 'GoogleSearch'
        );

        $directoryCategory = new stdClass;
        $directoryCategory-&gt;fullViewableName = '';
        $directoryCategory-&gt;specialEncoding = '';

        $element = new stdClass;
        $element-&gt;summary = '';
        $element-&gt;URL = 'http://www.phpunit.de/';
        $element-&gt;snippet = '...';
        $element-&gt;title = '&lt;b&gt;PHPUnit&lt;/b&gt;';
        $element-&gt;cachedSize = '11k';
        $element-&gt;relatedInformationPresent = TRUE;
        $element-&gt;hostName = 'www.phpunit.de';
        $element-&gt;directoryCategory = $directoryCategory;
        $element-&gt;directoryTitle = '';

        $result = new stdClass;
        $result-&gt;documentFiltering = FALSE;
        $result-&gt;searchComments = '';
        $result-&gt;estimatedTotalResultsCount = 378000;
        $result-&gt;estimateIsExact = FALSE;
        $result-&gt;resultElements = array($element);
        $result-&gt;searchQuery = 'PHPUnit';
        $result-&gt;startIndex = 1;
        $result-&gt;endIndex = 1;
        $result-&gt;searchTips = '';
        $result-&gt;directoryCategories = array();
        $result-&gt;searchTime = 0.248822;

        $googleSearch-&gt;expects($this-&gt;any())
                     -&gt;method('doGoogleSearch')
                     -&gt;will($this-&gt;returnValue($result));

        /**
         * $googleSearch-&gt;doGoogleSearch() will now return a stubbed result and
         * the web service's doGoogleSearch() method will not be invoked.
         */
        $this-&gt;assertEquals(
          $result,
          $googleSearch-&gt;doGoogleSearch(
            '00000000000000000000000000000000',
            'PHPUnit',
            0,
            1,
            FALSE,
            '',
            FALSE,
            '',
            '',
            ''
          )
        );
    }
}
?&gt;</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="test-doubles.mocking-the-filesystem"></a>Mocking the Filesystem</h2></div></div></div><p>
      <a class="ulink" href="https://github.com/mikey179/vfsStream" target="_top">vfsStream</a>
      is a <a class="ulink" href="http://www.php.net/streams" target="_top">stream wrapper</a> for a
      <a class="ulink" href="http://en.wikipedia.org/wiki/Virtual_file_system" target="_top">virtual
      filesystem</a> that may be helpful in unit tests to mock the real
      filesystem.
    </p><p>
      Simply add a dependency on <code class="literal">mikey179/vfsStream</code> to your
      project's <code class="literal">composer.json</code> file if you use
      <a class="ulink" href="http://getcomposer.org/" target="_top">Composer</a> to manage the
      dependencies of your project. Here is a minimal example of a
      <code class="literal">composer.json</code> file that just defines a development-time
      dependency on PHPUnit 3.7 and vfsStream:
    </p><pre class="programlisting">{
    "require-dev": {
        "phpunit/phpunit": "3.7.*",
        "mikey179/vfsStream": "1.*"
    }
}</pre><p>
      <a class="xref" href="#test-doubles.mocking-the-filesystem.examples.Example.php" title="Example 10.18: A class that interacts with the filesystem">Example 10.18</a>
      shows a class that interacts with the filesystem.
    </p><div class="example"><a id="test-doubles.mocking-the-filesystem.examples.Example.php"></a><p class="title"><strong>Example 10.18: A class that interacts with the filesystem</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class Example
{
    protected $id;
    protected $directory;

    public function __construct($id)
    {
        $this-&gt;id = $id;
    }

    public function setDirectory($directory)
    {
        $this-&gt;directory = $directory . DIRECTORY_SEPARATOR . $this-&gt;id;

        if (!file_exists($this-&gt;directory)) {
            mkdir($this-&gt;directory, 0700, TRUE);
        }
    }
}?&gt;</pre></div></div><br class="example-break" /><p>
      Without a virtual filesystem such as vfsStream we cannot test the
      <code class="literal">setDirectory()</code> method in isolation from external
      influence (see <a class="xref" href="#test-doubles.mocking-the-filesystem.examples.ExampleTest.php" title="Example 10.19: Testing a class that interacts with the filesystem">Example 10.19</a>).
    </p><div class="example"><a id="test-doubles.mocking-the-filesystem.examples.ExampleTest.php"></a><p class="title"><strong>Example 10.19: Testing a class that interacts with the filesystem</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
require_once 'Example.php';

class ExampleTest extends PHPUnit_Framework_TestCase
{
    protected function setUp()
    {
        if (file_exists(dirname(__FILE__) . '/id')) {
            rmdir(dirname(__FILE__) . '/id');
        }
    }

    public function testDirectoryIsCreated()
    {
        $example = new Example('id');
        $this-&gt;assertFalse(file_exists(dirname(__FILE__) . '/id'));

        $example-&gt;setDirectory(dirname(__FILE__));
        $this-&gt;assertTrue(file_exists(dirname(__FILE__) . '/id'));
    }

    protected function tearDown()
    {
        if (file_exists(dirname(__FILE__) . '/id')) {
            rmdir(dirname(__FILE__) . '/id');
        }
    }
}
?&gt;</pre></div></div><br class="example-break" /><p>
      The approach above has several drawbacks:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>As with any external resource, there might be intermittent problems with the filesystem. This makes tests interacting with it flaky.</p></li><li class="listitem"><p>In the <code class="literal">setUp()</code> and <code class="literal">tearDown()</code> methods we have to ensure that the directory does not exist before and after the test.</p></li><li class="listitem"><p>When the test execution terminates before the <code class="literal">tearDown()</code> method is invoked the directory will stay in the filesystem.</p></li></ul></div><p>
      <a class="xref" href="#test-doubles.mocking-the-filesystem.examples.ExampleTest2.php" title="Example 10.20: Mocking the filesystem in a test for a class that interacts with the filesystem">Example 10.20</a>
      shows how vfsStream can be used to mock the filesystem in a test for a
      class that interacts with the filesystem.
    </p><div class="example"><a id="test-doubles.mocking-the-filesystem.examples.ExampleTest2.php"></a><p class="title"><strong>Example 10.20: Mocking the filesystem in a test for a class that interacts with the filesystem</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
require_once 'vfsStream/vfsStream.php';
require_once 'Example.php';

class ExampleTest extends PHPUnit_Framework_TestCase
{
    public function setUp()
    {
        vfsStreamWrapper::register();
        vfsStreamWrapper::setRoot(new vfsStreamDirectory('exampleDir'));
    }

    public function testDirectoryIsCreated()
    {
        $example = new Example('id');
        $this-&gt;assertFalse(vfsStreamWrapper::getRoot()-&gt;hasChild('id'));

        $example-&gt;setDirectory(vfsStream::url('exampleDir'));
        $this-&gt;assertTrue(vfsStreamWrapper::getRoot()-&gt;hasChild('id'));
    }
}
?&gt;</pre></div></div><br class="example-break" /><p>
      This has several advantages:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>The test itself is more concise.</p></li><li class="listitem"><p>vfsStream gives the test developer full control over what the filesystem environment looks like to the tested code.</p></li><li class="listitem"><p>Since the filesystem operations do not operate on the real filesystem anymore, cleanup operations in a <code class="literal">tearDown()</code> method are no longer required.</p></li></ul></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="testing-practices"></a>Chapter 11. Testing Practices</h1></div></div></div><div class="blockquote"><table border="0" class="blockquote" style="width: 100%; cellspacing: 0; cellpadding: 0;" summary="Block quote"><tr><td width="10%" valign="top"> </td><td width="80%" valign="top"><p>
      You can always write more tests. However, you will quickly find that
      only a fraction of the tests you can imagine are actually useful. What
      you want is to write tests that fail even though you think they should
      work, or tests that succeed even though you think they should fail.
      Another way to think of it is in cost/benefit terms. You want to write
      tests that will pay you back with information.
    </p></td><td width="10%" valign="top"> </td></tr><tr><td width="10%" valign="top"> </td><td colspan="2" align="right" valign="top">--<span class="attribution">Erich Gamma</span></td></tr></table></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="testing-practices.during-development"></a>During Development</h2></div></div></div><p>
      <a id="idm140124621242224" class="indexterm"></a>

      When you need to make a change to the internal structure of the software
      you are working on to make it easier to understand and cheaper to modify
      without changing its observable behavior, a test suite is invaluable in
      applying these so called <a class="ulink" href="http://martinfowler.com/bliki/DefinitionOfRefactoring.html" target="_top">refactorings</a>
      safely. Otherwise, you might not notice the system breaking while you
      are carrying out the restructuring.
    </p><p>
      The following conditions will help you to improve the code and design
      of your project, while using unit tests to verify that the refactoring's
      transformation steps are, indeed, behavior-preserving and do not
      introduce errors:
    </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>All unit tests run correctly.</p></li><li class="listitem"><p>The code communicates its design principles.</p></li><li class="listitem"><p>The code contains no redundancies.</p></li><li class="listitem"><p>The code contains the minimal number of classes and methods.</p></li></ol></div><p>
      When you need to add new functionality to the system, write the tests
      first. Then, you will be done developing when the test runs. This
      practice will be discussed in detail in the next chapter.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="testing-practices.during-debugging"></a>During Debugging</h2></div></div></div><p>
      When you get a defect report, your impulse might be to fix the defect as
      quickly as possible. Experience shows that this impulse will not serve
      you well; it is likely that the fix for the defect causes another
      defect.
    </p><p>
      You can hold your impulse in check by doing the following:
    </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
          Verify that you can reproduce the defect.
        </p></li><li class="listitem"><p>
          Find the smallest-scale demonstration of the defect in the code.
          For example, if a number appears incorrectly in an output, find the
          object that is computing that number.
        </p></li><li class="listitem"><p>
          Write an automated test that fails now but will succeed when the
          defect is fixed.
        </p></li><li class="listitem"><p>
          Fix the defect.
        </p></li></ol></div><p>
      Finding the smallest reliable reproduction of the defect gives you the
      opportunity to really examine the cause of the defect. The test you
      write will improve the chances that when you fix the defect, you really
      fix it, because the new test reduces the likelihood of undoing the fix
      with future code changes. All the tests you wrote before reduce the
      likelihood of inadvertently causing a different problem.
    </p><div class="blockquote"><table border="0" class="blockquote" style="width: 100%; cellspacing: 0; cellpadding: 0;" summary="Block quote"><tr><td width="10%" valign="top"> </td><td width="80%" valign="top"><p>
        Unit testing offers many advantages:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Testing gives code authors and reviewers confidence that patches produce the correct results.</p></li><li class="listitem"><p>Authoring testcases is a good impetus for developers to discover edge cases.</p></li><li class="listitem"><p>Testing provides a good way to catch regressions quickly, and to make sure that no regression will be repeated twice.</p></li><li class="listitem"><p>Unit tests provide working examples for how to use an API and can significantly aid documentation efforts.</p></li></ul></div><p>
        Overall, integrated unit testing makes the cost and risk of any
        individual change smaller. It will allow the project to make [...]
        major architectural improvements [...] quickly and confidently.
      </p></td><td width="10%" valign="top"> </td></tr><tr><td width="10%" valign="top"> </td><td colspan="2" align="right" valign="top">--<span class="attribution">Benjamin Smedberg</span></td></tr></table></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="test-driven-development"></a>Chapter 12. Test-Driven Development</h1></div></div></div><p>
    <a id="idm140124621108000" class="indexterm"></a>
    <a id="idm140124621107456" class="indexterm"></a>
    <a id="idm140124621276640" class="indexterm"></a>
    <a id="idm140124621276064" class="indexterm"></a>
    <a id="idm140124621275488" class="indexterm"></a>

    Unit Tests are a vital part of several software development practices
    and processes such as Test-First Programming,
    <a class="ulink" href="http://en.wikipedia.org/wiki/Extreme_Programming" target="_top">Extreme Programming</a>,
    and <a class="ulink" href="http://en.wikipedia.org/wiki/Test-driven_development" target="_top">Test-Driven Development</a>.
    They also allow for <a class="ulink" href="http://en.wikipedia.org/wiki/Design_by_Contract" target="_top">Design-by-Contract</a>
    in programming languages that do not support this methodology with
    language constructs.
  </p><p>
    You can use PHPUnit to write tests once you are done programming.
    However, the sooner a test is written after an error has been introduced,
    the more valuable the test is. So instead of writing tests months after
    the code is "complete", we can write tests days or hours or minutes after
    the possible introduction of a defect. Why stop there? Why not write the
    tests a little before the possible introduction of a defect?
  </p><p>
    Test-First Programming, which is part of Extreme Programming and
    Test-Driven Development, builds upon this idea and takes it to the
    extreme. With today's computational power, we have the opportunity to
    run thousands of tests thousands of times per day. We can use the
    feedback from all of these tests to program in small steps, each of
    which carries with it the assurance of a new automated test in addition
    to all the tests that have come before. The tests are like pitons,
    assuring you that, no matter what happens, once you have made progress
    you can only fall so far.
  </p><p>
    When you first write the test it cannot possibly run, because you are
    calling on objects and methods that have not been programmed yet. This
    might feel strange at first, but after a while you will get used to it.
    Think of Test-First Programming as a pragmatic approach to following the
    object-oriented programming principle of programming to an interface
    instead of programming to an implementation: while you are writing the
    test you are thinking about the interface of the object you are
    testing -- what does this object look like from the outside. When you
    go to make the test really work, you are thinking about pure
    implementation. The interface is fixed by the failing test.
  </p><div class="blockquote"><table border="0" class="blockquote" style="width: 100%; cellspacing: 0; cellpadding: 0;" summary="Block quote"><tr><td width="10%" valign="top"> </td><td width="80%" valign="top"><p>
      The point of <a class="ulink" href="http://en.wikipedia.org/wiki/Test-driven_development" target="_top">Test-Driven Development</a>
      is to drive out the functionality the software actually needs, rather
      than what the programmer thinks it probably ought to have. The way it
      does this seems at first counterintuitive, if not downright silly, but
      it not only makes sense, it also quickly becomes a natural and elegant
      way to develop software.
    </p></td><td width="10%" valign="top"> </td></tr><tr><td width="10%" valign="top"> </td><td colspan="2" align="right" valign="top">--<span class="attribution">Dan North</span></td></tr></table></div><p>
    What follows is necessarily an abbreviated introduction to Test-Driven
    Development. You can explore the topic further in other books, such as
    <span class="emphasis"><em>Test-Driven Development</em></span> <a class="xref" href="#Beck2002" title="Test Driven Development by Example">[<abbr class="abbrev">Beck2002</abbr>]</a>
    by Kent Beck or Dave Astels' <span class="emphasis"><em>A Practical Guide to Test-Driven
    Development</em></span> <a class="xref" href="#Astels2003" title="Test Driven Development">[<abbr class="abbrev">Astels2003</abbr>]</a>.
  </p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="test-driven-development.bankaccount-example"></a>BankAccount Example</h2></div></div></div><p>
      In this section, we will look at the example of a class that represents
      a bank account. The contract for the <code class="literal">BankAccount</code>
      class not only requires methods to get and set the bank account's
      balance, as well as methods to deposit and withdraw money. It also
      specifies the following two conditions that must be ensured:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>The bank account's initial balance must be zero.</p></li><li class="listitem"><p>The bank account's balance cannot become negative.</p></li></ul></div><p>
      We write the tests for the <code class="literal">BankAccount</code> class before we
      write the code for the class itself. We use the contract conditions as the
      basis for the tests and name the test methods accordingly, as shown in
      <a class="xref" href="#test-driven-development.bankaccount-example.examples.BankAccountTest.php" title="Example 12.1: Tests for the BankAccount class">Example 12.1</a>.
    </p><div class="example"><a id="test-driven-development.bankaccount-example.examples.BankAccountTest.php"></a><p class="title"><strong>Example 12.1: Tests for the BankAccount class</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
require_once 'BankAccount.php';

class BankAccountTest extends PHPUnit_Framework_TestCase
{
    protected $ba;

    protected function setUp()
    {
        $this-&gt;ba = new BankAccount;
    }

    public function testBalanceIsInitiallyZero()
    {
        $this-&gt;assertEquals(0, $this-&gt;ba-&gt;getBalance());
    }

    public function testBalanceCannotBecomeNegative()
    {
        try {
            $this-&gt;ba-&gt;withdrawMoney(1);
        }

        catch (BankAccountException $e) {
            $this-&gt;assertEquals(0, $this-&gt;ba-&gt;getBalance());

            return;
        }

        $this-&gt;fail();
    }

    public function testBalanceCannotBecomeNegative2()
    {
        try {
            $this-&gt;ba-&gt;depositMoney(-1);
        }

        catch (BankAccountException $e) {
            $this-&gt;assertEquals(0, $this-&gt;ba-&gt;getBalance());

            return;
        }

        $this-&gt;fail();
    }
}
?&gt;</pre></div></div><br class="example-break" /><p>
      We now write the minimal amount of code needed for the first test,
      <code class="literal">testBalanceIsInitiallyZero()</code>, to pass. In our
      example this amounts to implementing the <code class="literal">getBalance()</code>
      method of the <code class="literal">BankAccount</code> class, as shown in
      <a class="xref" href="#test-driven-development.bankaccount-example.examples.BankAccount.php" title="Example 12.2: Code needed for the testBalanceIsInitiallyZero() test to pass">Example 12.2</a>.
    </p><div class="example"><a id="test-driven-development.bankaccount-example.examples.BankAccount.php"></a><p class="title"><strong>Example 12.2: Code needed for the testBalanceIsInitiallyZero() test to pass</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class BankAccount
{
    protected $balance = 0;

    public function getBalance()
    {
        return $this-&gt;balance;
    }
}
?&gt;</pre></div></div><br class="example-break" /><p>
      The test for the first contract condition now passes, but the tests for
      the second contract condition fail because we have yet to implement the
      methods that these tests call.
    </p><pre class="screen"><strong class="userinput"><code>phpunit BankAccountTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

.
Fatal error: Call to undefined method BankAccount::withdrawMoney()</pre><p>
      For the tests that ensure the second contract condition to pass, we now
      need to implement the <code class="literal">withdrawMoney()</code>,
      <code class="literal">depositMoney()</code>, and <code class="literal">setBalance()</code>
      methods, as shown in
      <a class="xref" href="#test-driven-development.bankaccount-example.examples.BankAccount2.php" title="Example 12.3: The complete BankAccount class">Example 12.3</a>.
      These methods are written in a such a way that they raise an
      <code class="literal">BankAccountException</code> when they are called with
      illegal values that would violate the contract conditions.
    </p><div class="example"><a id="test-driven-development.bankaccount-example.examples.BankAccount2.php"></a><p class="title"><strong>Example 12.3: The complete BankAccount class</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class BankAccount
{
    protected $balance = 0;

    public function getBalance()
    {
        return $this-&gt;balance;
    }

    protected function setBalance($balance)
    {
        if ($balance &gt;= 0) {
            $this-&gt;balance = $balance;
        } else {
            throw new BankAccountException;
        }
    }

    public function depositMoney($balance)
    {
        $this-&gt;setBalance($this-&gt;getBalance() + $balance);

        return $this-&gt;getBalance();
    }

    public function withdrawMoney($balance)
    {
        $this-&gt;setBalance($this-&gt;getBalance() - $balance);

        return $this-&gt;getBalance();
    }
}
?&gt;</pre></div></div><br class="example-break" /><p>
      The tests that ensure the second contract condition now pass, too:
    </p><pre class="screen"><strong class="userinput"><code>phpunit BankAccountTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

...

Time: 0 seconds


OK (3 tests, 3 assertions)</pre><p>
      <a id="idm140124620261920" class="indexterm"></a>

      Alternatively, you can use the static assertion methods provided by the
      <code class="literal">PHPUnit_Framework_Assert</code> class to write the contract
      conditions as design-by-contract style assertions into your code, as
      shown in <a class="xref" href="#test-driven-development.bankaccount-example.examples.BankAccount3.php" title="Example 12.4: The BankAccount class with Design-by-Contract assertions">Example 12.4</a>.
      When one of these assertions fails, an
      <code class="literal">PHPUnit_Framework_AssertionFailedError</code> exception
      will be raised. With this approach, you write less code for the contract
      condition checks and the tests become more readable. However, you add a
      runtime dependency on PHPUnit to your project.
    </p><div class="example"><a id="test-driven-development.bankaccount-example.examples.BankAccount3.php"></a><p class="title"><strong>Example 12.4: The BankAccount class with Design-by-Contract assertions</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class BankAccount
{
    private $balance = 0;

    public function getBalance()
    {
        return $this-&gt;balance;
    }

    protected function setBalance($balance)
    {
        PHPUnit_Framework_Assert::assertTrue($balance &gt;= 0);

        $this-&gt;balance = $balance;
    }

    public function depositMoney($amount)
    {
        PHPUnit_Framework_Assert::assertTrue($amount &gt;= 0);

        $this-&gt;setBalance($this-&gt;getBalance() + $amount);

        return $this-&gt;getBalance();
    }

    public function withdrawMoney($amount)
    {
        PHPUnit_Framework_Assert::assertTrue($amount &gt;= 0);
        PHPUnit_Framework_Assert::assertTrue($this-&gt;balance &gt;= $amount);

        $this-&gt;setBalance($this-&gt;getBalance() - $amount);

        return $this-&gt;getBalance();
    }
}
?&gt;</pre></div></div><br class="example-break" /><p>
      By writing the contract conditions into the tests, we have used
      Design-by-Contract to program the <code class="literal">BankAccount</code> class.
      We then wrote, following the Test-First Programming approach, the
      code needed to make the tests pass. However, we forgot to write
      tests that call <code class="literal">setBalance()</code>,
      <code class="literal">depositMoney()</code>, and <code class="literal">withdrawMoney()</code>
      with legal values that do not violate the contract conditions.
      We need a means to test our tests or at least to measure their quality.
      Such a means is the analysis of code-coverage information that we will
      discuss next.
    </p></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="behaviour-driven-development"></a>Chapter 13. Behaviour-Driven Development</h1></div></div></div><p>
    <a id="idm140124621456864" class="indexterm"></a>
    <a id="idm140124621456320" class="indexterm"></a>

    In <a class="xref" href="#Astels2006" title="A New Look at Test-Driven Development">[<abbr class="abbrev">Astels2006</abbr>]</a>, Dave Astels makes the following points:
  </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        <a class="ulink" href="http://en.wikipedia.org/wiki/Extreme_Programming" target="_top">Extreme Programming</a>
        originally had the rule to test everything that could possibly break.
      </p></li><li class="listitem"><p>
        Now, however, the practice of testing in Extreme Programming has evolved
        into <a class="ulink" href="http://en.wikipedia.org/wiki/Test-driven_development" target="_top">Test-Driven Development</a>
        (see <a class="xref" href="#test-driven-development" title="Chapter 12. Test-Driven Development">Chapter 12</a>).
      </p></li><li class="listitem"><p>
        But the tools still force developers to think in terms of tests and
        assertions instead of specifications.
      </p></li></ul></div><div class="blockquote"><table border="0" class="blockquote" style="width: 100%; cellspacing: 0; cellpadding: 0;" summary="Block quote"><tr><td width="10%" valign="top"> </td><td width="80%" valign="top"><div class="blockquote-title"><p><strong>So if it's not about testing, what's it about?</strong></p></div><p>
      It's about figuring out what you are trying to do before you run off
      half-cocked to try to do it. You write a specification that nails down a
      small aspect of behaviour in a concise, unambiguous, and executable form.
      It's that simple. Does that mean you write tests? No. It means you write
      specifications of what your code will have to do. It means you specify the
      behaviour of your code ahead of time. But not far ahead of time. In fact,
      just before you write the code is best because that's when you have as
      much information at hand as you will up to that point. Like well done TDD,
      you work in tiny increments... specifying one small aspect of behaviour at
      a time, then implementing it.
    </p><p>
      When you realize that it's all about specifying behaviour and not writing
      tests, your point of view shifts. Suddenly the idea of having a Test class
      for each of your production classes is ridiculously limiting. And the
      thought of testing each of your methods with its own test method (in a 1-1
      relationship) will be laughable.
    </p></td><td width="10%" valign="top"> </td></tr><tr><td width="10%" valign="top"> </td><td colspan="2" align="right" valign="top">--<span class="attribution">Dave Astels</span></td></tr></table></div><p>
    <a id="idm140124620244800" class="indexterm"></a>
    <a id="idm140124620244208" class="indexterm"></a>

    The focus of <a class="ulink" href="http://en.wikipedia.org/wiki/Behavior_driven_development" target="_top">Behaviour-Driven Development</a>
    is "the language and interactions used in the process of software development.
    Behavior-driven developers use their native language in combination with the
    ubiquitous language of <a class="ulink" href="http://en.wikipedia.org/wiki/Domain_driven_design" target="_top">Domain-Driven Design</a>
    to describe the purpose and benefit of their code. This allows the developers
    to focus on why the code should be created, rather than the technical details,
    and minimizes translation between the technical language in which the code
    is written and the domain language spoken by the" domain experts.
  </p><div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Caution</h3><p>
      You want to use <a class="ulink" href="http://behat.org/" target="_top">Behat</a> for
      Behaviour-Driven Development instead of the
      <code class="literal">PHPUnit_Extensions_Story_TestCase</code> extension to PHPUnit
      that is discussed in the remainder of this chapter.
    </p></div><p>
    <a id="idm140124620239408" class="indexterm"></a>

    The <code class="literal">PHPUnit_Extensions_Story_TestCase</code> class adds a story
    framework that faciliates the definition of a
    <a class="ulink" href="http://en.wikipedia.org/wiki/Domain-specific_programming_language" target="_top">Domain-Specific Language</a>
    for Behaviour-Driven Development. It can be installed like this:
  </p><pre class="screen"><strong class="userinput"><code>pear install phpunit/PHPUnit_Story</code></strong></pre><p>
    Inside a <span class="emphasis"><em>scenario</em></span>, <code class="literal">given()</code>,
    <code class="literal">when()</code>, and <code class="literal">then()</code> each represent a
    <span class="emphasis"><em>step</em></span>. <code class="literal">and()</code> is the same kind as the
    previous step. The following methods are declared <code class="literal">abstract</code>
    in <code class="literal">PHPUnit_Extensions_Story_TestCase</code> and need to be
    implemented:
  </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">runGiven(&amp;$world, $action, $arguments)</code></p><p>...</p></li><li class="listitem"><p><code class="literal">runWhen(&amp;$world, $action, $arguments)</code></p><p>...</p></li><li class="listitem"><p><code class="literal">runThen(&amp;$world, $action, $arguments)</code></p><p>...</p></li></ul></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="behaviour-driven-development.bowlinggame-example"></a>BowlingGame Example</h2></div></div></div><p>
      In this section, we will look at the example of a class that calculates
      the score for a game of bowling. The rules for this are as follows:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>The game consists of 10 frames.</p></li><li class="listitem"><p>In each frame the player has two opportunities to knock down 10 pins.</p></li><li class="listitem"><p>The score for a frame is the total number of pins knocked down, plus bonuses for strikes and spares.</p></li><li class="listitem"><p>A spare is when the player knocks down all 10 pins in two tries.</p><p>The bonus for that frame is the number of pins knocked down by the next roll.</p></li><li class="listitem"><p>A strike is when the player knocks down all 10 pins on the first try.</p><p>The bonus for that frame is the value of the next two balls rolled.</p></li></ul></div><p>
      <a class="xref" href="#behaviour-driven-development.bowlinggame-example.examples.BowlingGameSpec.php" title="Example 13.1: Specification for the BowlingGame class">Example 13.1</a>
      shows how the above rules can be written down as specification scenarios
      using <code class="literal">PHPUnit_Extensions_Story_TestCase</code>.
    </p><div class="example"><a id="behaviour-driven-development.bowlinggame-example.examples.BowlingGameSpec.php"></a><p class="title"><strong>Example 13.1: Specification for the BowlingGame class</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
require_once 'PHPUnit/Extensions/Story/TestCase.php';
require_once 'BowlingGame.php';

class BowlingGameSpec extends PHPUnit_Extensions_Story_TestCase
{
    /**
     * @scenario
     */
    public function scoreForGutterGameIs0()
    {
        $this-&gt;given('New game')
             -&gt;then('Score should be', 0);
    }

    /**
     * @scenario
     */
    public function scoreForAllOnesIs20()
    {
        $this-&gt;given('New game')
             -&gt;when('Player rolls', 1)
             -&gt;and('Player rolls', 1)
             -&gt;and('Player rolls', 1)
             -&gt;and('Player rolls', 1)
             -&gt;and('Player rolls', 1)
             -&gt;and('Player rolls', 1)
             -&gt;and('Player rolls', 1)
             -&gt;and('Player rolls', 1)
             -&gt;and('Player rolls', 1)
             -&gt;and('Player rolls', 1)
             -&gt;and('Player rolls', 1)
             -&gt;and('Player rolls', 1)
             -&gt;and('Player rolls', 1)
             -&gt;and('Player rolls', 1)
             -&gt;and('Player rolls', 1)
             -&gt;and('Player rolls', 1)
             -&gt;and('Player rolls', 1)
             -&gt;and('Player rolls', 1)
             -&gt;and('Player rolls', 1)
             -&gt;and('Player rolls', 1)
             -&gt;then('Score should be', 20);
    }

    /**
     * @scenario
     */
    public function scoreForOneSpareAnd3Is16()
    {
        $this-&gt;given('New game')
             -&gt;when('Player rolls', 5)
             -&gt;and('Player rolls', 5)
             -&gt;and('Player rolls', 3)
             -&gt;then('Score should be', 16);
    }

    /**
     * @scenario
     */
    public function scoreForOneStrikeAnd3And4Is24()
    {
        $this-&gt;given('New game')
             -&gt;when('Player rolls', 10)
             -&gt;and('Player rolls', 3)
             -&gt;and('Player rolls', 4)
             -&gt;then('Score should be', 24);
    }

    /**
     * @scenario
     */
    public function scoreForPerfectGameIs300()
    {
        $this-&gt;given('New game')
             -&gt;when('Player rolls', 10)
             -&gt;and('Player rolls', 10)
             -&gt;and('Player rolls', 10)
             -&gt;and('Player rolls', 10)
             -&gt;and('Player rolls', 10)
             -&gt;and('Player rolls', 10)
             -&gt;and('Player rolls', 10)
             -&gt;and('Player rolls', 10)
             -&gt;and('Player rolls', 10)
             -&gt;and('Player rolls', 10)
             -&gt;and('Player rolls', 10)
             -&gt;and('Player rolls', 10)
             -&gt;then('Score should be', 300);
    }

    public function runGiven(&amp;$world, $action, $arguments)
    {
        switch($action) {
            case 'New game': {
                $world['game']  = new BowlingGame;
                $world['rolls'] = 0;
            }
            break;

            default: {
                return $this-&gt;notImplemented($action);
            }
        }
    }

    public function runWhen(&amp;$world, $action, $arguments)
    {
        switch($action) {
            case 'Player rolls': {
                $world['game']-&gt;roll($arguments[0]);
                $world['rolls']++;
            }
            break;

            default: {
                return $this-&gt;notImplemented($action);
            }
        }
    }

    public function runThen(&amp;$world, $action, $arguments)
    {
        switch($action) {
            case 'Score should be': {
                for ($i = $world['rolls']; $i &lt; 20; $i++) {
                    $world['game']-&gt;roll(0);
                }

                $this-&gt;assertEquals($arguments[0], $world['game']-&gt;score());
            }
            break;

            default: {
                return $this-&gt;notImplemented($action);
            }
        }
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit --printer PHPUnit_Extensions_Story_ResultPrinter_Text BowlingGameSpec</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

BowlingGameSpec
 [x] Score for gutter game is 0

   Given New game 
    Then Score should be 0

 [x] Score for all ones is 20

   Given New game 
    When Player rolls 1
     and Player rolls 1
     and Player rolls 1
     and Player rolls 1
     and Player rolls 1
     and Player rolls 1
     and Player rolls 1
     and Player rolls 1
     and Player rolls 1
     and Player rolls 1
     and Player rolls 1
     and Player rolls 1
     and Player rolls 1
     and Player rolls 1
     and Player rolls 1
     and Player rolls 1
     and Player rolls 1
     and Player rolls 1
     and Player rolls 1
     and Player rolls 1
    Then Score should be 20

 [x] Score for one spare and 3 is 16

   Given New game 
    When Player rolls 5
     and Player rolls 5
     and Player rolls 3
    Then Score should be 16

 [x] Score for one strike and 3 and 4 is 24

   Given New game 
    When Player rolls 10
     and Player rolls 3
     and Player rolls 4
    Then Score should be 24

 [x] Score for perfect game is 300

   Given New game 
    When Player rolls 10
     and Player rolls 10
     and Player rolls 10
     and Player rolls 10
     and Player rolls 10
     and Player rolls 10
     and Player rolls 10
     and Player rolls 10
     and Player rolls 10
     and Player rolls 10
     and Player rolls 10
     and Player rolls 10
    Then Score should be 300

Scenarios: 5, Failed: 0, Skipped: 0, Incomplete: 0.</pre></div></div><br class="example-break" /></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="code-coverage-analysis"></a>Chapter 14. Code Coverage Analysis</h1></div></div></div><div class="blockquote"><table border="0" class="blockquote" style="width: 100%; cellspacing: 0; cellpadding: 0;" summary="Block quote"><tr><td width="10%" valign="top"> </td><td width="80%" valign="top"><p>
      The beauty of testing is found not in the effort but in the efficiency.
    </p><p>
      Knowing what should be tested is beautiful, and knowing what is being
      tested is beautiful.
    </p></td><td width="10%" valign="top"> </td></tr><tr><td width="10%" valign="top"> </td><td colspan="2" align="right" valign="top">--<span class="attribution">Murali Nandigama</span></td></tr></table></div><p>
    <a id="idm140124621204688" class="indexterm"></a>

    In this chapter you will learn all about PHPUnit's code coverage
    functionality that provides an insight into what parts of the production
    code are executed when the tests are run. It helps answering questions such
    as:
  </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        How do you find code that is not yet tested -- or, in other words, not
        yet <span class="emphasis"><em>covered</em></span> by a test?
      </p></li><li class="listitem"><p>How do you measure testing completeness?</p></li></ul></div><p>
    An example of what code coverage statistics can mean is that if there is a
    method with 100 lines of code, and only 75 of these lines are actually
    executed when tests are being run, then the method is considered to have a
    code coverage of 75 percent.
  </p><p>
    <a id="idm140124621200000" class="indexterm"></a>

    PHPUnit's code coverage functionality makes use of the
    <a class="ulink" href="http://github.com/sebastianbergmann/php-code-coverage" target="_top">PHP_CodeCoverage</a>
    component, which in turn leverages the statement coverage functionality
    provided by the <a class="ulink" href="http://www.xdebug.org/" target="_top">Xdebug</a>
    extension for PHP.
  </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
      Xdebug is not distributed as part of PHPUnit. If you receive a notice
      while running tests that the Xdebug extension is not loaded, it means
      that Xdebug is either not installed or not configured properly. Before
      you can use the code coverage analysis features in PHPUnit, you should
      read <a class="ulink" href="http://xdebug.org/docs/install" target="_top">the Xdebug installation guide</a>.
    </p></div><p>
    Let us generate a code coverage report for the <code class="literal">BankAccount</code>
    class from <a class="xref" href="#test-driven-development.bankaccount-example.examples.BankAccount2.php" title="Example 12.3: The complete BankAccount class">Example 12.3</a>.
  </p><pre class="screen"><strong class="userinput"><code>phpunit --coverage-html ./report BankAccountTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

...

Time: 0 seconds

OK (3 tests, 3 assertions)

Generating report, this may take a moment.</pre><p>
    <a class="xref" href="#code-coverage-analysis.figures.Code_Coverage.png" title="Figure 14.1. Code Coverage for setBalance()">Figure 14.1</a> shows
    an excerpt from a Code Coverage report. Lines of code that were executed
    while running the tests are highlighted green, lines of code that are
    executable but were not executed are highlighted red, and "dead code" is
    highlighted grey. The number left to the actual line of code indicates
    how many tests cover that line.
  </p><div class="figure"><a id="code-coverage-analysis.figures.Code_Coverage.png"></a><p class="title"><strong>Figure 14.1. Code Coverage for setBalance()</strong></p><div class="figure-contents"><div><img src="figures/Code_Coverage.png" alt="Code Coverage for setBalance()" /></div></div></div><br class="figure-break" /><p>
    Clicking on the line number of a covered line will open a panel (see
    <a class="xref" href="#code-coverage-analysis.figures.Code_Coverage2.png" title="Figure 14.2. Panel with information on covering tests">Figure 14.2</a>) that
    shows the test cases that cover this line.
  </p><div class="figure"><a id="code-coverage-analysis.figures.Code_Coverage2.png"></a><p class="title"><strong>Figure 14.2. Panel with information on covering tests</strong></p><div class="figure-contents"><div><img src="figures/Code_Coverage2.png" alt="Panel with information on covering tests" /></div></div></div><br class="figure-break" /><p>
    The code coverage report for our <code class="literal">BankAccount</code> example
    shows that we do not have any tests yet that call the
    <code class="literal">setBalance()</code>, <code class="literal">depositMoney()</code>, and
    <code class="literal">withdrawMoney()</code> methods with legal values.
    <a class="xref" href="#code-coverage-analysis.examples.BankAccountTest.php" title="Example 14.1: Test missing to achieve complete code coverage">Example 14.1</a>
    shows a test that can be added to the <code class="literal">BankAccountTest</code>
    test case class to completely cover the <code class="literal">BankAccount</code>
    class.
  </p><div class="example"><a id="code-coverage-analysis.examples.BankAccountTest.php"></a><p class="title"><strong>Example 14.1: Test missing to achieve complete code coverage</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
require_once 'BankAccount.php';

class BankAccountTest extends PHPUnit_Framework_TestCase
{
    // ...

    public function testDepositWithdrawMoney()
    {
        $this-&gt;assertEquals(0, $this-&gt;ba-&gt;getBalance());
        $this-&gt;ba-&gt;depositMoney(1);
        $this-&gt;assertEquals(1, $this-&gt;ba-&gt;getBalance());
        $this-&gt;ba-&gt;withdrawMoney(1);
        $this-&gt;assertEquals(0, $this-&gt;ba-&gt;getBalance());
    }
}
?&gt;</pre></div></div><br class="example-break" /><p>
    <a class="xref" href="#code-coverage-analysis.figures.Code_Coverage3.png" title="Figure 14.3. Code Coverage for setBalance() with additional test">Figure 14.3</a> shows
    the code coverage of the <code class="literal">setBalance()</code> method with the
    additional test.
  </p><div class="figure"><a id="code-coverage-analysis.figures.Code_Coverage3.png"></a><p class="title"><strong>Figure 14.3. Code Coverage for <code class="literal">setBalance()</code> with additional test</strong></p><div class="figure-contents"><div><img src="figures/Code_Coverage3.png" alt="Code Coverage for setBalance() with additional test" /></div></div></div><br class="figure-break" /><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="code-coverage-analysis.specifying-covered-methods"></a>Specifying Covered Methods</h2></div></div></div><p>
      <a id="idm140124620040880" class="indexterm"></a>
      <a id="idm140124620040304" class="indexterm"></a>

      The <code class="literal">@covers</code> annotation (see
      <a class="xref" href="#appendixes.annotations.covers.tables.annotations" title="Table B.1. Annotations for specifying which methods are covered by a test">Table B.1</a>) can be
      used in the test code to specify which method(s) a test method wants to
      test. If provided, only the code coverage information for the specified
      method(s) will be considered.
      <a class="xref" href="#code-coverage-analysis.specifying-covered-methods.examples.BankAccountTest.php" title="Example 14.2: Tests that specify which method they want to cover">Example 14.2</a>
      shows an example.
    </p><div class="example"><a id="code-coverage-analysis.specifying-covered-methods.examples.BankAccountTest.php"></a><p class="title"><strong>Example 14.2: Tests that specify which method they want to cover</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
require_once 'BankAccount.php';

class BankAccountTest extends PHPUnit_Framework_TestCase
{
    protected $ba;

    protected function setUp()
    {
        $this-&gt;ba = new BankAccount;
    }

    /**
     * @covers BankAccount::getBalance
     */
    public function testBalanceIsInitiallyZero()
    {
        $this-&gt;assertEquals(0, $this-&gt;ba-&gt;getBalance());
    }

    /**
     * @covers BankAccount::withdrawMoney
     */
    public function testBalanceCannotBecomeNegative()
    {
        try {
            $this-&gt;ba-&gt;withdrawMoney(1);
        }

        catch (BankAccountException $e) {
            $this-&gt;assertEquals(0, $this-&gt;ba-&gt;getBalance());

            return;
        }

        $this-&gt;fail();
    }

    /**
     * @covers BankAccount::depositMoney
     */
    public function testBalanceCannotBecomeNegative2()
    {
        try {
            $this-&gt;ba-&gt;depositMoney(-1);
        }

        catch (BankAccountException $e) {
            $this-&gt;assertEquals(0, $this-&gt;ba-&gt;getBalance());

            return;
        }

        $this-&gt;fail();
    }

    /**
     * @covers BankAccount::getBalance
     * @covers BankAccount::depositMoney
     * @covers BankAccount::withdrawMoney
     */

    public function testDepositWithdrawMoney()
    {
        $this-&gt;assertEquals(0, $this-&gt;ba-&gt;getBalance());
        $this-&gt;ba-&gt;depositMoney(1);
        $this-&gt;assertEquals(1, $this-&gt;ba-&gt;getBalance());
        $this-&gt;ba-&gt;withdrawMoney(1);
        $this-&gt;assertEquals(0, $this-&gt;ba-&gt;getBalance());
    }
}
?&gt;</pre></div></div><br class="example-break" /><p>
      <a id="idm140124620034288" class="indexterm"></a>
      <a id="idm140124620033712" class="indexterm"></a>

      It is also possible to specify that a test should not cover 
      <span class="emphasis"><em>any</em></span> method by using the 
      <code class="literal">@coversNothing</code> annotation (see
      <a class="xref" href="#appendixes.annotations.coversNothing" title="@coversNothing">the section called “@coversNothing”</a>). This can be
      helpful when writing integration tests to make sure you only 
      generate code coverage with unit tests.
    </p><div class="example"><a id="code-coverage-analysis.specifying-covered-methods.examples.GuestbookIntegrationTest.php"></a><p class="title"><strong>Example 14.3: A test that specifies that no method should be covered</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class GuestbookIntegrationTest extends PHPUnit_Extensions_Database_TestCase
{
    /**
     * @coversNothing
     */
    public function testAddEntry()
    {
        $guestbook = new Guestbook();
        $guestbook-&gt;addEntry("suzy", "Hello world!");

        $queryTable = $this-&gt;getConnection()-&gt;createQueryTable(
            'guestbook', 'SELECT * FROM guestbook'
        );
        $expectedTable = $this-&gt;createFlatXmlDataSet("expectedBook.xml")
                              -&gt;getTable("guestbook");
        $this-&gt;assertTablesEqual($expectedTable, $queryTable);
    }
}
?&gt;
      </pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="code-coverage-analysis.ignoring-code-blocks"></a>Ignoring Code Blocks</h2></div></div></div><p>
      <a id="idm140124620007936" class="indexterm"></a>
      <a id="idm140124620007360" class="indexterm"></a>
      <a id="idm140124620006784" class="indexterm"></a>
      <a id="idm140124620006192" class="indexterm"></a>

      Sometimes you have blocks of code that you cannot test and that you may
      want to ignore during code coverage analysis. PHPUnit lets you do this
      using the <code class="literal">@codeCoverageIgnore</code>,
      <code class="literal">@codeCoverageIgnoreStart</code> and
      <code class="literal">@codeCoverageIgnoreEnd</code> annotations as shown in
      <a class="xref" href="#code-coverage-analysis.ignoring-code-blocks.examples.Sample.php" title="Example 14.4: Using the @codeCoverageIgnore, @codeCoverageIgnoreStart and @codeCoverageIgnoreEnd annotations">Example 14.4</a>.
    </p><div class="example"><a id="code-coverage-analysis.ignoring-code-blocks.examples.Sample.php"></a><p class="title"><strong>Example 14.4: Using the <code class="literal">@codeCoverageIgnore</code>, <code class="literal">@codeCoverageIgnoreStart</code> and <code class="literal">@codeCoverageIgnoreEnd</code> annotations</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
/**
 * @codeCoverageIgnore
 */
class Foo
{
    public function bar()
    {
    }
}

class Bar
{
    /**
     * @codeCoverageIgnore
     */
    public function foo()
    {
    }
}

if (FALSE) {
    // @codeCoverageIgnoreStart
    print '*';
    // @codeCoverageIgnoreEnd
}
?&gt;</pre></div></div><br class="example-break" /><p>
      The ignored lines of code (marked as ignored using the annotations)
      are counted as executed (if they are executable) and will not be
      highlighted.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="code-coverage-analysis.including-excluding-files"></a>Including and Excluding Files</h2></div></div></div><p>
      <a id="idm140124619997904" class="indexterm"></a>
      <a id="idm140124619997328" class="indexterm"></a>
      <a id="idm140124619996752" class="indexterm"></a>

      By default, all sourcecode files that contain at least one line of code
      that has been executed (and only these files) are included in the report.
      The sourcecode files that are included in the report can be filtered by
      using a blacklist or a whitelist approach.
    </p><p>
      The blacklist is pre-filled with all sourcecode files of PHPUnit itself
      as well as the tests. When the whitelist is empty (default), blacklisting
      is used. When the whitelist is not empty, whitelisting is used. Each file
      on the whitelist is added to the code coverage report regardless of
      whether or not it was executed. All lines of such a file, including those
      that are not executable, are counted as not executed.
    </p><p>
      When you set <code class="literal">processUncoveredFilesFromWhitelist="true"</code>
      in your PHPUnit configuration (see <a class="xref" href="#appendixes.configuration.blacklist-whitelist" title="Including and Excluding Files for Code Coverage">the section called “Including and Excluding Files for Code Coverage”</a>) then these files
      will be included by PHP_CodeCoverage to properly calculate the number of
      executable lines.
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        Please note that the loading of sourcecode files that is performed when
        <code class="literal">processUncoveredFilesFromWhitelist="true"</code> is set can
        cause problems when a sourcecode file contains code outside the scope of
        a class or function, for instance.
      </p></div><p>
      PHPUnit's XML configuration file (see <a class="xref" href="#appendixes.configuration.blacklist-whitelist" title="Including and Excluding Files for Code Coverage">the section called “Including and Excluding Files for Code Coverage”</a>)
      can be used to control the blacklist and the whitelist. Using a whitelist
      is the recommended best practice to control the list of files included in
      the code coverage report.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="code-coverage-analysis.edge-cases"></a>Edge cases</h2></div></div></div><p>
      For the most part it can safely be said that PHPUnit offers you "line
      based" code coverage information but due to how that information is
      collected there are some noteworthy edge cases.
    </p><div class="example"><a id="code-coverage-analysis.edge-cases.examples.Sample.php"></a><p class="title"><strong>Example 14.5: </strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
// Because it is "line based" and not statement base coverage
// one line will always have one coverage status
if(false) this_function_call_shows_up_as_covered();

// Due to how code coverage works internally these two lines are special.
// This line will show up as non executable
if(false)
    // This line will show up as covered because it is actually the 
    // coverage of the if statement in the line above that gets shown here!
    will_also_show_up_as_covered();

// To avoid this it is necessary that braces are used
if(false) {
    this_call_will_never_show_up_as_covered();
}
?&gt;</pre></div></div><br class="example-break" /></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="other-uses-for-tests"></a>Chapter 15. Other Uses for Tests</h1></div></div></div><p>
    Once you get used to writing automated tests, you will likely discover
    more uses for tests. Here are some examples.
  </p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="other-uses-for-tests.agile-documentation"></a>Agile Documentation</h2></div></div></div><p>
      <a id="idm140124621459456" class="indexterm"></a>
      <a id="idm140124621458880" class="indexterm"></a>
      <a id="idm140124621538960" class="indexterm"></a>
      <a id="idm140124621538384" class="indexterm"></a>

      Typically, in a project that is developed using an agile process,
      such as Extreme Programming, the documentation cannot keep up with the
      frequent changes to the project's design and code. Extreme Programming
      demands <span class="emphasis"><em>collective code ownership</em></span>, so all
      developers need to know how the entire system works. If you are
      disciplined enough to consequently use "speaking names" for your tests
      that describe what a class should do, you can use PHPUnit's TestDox
      functionality to generate automated documentation for your project based
      on its tests. This documentation gives developers an overview of what
      each class of the project is supposed to do.
    </p><p>
      PHPUnit's TestDox functionality looks at a test class and all the test
      method names and converts them from camel case PHP names to sentences:
      <code class="literal">testBalanceIsInitiallyZero()</code> becomes "Balance is
      initially zero". If there are several test methods whose names only
      differ in a suffix of one or more digits, such as
      <code class="literal">testBalanceCannotBecomeNegative()</code> and
      <code class="literal">testBalanceCannotBecomeNegative2()</code>, the sentence
      "Balance cannot become negative" will appear only once, assuming that
      all of these tests succeed.
    </p><p>
      Let us take a look at the agile documentation generated for the
      <code class="literal">BankAccount</code> class (from
      <a class="xref" href="#test-driven-development.bankaccount-example.examples.BankAccountTest.php" title="Example 12.1: Tests for the BankAccount class">Example 12.1</a>):
    </p><pre class="screen"><strong class="userinput"><code>phpunit --testdox BankAccountTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

BankAccount
 [x] Balance is initially zero
 [x] Balance cannot become negative</pre><p>
      Alternatively, the agile documentation can be generated in HTML or plain
      text format and written to a file using the <code class="literal">--testdox-html</code>
      and <code class="literal">--testdox-text</code> arguments.
    </p><p>
      <a id="idm140124621106176" class="indexterm"></a>

      Agile Documentation can be used to document the assumptions you make
      about the external packages that you use in your project. When you use
      an external package, you are exposed to the risks that the package will
      not behave as you expect, and that future versions of the package will
      change in subtle ways that will break your code, without you knowing it.
      You can address these risks by writing a test every time you make an
      assumption. If your test succeeds, your assumption is valid. If you
      document all your assumptions with tests, future releases of the
      external package will be no cause for concern: if the tests succeed,
      your system should continue working.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="other-uses-for-tests.cross-team-tests"></a>Cross-Team Tests</h2></div></div></div><p>
      When you document assumptions with tests, you own the tests. The
      supplier of the package -- who you make assumptions about -- knows
      nothing about your tests. If you want to have a closer relationship
      with the supplier of a package, you can use the tests to communicate
      and coordinate your activities.
    </p><p>
      When you agree on coordinating your activities with the supplier of a
      package, you can write the tests together. Do this in such a way that
      the tests reveal as many assumptions as possible. Hidden assumptions are
      the death of cooperation. With the tests, you document exactly what you
      expect from the supplied package. The supplier will know the package is
      complete when all the tests run.
    </p><p>
      <a id="idm140124620251648" class="indexterm"></a>

      By using stubs (see the chapter on "Mock Objects", earlier in this book),
      you can further decouple yourself from the supplier: The job of the
      supplier is to make the tests run with the real implementation of the
      package. Your job is to make the tests run for your own code. Until
      such time as you have the real implementation of the supplied package,
      you use stub objects. Following this approach, the two teams can develop
      independently.
    </p></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="skeleton-generator"></a>Chapter 16. Skeleton Generator</h1></div></div></div><p>
    The PHPUnit Skeleton Generator is a tool that can generate skeleton test
    classes from production code classes and vice versa. It can be installed
    using the following command:
  </p><pre class="screen"><strong class="userinput"><code>pear install phpunit/PHPUnit_SkeletonGenerator</code></strong></pre><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="skeleton-generator.test"></a>Generating a Test Case Class Skeleton</h2></div></div></div><p>
    <a id="idm140124620024448" class="indexterm"></a>

    When you are writing tests for existing code, you have to write the
    same code fragments such as </p><pre class="programlisting">public function testMethod()
{
}</pre><p> over and over again. The PHPUnit Skeleton Generator can help
    you by analyzing the code of the existing class and generating a skeleton
    test case class for it.
  </p><div class="example"><a id="skeleton-generator.examples.Calculator.php"></a><p class="title"><strong>Example 16.1: The Calculator class</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class Calculator
{
    public function add($a, $b)
    {
        return $a + $b;
    }
}
?&gt;</pre></div></div><br class="example-break" /><p>
    The following example shows how to generate a skeleton test class
    for a class named <code class="literal">Calculator</code>
    (see <a class="xref" href="#skeleton-generator.examples.Calculator.php" title="Example 16.1: The Calculator class">Example 16.1</a>).
  </p><pre class="screen"><strong class="userinput"><code>phpunit-skelgen --test Calculator</code></strong>
PHPUnit Skeleton Generator 1.0.0 by Sebastian Bergmann.

Wrote skeleton for "CalculatorTest" to "/home/sb/CalculatorTest.php".</pre><p>
    <a id="idm140124620018704" class="indexterm"></a>

    For each method in the original class, there will be an incomplete
    test case (see <a class="xref" href="#incomplete-and-skipped-tests" title="Chapter 9. Incomplete and Skipped Tests">Chapter 9</a>) in
    the generated test case class.
  </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Namespaced Classes and the Skeleton Generator</h3><p>
      When you are using the skeleton generator to generate code based on a
      class that is declared in a <a class="ulink" href="http://php.net/namespace" target="_top">namespace</a>
      you have to provide the qualified name of the class as well as the path to
      the source file it is declared in.
    </p><p>
      For instance, for a class <code class="literal">Calculator</code> that is declared
      in the <code class="literal">project</code> namespace you need to invoke the
      skeleton generator like this:
      </p><pre class="screen"><strong class="userinput"><code>phpunit-skelgen --test -- "project\Calculator" Calculator.php</code></strong>
PHPUnit Skeleton Generator 1.0.0 by Sebastian Bergmann.

Wrote skeleton for "project\CalculatorTest" to "/home/sb/CalculatorTest.php".</pre><p>
    </p></div><p>
    Below is the output of running the generated test case class.
  </p><pre class="screen"><strong class="userinput"><code>phpunit --bootstrap Calculator.php --verbose CalculatorTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

I

Time: 0 seconds, Memory: 3.50Mb

There was 1 incomplete test:

1) CalculatorTest::testAdd
This test has not been implemented yet.

/home/sb/CalculatorTest.php:38
OK, but incomplete or skipped tests!
Tests: 1, Assertions: 0, Incomplete: 1.</pre><p>
      <a id="idm140124619980224" class="indexterm"></a>
      <a id="idm140124619979648" class="indexterm"></a>

      You can use <code class="literal">@assert</code> annotation in the
      documentation block of a method to automatically generate simple,
      yet meaningful tests instead of incomplete test cases.
      <a class="xref" href="#skeleton-generator.test.examples.Calculator.php" title="Example 16.2: The Calculator class with @assert annotations">Example 16.2</a>
      shows an example.
    </p><div class="example"><a id="skeleton-generator.test.examples.Calculator.php"></a><p class="title"><strong>Example 16.2: The Calculator class with @assert annotations</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class Calculator
{
    /**
     * @assert (0, 0) == 0
     * @assert (0, 1) == 1
     * @assert (1, 0) == 1
     * @assert (1, 1) == 2
     */
    public function add($a, $b)
    {
        return $a + $b;
    }
}
?&gt;</pre></div></div><br class="example-break" /><p>
      Each method in the original class is checked for <code class="literal">@assert</code>
      annotations. These are transformed into test code such as
      </p><pre class="programlisting">    /**
     * Generated from @assert (0, 0) == 0.
     */
    public function testAdd() {
        $o = new Calculator;
        $this-&gt;assertEquals(0, $o-&gt;add(0, 0));
    }</pre><p>
    </p><p>
      Below is the output of running the generated test case class.
    </p><pre class="screen"><strong class="userinput"><code>phpunit --bootstrap Calculator.php --verbose CalculatorTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

....

Time: 0 seconds, Memory: 3.50Mb

OK (4 tests, 4 assertions)</pre><p>
      <a class="xref" href="#skeleton-generator.test.tables.assert-annotations" title="Table 16.1. Supported variations of the @assert annotation">Table 16.1</a>
      shows the supported variations of the <code class="literal">@assert</code>
      annotation and how they are transformed into test code.
    </p><div class="table"><a id="skeleton-generator.test.tables.assert-annotations"></a><p class="title"><strong>Table 16.1. Supported variations of the @assert annotation</strong></p><div class="table-contents"><table class="table" summary="Supported variations of the @assert annotation" border="1"><colgroup><col /><col /></colgroup><thead><tr><th align="left">Annotation</th><th align="left">Transformed to</th></tr></thead><tbody><tr><td align="left"><code class="literal">@assert (...) == X</code></td><td align="left"><code class="literal">assertEquals(X, method(...))</code></td></tr><tr><td align="left"><code class="literal">@assert (...) != X</code></td><td align="left"><code class="literal">assertNotEquals(X, method(...))</code></td></tr><tr><td align="left"><code class="literal">@assert (...) === X</code></td><td align="left"><code class="literal">assertSame(X, method(...))</code></td></tr><tr><td align="left"><code class="literal">@assert (...) !== X</code></td><td align="left"><code class="literal">assertNotSame(X, method(...))</code></td></tr><tr><td align="left"><code class="literal">@assert (...) &gt; X</code></td><td align="left"><code class="literal">assertGreaterThan(X, method(...))</code></td></tr><tr><td align="left"><code class="literal">@assert (...) &gt;= X</code></td><td align="left"><code class="literal">assertGreaterThanOrEqual(X, method(...))</code></td></tr><tr><td align="left"><code class="literal">@assert (...) &lt; X</code></td><td align="left"><code class="literal">assertLessThan(X, method(...))</code></td></tr><tr><td align="left"><code class="literal">@assert (...) &lt;= X</code></td><td align="left"><code class="literal">assertLessThanOrEqual(X, method(...))</code></td></tr><tr><td align="left"><code class="literal">@assert (...) throws X</code></td><td align="left"><code class="literal">@expectedException X</code></td></tr></tbody></table></div></div><br class="table-break" /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="skeleton-generator.class"></a>Generating a Class Skeleton from a Test Case Class</h2></div></div></div><p>
      When you are doing Test-Driven Development (see <a class="xref" href="#test-driven-development" title="Chapter 12. Test-Driven Development">Chapter 12</a>)
      and write your tests before the code that the tests exercise, PHPUnit can
      help you generate class skeletons from test case classes.
    </p><p>
      Following the convention that the tests for a class <code class="literal">Unit</code>
      are written in a class named <code class="literal">UnitTest</code>, the test case
      class' source is searched for variables that reference objects of the
      <code class="literal">Unit</code> class and analyzing what methods are called on
      these objects. For example, take a look at <a class="xref" href="#skeleton-generator.class.examples.BowlingGame.php" title="Example 16.4: The generated BowlingGame class skeleton">Example 16.4</a> which has
      been generated based on the analysis of <a class="xref" href="#skeleton-generator.class.examples.BowlingGameTest.php" title="Example 16.3: The BowlingGameTest class">Example 16.3</a>.
    </p><div class="example"><a id="skeleton-generator.class.examples.BowlingGameTest.php"></a><p class="title"><strong>Example 16.3: The BowlingGameTest class</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class BowlingGameTest extends PHPUnit_Framework_TestCase
{
    protected $game;

    protected function setUp()
    {
        $this-&gt;game = new BowlingGame;
    }

    protected function rollMany($n, $pins)
    {
        for ($i = 0; $i &lt; $n; $i++) {
            $this-&gt;game-&gt;roll($pins);
        }
    }

    public function testScoreForGutterGameIs0()
    {
        $this-&gt;rollMany(20, 0);
        $this-&gt;assertEquals(0, $this-&gt;game-&gt;score());
    }
}
?&gt;</pre></div></div><br class="example-break" /><pre class="screen"><strong class="userinput"><code>phpunit-skelgen --class BowlingGameTest</code></strong>
PHPUnit Skeleton Generator 1.0.0 by Sebastian Bergmann.

Wrote skeleton for "BowlingGame" to "./BowlingGame.php".</pre><div class="example"><a id="skeleton-generator.class.examples.BowlingGame.php"></a><p class="title"><strong>Example 16.4: The generated BowlingGame class skeleton</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
/**
 * Generated by PHPUnit_SkeletonGenerator on 2012-01-09 at 16:55:58.
 */
class BowlingGame
{
    /**
     * @todo Implement roll().
     */
    public function roll()
    {
        // Remove the following line when you implement this method.
        throw new RuntimeException('Not yet implemented.');
    }

    /**
     * @todo Implement score().
     */
    public function score()
    {
        // Remove the following line when you implement this method.
        throw new RuntimeException('Not yet implemented.');
    }
}
?&gt;</pre></div></div><br class="example-break" /><p>
      Below is the output of running the test against the generated class.
    </p><pre class="screen"><strong class="userinput"><code>phpunit --bootstrap BowlingGame.php BowlingGameTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

E

Time: 0 seconds, Memory: 3.50Mb

There was 1 error:

1) BowlingGameTest::testScoreForGutterGameIs0
RuntimeException: Not yet implemented.

/home/sb/BowlingGame.php:13
/home/sb/BowlingGameTest.php:14
/home/sb/BowlingGameTest.php:20

FAILURES!
Tests: 1, Assertions: 0, Errors: 1.</pre></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="selenium"></a>Chapter 17. PHPUnit and Selenium</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="selenium.selenium-rc"></a>Selenium Server</h2></div></div></div><p>
      <a id="idm140124619945712" class="indexterm"></a>

      <a class="ulink" href="http://seleniumhq.org/" target="_top">Selenium Server</a> is a
      test tool that allows you to write automated user-interface tests for
      web applications in any programming language against any HTTP website
      using any mainstream browser. It performs automated browser tasks 
      by driving the browser's process through the operating system.
      Selenium tests run directly in a browser, just as real users do. These 
      tests can be used for both <span class="emphasis"><em>acceptance testing</em></span> 
      (by performing higher-level tests on the integrated system instead of
      just testing each unit of the system independently) and <span class="emphasis"><em>browser 
      compatibility testing</em></span> (by testing the web application on
      different operating systems and browsers).
    </p><p>
      The only supported scenario of PHPUnit_Selenium is that of a Selenium 2.x
      server. The server can be accessed through the classic Selenium RC Api, already present in 1.x, or with the WebDriver API (partially implemented) from PHPUnit_Selenium 1.2.
    </p><p>
      The reason behind this decision is that Selenium 2 is backward compatible and Selenium RC is not maintained anymore.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="selenium.installation"></a>Installation</h2></div></div></div><p>
      First, install the Selenium Server:
    </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">Download a distribution archive of <a class="ulink" href="http://seleniumhq.org/download/" target="_top">Selenium Server</a>.</li><li class="listitem">Unzip the distribution archive and copy <code class="filename">selenium-server-standalone-2.9.0.jar</code> (check the version suffix) to <code class="filename">/usr/local/bin</code>, for instance.</li><li class="listitem">Start the Selenium Server server by running <strong class="userinput"><code>java -jar /usr/local/bin/selenium-server-standalone-2.9.0.jar</code></strong>.</li></ol></div><p>
      The PHPUnit_Selenium package is included in the PHAR distribution of
      PHPUnit. It can be installed via Composer by adding the following
      <code class="literal">"require-dev"</code> dependency:
    </p><pre class="screen"><strong class="userinput"><code>"phpunit/phpunit-selenium": "&gt;=1.2"</code></strong></pre><p>
      Now we can send commands to the Selenium Server using its client/server
      protocol.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="selenium.selenium2testcase"></a>PHPUnit_Extensions_Selenium2TestCase</h2></div></div></div><p>
      <a id="idm140124619867264" class="indexterm"></a>

      The <code class="literal">PHPUnit_Extensions_Selenium2TestCase</code> test case lets you use the WebDriver API (partially implemented).
    </p><p>
      <a class="xref" href="#selenium.selenium2testcase.examples.WebTest.php" title="Example 17.1: Usage example for PHPUnit_Extensions_Selenium2TestCase">Example 17.1</a> shows
      how to test the contents of the <code class="literal">&lt;title&gt;</code>
      element of the <code class="systemitem">http://www.example.com/</code>
      website.
    </p><div class="example"><a id="selenium.selenium2testcase.examples.WebTest.php"></a><p class="title"><strong>Example 17.1: Usage example for PHPUnit_Extensions_Selenium2TestCase</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class WebTest extends PHPUnit_Extensions_Selenium2TestCase
{
    protected function setUp()
    {
        $this-&gt;setBrowser('firefox');
        $this-&gt;setBrowserUrl('http://www.example.com/');
    }

    public function testTitle()
    {
        $this-&gt;url('http://www.example.com/');
        $this-&gt;assertEquals('Example WWW Page', $this-&gt;title());
    }

}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit WebTest</code></strong>
PHPUnit 3.6.10 by Sebastian Bergmann.

F

Time: 28 seconds, Memory: 3.00Mb

There was 1 failure:

1) WebTest::testTitle
Failed asserting that two strings are equal.
--- Expected
+++ Actual
@@ @@
-'Example WWW Page'
+'IANA — Example domains'

/home/giorgio/WebTest.php:13

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /><p>    
    The commands of Selenium2TestCase are implemented via __call(). Please refer to <a class="ulink" href="https://github.com/sebastianbergmann/phpunit-selenium/blob/master/Tests/Selenium2TestCaseTest.php" target="_top">the end-to-end test for PHPUnit_Extensions_Selenium2TestCase</a> for a list of every supported feature.
  </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="selenium.seleniumtestcase"></a>PHPUnit_Extensions_SeleniumTestCase</h2></div></div></div><p>
      <a id="idm140124619857968" class="indexterm"></a>

      The <code class="literal">PHPUnit_Extensions_SeleniumTestCase</code> test case
      extension implements the client/server protocol to talk to Selenium Server as
      well as specialized assertion methods for web testing.
    </p><p>
      <a class="xref" href="#selenium.seleniumtestcase.examples.WebTest.php" title="Example 17.2: Usage example for PHPUnit_Extensions_SeleniumTestCase">Example 17.2</a> shows
      how to test the contents of the <code class="literal">&lt;title&gt;</code>
      element of the <code class="systemitem">http://www.example.com/</code>
      website.
    </p><div class="example"><a id="selenium.seleniumtestcase.examples.WebTest.php"></a><p class="title"><strong>Example 17.2: Usage example for PHPUnit_Extensions_SeleniumTestCase</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
require_once 'PHPUnit/Extensions/SeleniumTestCase.php';

class WebTest extends PHPUnit_Extensions_SeleniumTestCase
{
    protected function setUp()
    {
        $this-&gt;setBrowser('*firefox');
        $this-&gt;setBrowserUrl('http://www.example.com/');
    }

    public function testTitle()
    {
        $this-&gt;open('http://www.example.com/');
        $this-&gt;assertTitle('Example WWW Page');
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit WebTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 9 seconds, Memory: 6.00Mb

There was 1 failure:

1) WebTest::testTitle
Current URL: http://www.iana.org/domains/example/

Failed asserting that 'IANA — Example domains' matches PCRE pattern "/Example WWW Page/".


FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /><p>
      Unlike with the <code class="literal">PHPUnit_Framework_TestCase</code> class,
      test case classes that extend <code class="literal">PHPUnit_Extensions_SeleniumTestCase</code>
      have to provide a <code class="literal">setUp()</code> method. This method is used
      to configure the Selenium Server session. See
      <a class="xref" href="#selenium.seleniumtestcase.tables.seleniumrc-api.setup" title="Table 17.1. Selenium Server API: Setup">Table 17.1</a>
      for the list of methods that are available for this.
    </p><div class="table"><a id="selenium.seleniumtestcase.tables.seleniumrc-api.setup"></a><p class="title"><strong>Table 17.1. Selenium Server API: Setup</strong></p><div class="table-contents"><table class="table" summary="Selenium Server API: Setup" border="1"><colgroup><col /><col /></colgroup><thead><tr><th align="left">Method</th><th align="left">Meaning</th></tr></thead><tbody><tr><td align="left"><code class="literal">void setBrowser(string $browser)</code></td><td align="left">Set the browser to be used by the Selenium Server server.</td></tr><tr><td align="left"><code class="literal">void setBrowserUrl(string $browserUrl)</code></td><td align="left">Set the base URL for the tests.</td></tr><tr><td align="left"><code class="literal">void setHost(string $host)</code></td><td align="left">Set the hostname for the connection to the Selenium Server server.</td></tr><tr><td align="left"><code class="literal">void setPort(int $port)</code></td><td align="left">Set the port for the connection to the Selenium Server server.</td></tr><tr><td align="left"><code class="literal">void setTimeout(int $timeout)</code></td><td align="left">Set the timeout for the connection to the Selenium Server server.</td></tr><tr><td align="left"><code class="literal">void setSleep(int $seconds)</code></td><td align="left">Set the number of seconds the Selenium Server client should sleep between sending action commands to the Selenium Server server.</td></tr></tbody></table></div></div><br class="table-break" /><p>
      PHPUnit can optionally capture a screenshot when a Selenium test fails. To
      enable this, set <code class="literal">$captureScreenshotOnFailure</code>,
      <code class="literal">$screenshotPath</code>, and <code class="literal">$screenshotUrl</code>
      in your test case class as shown in
      <a class="xref" href="#selenium.seleniumtestcase.examples.WebTest2.php" title="Example 17.3: Capturing a screenshot when a test fails">Example 17.3</a>.
    </p><div class="example"><a id="selenium.seleniumtestcase.examples.WebTest2.php"></a><p class="title"><strong>Example 17.3: Capturing a screenshot when a test fails</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
require_once 'PHPUnit/Extensions/SeleniumTestCase.php';

class WebTest extends PHPUnit_Extensions_SeleniumTestCase
{
    protected $captureScreenshotOnFailure = TRUE;
    protected $screenshotPath = '/var/www/localhost/htdocs/screenshots';
    protected $screenshotUrl = 'http://localhost/screenshots';

    protected function setUp()
    {
        $this-&gt;setBrowser('*firefox');
        $this-&gt;setBrowserUrl('http://www.example.com/');
    }

    public function testTitle()
    {
        $this-&gt;open('http://www.example.com/');
        $this-&gt;assertTitle('Example WWW Page');
    }
}
?&gt;</pre><pre class="screen"><strong class="userinput"><code>phpunit WebTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 7 seconds, Memory: 6.00Mb

There was 1 failure:

1) WebTest::testTitle
Current URL: http://www.iana.org/domains/example/
Screenshot: http://localhost/screenshots/334b080f2364b5f11568ee1c7f6742c9.png

Failed asserting that 'IANA — Example domains' matches PCRE pattern "/Example WWW Page/".


FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /><p>
      You can run each test using a set of browsers: Instead of using
      <code class="literal">setBrowser()</code> to set up one browser you declare a
      <code class="literal">public static</code> array named <code class="literal">$browsers</code>
      in your test case class. Each item in this array describes one browser
      configuration. Each of these browsers can be hosted by different
      Selenium Server servers.
      <a class="xref" href="#selenium.seleniumtestcase.examples.WebTest3.php" title="Example 17.4: Setting up multiple browser configurations">Example 17.4</a> shows
      an example.
    </p><div class="example"><a id="selenium.seleniumtestcase.examples.WebTest3.php"></a><p class="title"><strong>Example 17.4: Setting up multiple browser configurations</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
require_once 'PHPUnit/Extensions/SeleniumTestCase.php';

class WebTest extends PHPUnit_Extensions_SeleniumTestCase
{
    public static $browsers = array(
      array(
        'name'    =&gt; 'Firefox on Linux',
        'browser' =&gt; '*firefox',
        'host'    =&gt; 'my.linux.box',
        'port'    =&gt; 4444,
        'timeout' =&gt; 30000,
      ),
      array(
        'name'    =&gt; 'Safari on MacOS X',
        'browser' =&gt; '*safari',
        'host'    =&gt; 'my.macosx.box',
        'port'    =&gt; 4444,
        'timeout' =&gt; 30000,
      ),
      array(
        'name'    =&gt; 'Safari on Windows XP',
        'browser' =&gt; '*custom C:\Program Files\Safari\Safari.exe -url',
        'host'    =&gt; 'my.windowsxp.box',
        'port'    =&gt; 4444,
        'timeout' =&gt; 30000,
      ),
      array(
        'name'    =&gt; 'Internet Explorer on Windows XP',
        'browser' =&gt; '*iexplore',
        'host'    =&gt; 'my.windowsxp.box',
        'port'    =&gt; 4444,
        'timeout' =&gt; 30000,
      )
    );

    protected function setUp()
    {
        $this-&gt;setBrowserUrl('http://www.example.com/');
    }

    public function testTitle()
    {
        $this-&gt;open('http://www.example.com/');
        $this-&gt;assertTitle('Example Web Page');
    }
}
?&gt;</pre></div></div><br class="example-break" /><p>
      <code class="literal">PHPUnit_Extensions_SeleniumTestCase</code> can collect code
      coverage information for tests run through Selenium:
    </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">Copy <code class="filename">PHPUnit/Extensions/SeleniumCommon/phpunit_coverage.php</code> into your webserver's document root directory.</li><li class="listitem">In your webserver's <code class="filename">php.ini</code> configuration file, configure <code class="filename">PHPUnit/Extensions/SeleniumCommon/prepend.php</code> and <code class="filename">PHPUnit/Extensions/SeleniumCommon/append.php</code> as the <code class="literal">auto_prepend_file</code> and <code class="literal">auto_append_file</code>, respectively.</li><li class="listitem">In your test case class that extends <code class="literal">PHPUnit_Extensions_SeleniumTestCase</code>, use <pre class="programlisting">protected $coverageScriptUrl = 'http://host/phpunit_coverage.php';</pre> to configure the URL for the <code class="filename">phpunit_coverage.php</code> script.</li></ol></div><p>
      <a class="xref" href="#selenium.seleniumtestcase.tables.assertions" title="Table 17.2. Assertions">Table 17.2</a> lists the
      various assertion methods that <code class="literal">PHPUnit_Extensions_SeleniumTestCase</code>
      provides.
    </p><div class="table"><a id="selenium.seleniumtestcase.tables.assertions"></a><p class="title"><strong>Table 17.2. Assertions</strong></p><div class="table-contents"><table class="table" summary="Assertions" border="1"><colgroup><col /><col /></colgroup><thead><tr><th align="left">Assertion</th><th align="left">Meaning</th></tr></thead><tbody><tr><td align="left"><code class="literal">void assertElementValueEquals(string $locator, string $text)</code></td><td align="left">Reports an error if the value of the element identified by <code class="literal">$locator</code> is not equal to the given <code class="literal">$text</code>.</td></tr><tr><td align="left"><code class="literal">void assertElementValueNotEquals(string $locator, string $text)</code></td><td align="left">Reports an error if the value of the element identified by <code class="literal">$locator</code> is equal to the given <code class="literal">$text</code>.</td></tr><tr><td align="left"><code class="literal">void assertElementValueContains(string $locator, string $text)</code></td><td align="left">Reports an error if the value of the element identified by <code class="literal">$locator</code> does not contain the given <code class="literal">$text</code>.</td></tr><tr><td align="left"><code class="literal">void assertElementValueNotContains(string $locator, string $text)</code></td><td align="left">Reports an error if the value of the element identified by <code class="literal">$locator</code> contains the given <code class="literal">$text</code>.</td></tr><tr><td align="left"><code class="literal">void assertElementContainsText(string $locator, string $text)</code></td><td align="left">Reports an error if the element identified by <code class="literal">$locator</code> does not contain the given <code class="literal">$text</code>.</td></tr><tr><td align="left"><code class="literal">void assertElementNotContainsText(string $locator, string $text)</code></td><td align="left">Reports an error if the element identified by <code class="literal">$locator</code> contains the given <code class="literal">$text</code>.</td></tr><tr><td align="left"><code class="literal">void assertSelectHasOption(string $selectLocator, string $option)</code></td><td align="left">Reports an error if the given option is not available.</td></tr><tr><td align="left"><code class="literal">void assertSelectNotHasOption(string $selectLocator, string $option)</code></td><td align="left">Reports an error if the given option is available.</td></tr><tr><td align="left"><code class="literal">void assertSelected($selectLocator, $option)</code></td><td align="left">Reports an error if the given label is not selected.</td></tr><tr><td align="left"><code class="literal">void assertNotSelected($selectLocator, $option)</code></td><td align="left">Reports an error if the given label is selected.</td></tr><tr><td align="left"><code class="literal">void assertIsSelected(string $selectLocator, string $value)</code></td><td align="left">Reports an error if the given value is not selected.</td></tr><tr><td align="left"><code class="literal">void assertIsNotSelected(string $selectLocator, string $value)</code></td><td align="left">Reports an error if the given value is selected.</td></tr></tbody></table></div></div><br class="table-break" /><p>
      <a class="xref" href="#selenium.seleniumtestcase.tables.template-methods" title="Table 17.3. Template Methods">Table 17.3</a> shows
      the template method of <code class="literal">PHPUnit_Extensions_SeleniumTestCase</code>:
    </p><div class="table"><a id="selenium.seleniumtestcase.tables.template-methods"></a><p class="title"><strong>Table 17.3. Template Methods</strong></p><div class="table-contents"><table class="table" summary="Template Methods" border="1"><colgroup><col /><col /></colgroup><thead><tr><th align="left">Method</th><th align="left">Meaning</th></tr></thead><tbody><tr><td align="left"><code class="literal">void defaultAssertions()</code></td><td align="left">Override to perform assertions that are shared by all tests of a test case. This method is called after each command that is sent to the Selenium Server server.</td></tr></tbody></table></div></div><br class="table-break" /><p>
      Please refer to the <a class="ulink" href="http://release.seleniumhq.org/selenium-core/1.0.1/reference.html" target="_top">documentation of Selenium commands</a>
      for a reference of the commands available and how they are used.
    </p><p>
    The commands of Selenium 1 are implemented dynamically via __call. Refer also to <a class="ulink" href="https://github.com/sebastianbergmann/phpunit-selenium/blob/master/PHPUnit/Extensions/SeleniumTestCase/Driver.php#L410" target="_top">the API docs for PHPUnit_Extensions_SeleniumTestCase_Driver::__call()</a> for a list of all the supported methods on the PHP side, along with arguments and return type where available.
    </p><p>
      Using the <code class="literal">runSelenese($filename)</code> method, you can also
      run a Selenium test from its Selenese/HTML specification. Furthermore,
      using the static attribute <code class="literal">$seleneseDirectory</code>, you can
      automatically create test objects from a directory that contains
      Selenese/HTML files. The specified directory is recursively searched for
      <code class="literal">.htm</code> files that are expected to contain Selenese/HTML.
      <a class="xref" href="#selenium.seleniumtestcase.examples.WebTest4.php" title="Example 17.5: Use a directory of Selenese/HTML files as tests">Example 17.5</a> shows an
      example.
    </p><div class="example"><a id="selenium.seleniumtestcase.examples.WebTest4.php"></a><p class="title"><strong>Example 17.5: Use a directory of Selenese/HTML files as tests</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
require_once 'PHPUnit/Extensions/SeleniumTestCase.php';

class SeleneseTests extends PHPUnit_Extensions_SeleniumTestCase
{
    public static $seleneseDirectory = '/path/to/files';
}
?&gt;</pre></div></div><br class="example-break" /><p>
    From Selenium 1.1.1, an experimental feature is included allowing the user to share the session between tests. The only supported case is to share the session between all tests when a single browser is used.
    Call <code class="literal">PHPUnit_Extensions_SeleniumTestCase::shareSession(true)</code> in your bootstrap file to enable session sharing.
    The session will be reset in the case of not successul tests (failed or incomplete); it is up to the user to avoid interactions between tests by resetting cookies or logging out from the application under test (with a tearDown() method).
    </p></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="logging"></a>Chapter 18. Logging</h1></div></div></div><p>
    <a id="idm140124621458528" class="indexterm"></a>

    PHPUnit can produce several types of logfiles.
  </p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="logging.xml"></a>Test Results (XML)</h2></div></div></div><p>
      The XML logfile for test results produced by PHPUnit is based upon the one
      used by the <a class="ulink" href="http://ant.apache.org/manual/Tasks/junit.html" target="_top">JUnit
      task for Apache Ant</a>. The following example shows the XML
      logfile generated for the tests in <code class="literal">ArrayTest</code>:
    </p><pre class="screen">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;testsuites&gt;
  &lt;testsuite name="ArrayTest"
             file="/home/sb/ArrayTest.php"
             tests="2"
             assertions="2"
             failures="0"
             errors="0"
             time="0.016030"&gt;
    &lt;testcase name="testNewArrayIsEmpty"
              class="ArrayTest"
              file="/home/sb/ArrayTest.php"
              line="6"
              assertions="1"
              time="0.008044"/&gt;
    &lt;testcase name="testArrayContainsAnElement"
              class="ArrayTest"
              file="/home/sb/ArrayTest.php"
              line="15"
              assertions="1"
              time="0.007986"/&gt;
  &lt;/testsuite&gt;
&lt;/testsuites&gt;</pre><p>
      The following XML logfile was generated for two tests,
      <code class="literal">testFailure</code> and <code class="literal">testError</code>,
      of a test case class named <code class="literal">FailureErrorTest</code> and
      shows how failures and errors are denoted.
    </p><pre class="screen">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;testsuites&gt;
  &lt;testsuite name="FailureErrorTest"
             file="/home/sb/FailureErrorTest.php"
             tests="2"
             assertions="1"
             failures="1"
             errors="1"
             time="0.019744"&gt;
    &lt;testcase name="testFailure"
              class="FailureErrorTest"
              file="/home/sb/FailureErrorTest.php"
              line="6"
              assertions="1"
              time="0.011456"&gt;
      &lt;failure type="PHPUnit_Framework_ExpectationFailedException"&gt;
testFailure(FailureErrorTest)
Failed asserting that &amp;lt;integer:2&amp;gt; matches expected value &amp;lt;integer:1&amp;gt;.

/home/sb/FailureErrorTest.php:8
&lt;/failure&gt;
    &lt;/testcase&gt;
    &lt;testcase name="testError"
              class="FailureErrorTest"
              file="/home/sb/FailureErrorTest.php"
              line="11"
              assertions="0"
              time="0.008288"&gt;
      &lt;error type="Exception"&gt;testError(FailureErrorTest)
Exception:

/home/sb/FailureErrorTest.php:13
&lt;/error&gt;
    &lt;/testcase&gt;
  &lt;/testsuite&gt;
&lt;/testsuites&gt;</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="logging.tap"></a>Test Results (TAP)</h2></div></div></div><p>
      The <a class="ulink" href="http://testanything.org/" target="_top">Test Anything Protocol (TAP)</a>
      is Perl's simple text-based interface between testing modules. The
      following example shows the TAP logfile generated for the tests in
      <code class="literal">ArrayTest</code>:
    </p><pre class="screen">TAP version 13
ok 1 - testNewArrayIsEmpty(ArrayTest)
ok 2 - testArrayContainsAnElement(ArrayTest)
1..2</pre><p>
      The following TAP logfile was generated for two tests,
      <code class="literal">testFailure</code> and <code class="literal">testError</code>,
      of a test case class named <code class="literal">FailureErrorTest</code> and
      shows how failures and errors are denoted.
    </p><pre class="screen">TAP version 13
not ok 1 - Failure: testFailure(FailureErrorTest)
  ---
  message: 'Failed asserting that &lt;integer:2&gt; matches expected value &lt;integer:1&gt;.'
  severity: fail
  data:
    got: 2
    expected: 1
  ...
not ok 2 - Error: testError(FailureErrorTest)
1..2</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="logging.json"></a>Test Results (JSON)</h2></div></div></div><p>
      The <a class="ulink" href="http://www.json.org/" target="_top">JavaScript Object Notation (JSON)</a>
      is a lightweight data-interchange format. The following example shows
      the JSON messages generated for the tests in <code class="literal">ArrayTest</code>:
    </p><pre class="screen">{"event":"suiteStart","suite":"ArrayTest","tests":2}
{"event":"test","suite":"ArrayTest",
 "test":"testNewArrayIsEmpty(ArrayTest)","status":"pass",
 "time":0.000460147858,"trace":[],"message":""}
{"event":"test","suite":"ArrayTest",
 "test":"testArrayContainsAnElement(ArrayTest)","status":"pass",
 "time":0.000422954559,"trace":[],"message":""}</pre><p>
      The following JSON messages were generated for two tests,
      <code class="literal">testFailure</code> and <code class="literal">testError</code>,
      of a test case class named <code class="literal">FailureErrorTest</code> and
      show how failures and errors are denoted.
    </p><pre class="screen">{"event":"suiteStart","suite":"FailureErrorTest","tests":2}
{"event":"test","suite":"FailureErrorTest",
 "test":"testFailure(FailureErrorTest)","status":"fail",
 "time":0.0082459449768066,"trace":[],
 "message":"Failed asserting that &lt;integer:2&gt; is equal to &lt;integer:1&gt;."}
{"event":"test","suite":"FailureErrorTest",
 "test":"testError(FailureErrorTest)","status":"error",
 "time":0.0083680152893066,"trace":[],"message":""}</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="logging.codecoverage.xml"></a>Code Coverage (XML)</h2></div></div></div><p>
      The XML format for code coverage information logging produced by PHPUnit
      is loosely based upon the one used by <a class="ulink" href="http://www.atlassian.com/software/clover/" target="_top">
      Clover</a>. The following example shows the XML
      logfile generated for the tests in <code class="literal">BankAccountTest</code>:
    </p><pre class="screen">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;coverage generated="1184835473" phpunit="3.6.0"&gt;
  &lt;project name="BankAccountTest" timestamp="1184835473"&gt;
    &lt;file name="/home/sb/BankAccount.php"&gt;
      &lt;class name="BankAccountException"&gt;
        &lt;metrics methods="0" coveredmethods="0" statements="0"
                 coveredstatements="0" elements="0" coveredelements="0"/&gt;
      &lt;/class&gt;
      &lt;class name="BankAccount"&gt;
        &lt;metrics methods="4" coveredmethods="4" statements="13"
                 coveredstatements="5" elements="17" coveredelements="9"/&gt;
      &lt;/class&gt;
      &lt;line num="77" type="method" count="3"/&gt;
      &lt;line num="79" type="stmt" count="3"/&gt;
      &lt;line num="89" type="method" count="2"/&gt;
      &lt;line num="91" type="stmt" count="2"/&gt;
      &lt;line num="92" type="stmt" count="0"/&gt;
      &lt;line num="93" type="stmt" count="0"/&gt;
      &lt;line num="94" type="stmt" count="2"/&gt;
      &lt;line num="96" type="stmt" count="0"/&gt;
      &lt;line num="105" type="method" count="1"/&gt;
      &lt;line num="107" type="stmt" count="1"/&gt;
      &lt;line num="109" type="stmt" count="0"/&gt;
      &lt;line num="119" type="method" count="1"/&gt;
      &lt;line num="121" type="stmt" count="1"/&gt;
      &lt;line num="123" type="stmt" count="0"/&gt;
      &lt;metrics loc="126" ncloc="37" classes="2" methods="4" coveredmethods="4"
               statements="13" coveredstatements="5" elements="17"
               coveredelements="9"/&gt;
    &lt;/file&gt;
    &lt;metrics files="1" loc="126" ncloc="37" classes="2" methods="4"
             coveredmethods="4" statements="13" coveredstatements="5"
             elements="17" coveredelements="9"/&gt;
  &lt;/project&gt;
&lt;/coverage&gt;</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="logging.codecoverage.text"></a>Code Coverage (TEXT)</h2></div></div></div><p>
      Human readable code coverage output for the command-line or a text file.
      
      The aim of this output format is to provide a quick coverage overview while
      working on a small set of classes. For bigger projects this output can be
      useful to get an quick overview of the projects coverage or when used with 
      the <code class="literal">--filter</code> functionality.

      When used from the command-line by writing to <code class="literal">php://stdout</code>
      this will honor the <code class="literal">--colors</code> setting.

      Writing to standard out is the default option when used from the command-line.

      By default this will only show files that have at least one covered line.
      This can only be changed via the <code class="literal">showUncoveredFiles</code> xml
      configuration option. See <a class="xref" href="#appendixes.configuration.logging" title="Logging">the section called “Logging”</a>.
    </p><div class="figure"><a id="code-coverage-analysis.figures.Code_Coverage4.png"></a><p class="title"><strong>Figure 18.1. Code Coverage output on the command-line with colors</strong></p><div class="figure-contents"><div><img src="figures/Code_Coverage4.png" alt="Code Coverage output on the command-line with colors" /></div></div></div><br class="figure-break" /></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="extending-phpunit"></a>Chapter 19. Extending PHPUnit</h1></div></div></div><p>
    PHPUnit can be extended in various ways to make the writing of tests
    easier and customize the feedback you get from running tests. Here are
    common starting points to extend PHPUnit.
  </p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="extending-phpunit.PHPUnit_Framework_TestCase"></a>Subclass PHPUnit_Framework_TestCase</h2></div></div></div><p>
      <a id="idm140124619748768" class="indexterm"></a>

      Write custom assertions and utility methods in an abstract subclass of
      <code class="literal">PHPUnit_Framework_TestCase</code> and derive your test case
      classes from that class. This is one of the easiest ways to extend
      PHPUnit.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="extending-phpunit.custom-assertions"></a>Write custom assertions</h2></div></div></div><p>
      When writing custom assertions it is the best practice to follow how
      PHPUnit's own assertions are implemented. As you can see in
      <a class="xref" href="#extending-phpunit.examples.Assert.php" title="Example 19.1: The assertTrue() and isTrue() methods of the PHPUnit_Framework_Assert class">Example 19.1</a>, the
      <code class="literal">assertTrue()</code> method is just a wrapper around the
      <code class="literal">isTrue()</code> and <code class="literal">assertThat()</code> methods:
      <code class="literal">isTrue()</code> creates a matcher object that is passed on to
      <code class="literal">assertThat()</code> for evaluation.
    </p><div class="example"><a id="extending-phpunit.examples.Assert.php"></a><p class="title"><strong>Example 19.1: The assertTrue() and isTrue() methods of the PHPUnit_Framework_Assert class</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
abstract class PHPUnit_Framework_Assert
{
    // ...

    /**
     * Asserts that a condition is true.
     *
     * @param  boolean $condition
     * @param  string  $message
     * @throws PHPUnit_Framework_AssertionFailedError
     */
    public static function assertTrue($condition, $message = '')
    {
        self::assertThat($condition, self::isTrue(), $message);
    }

    // ...

    /**
     * Returns a PHPUnit_Framework_Constraint_IsTrue matcher object.
     *
     * @return PHPUnit_Framework_Constraint_IsTrue
     * @since  Method available since Release 3.3.0
     */
    public static function isTrue()
    {
        return new PHPUnit_Framework_Constraint_IsTrue;
    }

    // ...
}?&gt;</pre></div></div><br class="example-break" /><p>
      <a class="xref" href="#extending-phpunit.examples.IsTrue.php" title="Example 19.2: The PHPUnit_Framework_Constraint_IsTrue class">Example 19.2</a> shows how
      <code class="literal">PHPUnit_Framework_Constraint_IsTrue</code> extends the
      abstract base class for matcher objects (or constraints),
      <code class="literal">PHPUnit_Framework_Constraint</code>.
    </p><div class="example"><a id="extending-phpunit.examples.IsTrue.php"></a><p class="title"><strong>Example 19.2: The PHPUnit_Framework_Constraint_IsTrue class</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class PHPUnit_Framework_Constraint_IsTrue extends PHPUnit_Framework_Constraint
{
    /**
     * Evaluates the constraint for parameter $other. Returns TRUE if the
     * constraint is met, FALSE otherwise.
     *
     * @param mixed $other Value or object to evaluate.
     * @return bool
     */
    public function matches($other)
    {
        return $other === TRUE;
    }

    /**
     * Returns a string representation of the constraint.
     *
     * @return string
     */
    public function toString()
    {
        return 'is true';
    }
}?&gt;</pre></div></div><br class="example-break" /><p>
      The effort of implementing the <code class="literal">assertTrue()</code> and
      <code class="literal">isTrue()</code> methods as well as the
      <code class="literal">PHPUnit_Framework_Constraint_IsTrue</code> class yields the
      benefit that <code class="literal">assertThat()</code> automatically takes care of
      evaluating the assertion and bookkeeping tasks such as counting it for
      statistics. Furthermore, the <code class="literal">isTrue()</code> method can be
      used as a matcher when configuring mock objects.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="extending-phpunit.PHPUnit_Framework_TestListener"></a>Implement PHPUnit_Framework_TestListener</h2></div></div></div><p>
      <a id="idm140124619856560" class="indexterm"></a>

      <a class="xref" href="#extending-phpunit.examples.SimpleTestListener.php" title="Example 19.3: A simple test listener">Example 19.3</a>
      shows a simple implementation of the <code class="literal">PHPUnit_Framework_TestListener</code>
      interface.
    </p><div class="example"><a id="extending-phpunit.examples.SimpleTestListener.php"></a><p class="title"><strong>Example 19.3: A simple test listener</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class SimpleTestListener implements PHPUnit_Framework_TestListener
{
    public function addError(PHPUnit_Framework_Test $test, Exception $e, $time)
    {
        printf("Error while running test '%s'.\n", $test-&gt;getName());
    }

    public function addFailure(PHPUnit_Framework_Test $test, PHPUnit_Framework_AssertionFailedError $e, $time)
    {
        printf("Test '%s' failed.\n", $test-&gt;getName());
    }

    public function addIncompleteTest(PHPUnit_Framework_Test $test, Exception $e, $time)
    {
        printf("Test '%s' is incomplete.\n", $test-&gt;getName());
    }

    public function addSkippedTest(PHPUnit_Framework_Test $test, Exception $e, $time)
    {
        printf("Test '%s' has been skipped.\n", $test-&gt;getName());
    }

    public function startTest(PHPUnit_Framework_Test $test)
    {
        printf("Test '%s' started.\n", $test-&gt;getName());
    }

    public function endTest(PHPUnit_Framework_Test $test, $time)
    {
        printf("Test '%s' ended.\n", $test-&gt;getName());
    }

    public function startTestSuite(PHPUnit_Framework_TestSuite $suite)
    {
        printf("TestSuite '%s' started.\n", $suite-&gt;getName());
    }

    public function endTestSuite(PHPUnit_Framework_TestSuite $suite)
    {
        printf("TestSuite '%s' ended.\n", $suite-&gt;getName());
    }
}
?&gt;</pre></div></div><br class="example-break" /><p>
      In <a class="xref" href="#appendixes.configuration.test-listeners" title="Test Listeners">the section called “Test Listeners”</a> you can see
      how to configure PHPUnit to attach your test listener to the test
      execution.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="extending-phpunit.PHPUnit_Extensions_TestDecorator"></a>Subclass PHPUnit_Extensions_TestDecorator</h2></div></div></div><p>
      <a id="idm140124619849248" class="indexterm"></a>

      You can wrap test cases or test suites in a subclass of
      <code class="literal">PHPUnit_Extensions_TestDecorator</code> and use the
      Decorator design pattern to perform some actions before and after the
      test runs.
    </p><p>
      <a id="idm140124619847680" class="indexterm"></a>

      PHPUnit ships with one concrete test decorator:
      <code class="literal">PHPUnit_Extensions_RepeatedTest</code>. It is used to run a
      test repeatedly and only count it as a success if all iterations are
      successful.
    </p><p>
      <a class="xref" href="#extending-phpunit.examples.RepeatedTest.php" title="Example 19.4: The RepeatedTest Decorator">Example 19.4</a>
      shows a cut-down version of the <code class="literal">PHPUnit_Extensions_RepeatedTest</code>
      test decorator that illustrates how to write your own test decorators.
    </p><div class="example"><a id="extending-phpunit.examples.RepeatedTest.php"></a><p class="title"><strong>Example 19.4: The RepeatedTest Decorator</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
require_once 'PHPUnit/Extensions/TestDecorator.php';

class PHPUnit_Extensions_RepeatedTest extends PHPUnit_Extensions_TestDecorator
{
    private $timesRepeat = 1;

    public function __construct(PHPUnit_Framework_Test $test, $timesRepeat = 1)
    {
        parent::__construct($test);

        if (is_integer($timesRepeat) &amp;&amp;
            $timesRepeat &gt;= 0) {
            $this-&gt;timesRepeat = $timesRepeat;
        }
    }

    public function count()
    {
        return $this-&gt;timesRepeat * $this-&gt;test-&gt;count();
    }

    public function run(PHPUnit_Framework_TestResult $result = NULL)
    {
        if ($result === NULL) {
            $result = $this-&gt;createResult();
        }

        for ($i = 0; $i &lt; $this-&gt;timesRepeat &amp;&amp; !$result-&gt;shouldStop(); $i++) {
            $this-&gt;test-&gt;run($result);
        }

        return $result;
    }
}
?&gt;</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="extending-phpunit.PHPUnit_Framework_Test"></a>Implement PHPUnit_Framework_Test</h2></div></div></div><p>
      <a id="idm140124619840896" class="indexterm"></a>
      <a id="idm140124619840320" class="indexterm"></a>

      The <code class="literal">PHPUnit_Framework_Test</code> interface is narrow and
      easy to implement. You can write an implementation of
      <code class="literal">PHPUnit_Framework_Test</code> that is simpler than
      <code class="literal">PHPUnit_Framework_TestCase</code> and that runs
      <span class="emphasis"><em>data-driven tests</em></span>, for instance.
    </p><p>
      <a class="xref" href="#extending-phpunit.examples.DataDrivenTest.php" title="Example 19.5: A data-driven test">Example 19.5</a>
      shows a data-driven test case class that compares values from a file
      with Comma-Separated Values (CSV). Each line of such a file looks like
      <code class="literal">foo;bar</code>, where the first value is the one we expect
      and the second value is the actual one.
    </p><div class="example"><a id="extending-phpunit.examples.DataDrivenTest.php"></a><p class="title"><strong>Example 19.5: A data-driven test</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
class DataDrivenTest implements PHPUnit_Framework_Test
{
    private $lines;

    public function __construct($dataFile)
    {
        $this-&gt;lines = file($dataFile);
    }

    public function count()
    {
        return 1;
    }

    public function run(PHPUnit_Framework_TestResult $result = NULL)
    {
        if ($result === NULL) {
            $result = new PHPUnit_Framework_TestResult;
        }

        foreach ($this-&gt;lines as $line) {
            $result-&gt;startTest($this);
            PHP_Timer::start();
            $stopTime = NULL;

            list($expected, $actual) = explode(';', $line);

            try {
                PHPUnit_Framework_Assert::assertEquals(
                  trim($expected), trim($actual)
                );
            }

            catch (PHPUnit_Framework_AssertionFailedError $e) {
                $stopTime = PHP_Timer::stop();
                $result-&gt;addFailure($this, $e, $stopTime);
            }

            catch (Exception $e) {
                $stopTime = PHP_Timer::stop();
                $result-&gt;addError($this, $e, $stopTime);
            }

            if ($stopTime === NULL) {
                $stopTime = PHP_Timer::stop();
            }

            $result-&gt;endTest($this, $stopTime);
        }

        return $result;
    }
}

$test = new DataDrivenTest('data_file.csv');
$result = PHPUnit_TextUI_TestRunner::run($test);
?&gt;</pre><pre class="screen">PHPUnit 3.7.0 by Sebastian Bergmann.

.F

Time: 0 seconds

There was 1 failure:

1) DataDrivenTest
Failed asserting that two strings are equal.
expected string &lt;bar&gt;
difference      &lt;  x&gt;
got string      &lt;baz&gt;
/home/sb/DataDrivenTest.php:32
/home/sb/DataDrivenTest.php:53

FAILURES!
Tests: 2, Failures: 1.</pre></div></div><br class="example-break" /></div></div><div class="appendix"><div class="titlepage"><div><div><h1 class="title"><a id="appendixes.assertions"></a>Appendix A. Assertions</h1></div></div></div><p>
    <a class="xref" href="#appendixes.assertions.tables.assertions" title="Table A.1. Assertions">Table A.1</a> shows all the
    varieties of assertions.
  </p><div class="table"><a id="appendixes.assertions.tables.assertions"></a><p class="title"><strong>Table A.1. Assertions</strong></p><div class="table-contents"><table class="table" summary="Assertions" border="1"><colgroup><col /></colgroup><thead><tr><th align="left">Assertion</th></tr></thead><tbody><tr><td align="left"><code class="literal">assertArrayHasKey($key, $array, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertArrayNotHasKey($key, $array, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertAttributeContains($needle, $haystackAttributeName, $haystackClassOrObject, $message = '', $ignoreCase = FALSE, $checkForObjectIdentity = TRUE)</code></td></tr><tr><td align="left"><code class="literal">assertAttributeContainsOnly($type, $haystackAttributeName, $haystackClassOrObject, $isNativeType = NULL, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertAttributeCount($expectedCount, $haystackAttributeName, $haystackClassOrObject, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertAttributeEmpty($haystackAttributeName, $haystackClassOrObject, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertAttributeEquals($expected, $actualAttributeName, $actualClassOrObject, $message = '', $delta = 0, $maxDepth = 10, $canonicalize = FALSE, $ignoreCase = FALSE)</code></td></tr><tr><td align="left"><code class="literal">assertAttributeGreaterThan($expected, $actualAttributeName, $actualClassOrObject, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertAttributeGreaterThanOrEqual($expected, $actualAttributeName, $actualClassOrObject, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertAttributeInstanceOf($expected, $attributeName, $classOrObject, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertAttributeInternalType($expected, $attributeName, $classOrObject, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertAttributeLessThan($expected, $actualAttributeName, $actualClassOrObject, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertAttributeLessThanOrEqual($expected, $actualAttributeName, $actualClassOrObject, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertAttributeNotContains($needle, $haystackAttributeName, $haystackClassOrObject, $message = '', $ignoreCase = FALSE, $checkForObjectIdentity = TRUE)</code></td></tr><tr><td align="left"><code class="literal">assertAttributeNotContainsOnly($type, $haystackAttributeName, $haystackClassOrObject, $isNativeType = NULL, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertAttributeNotCount($expectedCount, $haystackAttributeName, $haystackClassOrObject, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertAttributeNotEmpty($haystackAttributeName, $haystackClassOrObject, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertAttributeNotEquals($expected, $actualAttributeName, $actualClassOrObject, $message = '', $delta = 0, $maxDepth = 10, $canonicalize = FALSE, $ignoreCase = FALSE)</code></td></tr><tr><td align="left"><code class="literal">assertAttributeNotInstanceOf($expected, $attributeName, $classOrObject, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertAttributeNotInternalType($expected, $attributeName, $classOrObject, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertAttributeNotSame($expected, $actualAttributeName, $actualClassOrObject, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertAttributeSame($expected, $actualAttributeName, $actualClassOrObject, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertClassHasAttribute($attributeName, $className, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertClassHasStaticAttribute($attributeName, $className, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertClassNotHasAttribute($attributeName, $className, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertClassNotHasStaticAttribute($attributeName, $className, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertContains($needle, $haystack, $message = '', $ignoreCase = FALSE, $checkForObjectIdentity = TRUE)</code></td></tr><tr><td align="left"><code class="literal">assertContainsOnly($type, $haystack, $isNativeType = NULL, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertContainsOnlyInstancesOf($classname, $haystack, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertCount($expectedCount, $haystack, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertEmpty($actual, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertEqualXMLStructure(DOMElement $expectedElement, DOMElement $actualElement, $checkAttributes = FALSE, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertEquals($expected, $actual, $message = '', $delta = 0, $maxDepth = 10, $canonicalize = FALSE, $ignoreCase = FALSE)</code></td></tr><tr><td align="left"><code class="literal">assertFalse($condition, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertFileEquals($expected, $actual, $message = '', $canonicalize = FALSE, $ignoreCase = FALSE)</code></td></tr><tr><td align="left"><code class="literal">assertFileExists($filename, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertFileNotEquals($expected, $actual, $message = '', $canonicalize = FALSE, $ignoreCase = FALSE)</code></td></tr><tr><td align="left"><code class="literal">assertFileNotExists($filename, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertGreaterThan($expected, $actual, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertGreaterThanOrEqual($expected, $actual, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertInstanceOf($expected, $actual, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertInternalType($expected, $actual, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertJsonFileEqualsJsonFile($expectedFile, $actualFile, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertJsonFileNotEqualsJsonFile($expectedFile, $actualFile, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertJsonStringEqualsJsonFile($expectedFile, $actualJson, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertJsonStringEqualsJsonString($expectedJson, $actualJson, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertJsonStringNotEqualsJsonFile($expectedFile, $actualJson, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertJsonStringNotEqualsJsonString($expectedJson, $actualJson, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertLessThan($expected, $actual, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertLessThanOrEqual($expected, $actual, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertNotContains($needle, $haystack, $message = '', $ignoreCase = FALSE, $checkForObjectIdentity = TRUE)</code></td></tr><tr><td align="left"><code class="literal">assertNotContainsOnly($type, $haystack, $isNativeType = NULL, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertNotCount($expectedCount, $haystack, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertNotEmpty($actual, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertNotEquals($expected, $actual, $message = '', $delta = 0, $maxDepth = 10, $canonicalize = FALSE, $ignoreCase = FALSE)</code></td></tr><tr><td align="left"><code class="literal">assertNotInstanceOf($expected, $actual, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertNotInternalType($expected, $actual, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertNotNull($actual, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertNotRegExp($pattern, $string, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertNotSame($expected, $actual, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertNotSameSize($expected, $actual, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertNotTag($matcher, $actual, $message = '', $isHtml = TRUE)</code></td></tr><tr><td align="left"><code class="literal">assertNull($actual, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertObjectHasAttribute($attributeName, $object, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertObjectNotHasAttribute($attributeName, $object, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertRegExp($pattern, $string, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertSame($expected, $actual, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertSameSize($expected, $actual, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertSelectCount($selector, $count, $actual, $message = '', $isHtml = TRUE)</code></td></tr><tr><td align="left"><code class="literal">assertSelectEquals($selector, $content, $count, $actual, $message = '', $isHtml = TRUE)</code></td></tr><tr><td align="left"><code class="literal">assertSelectRegExp($selector, $pattern, $count, $actual, $message = '', $isHtml = TRUE)</code></td></tr><tr><td align="left"><code class="literal">assertStringEndsNotWith($suffix, $string, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertStringEndsWith($suffix, $string, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertStringEqualsFile($expectedFile, $actualString, $message = '', $canonicalize = FALSE, $ignoreCase = FALSE)</code></td></tr><tr><td align="left"><code class="literal">assertStringMatchesFormat($format, $string, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertStringMatchesFormatFile($formatFile, $string, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertStringNotEqualsFile($expectedFile, $actualString, $message = '', $canonicalize = FALSE, $ignoreCase = FALSE)</code></td></tr><tr><td align="left"><code class="literal">assertStringNotMatchesFormat($format, $string, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertStringNotMatchesFormatFile($formatFile, $string, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertStringStartsNotWith($prefix, $string, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertStringStartsWith($prefix, $string, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertTag($matcher, $actual, $message = '', $isHtml = TRUE)</code></td></tr><tr><td align="left"><code class="literal">assertThat($value, PHPUnit_Framework_Constraint $constraint, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertTrue($condition, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertXmlFileEqualsXmlFile($expectedFile, $actualFile, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertXmlFileNotEqualsXmlFile($expectedFile, $actualFile, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertXmlStringEqualsXmlFile($expectedFile, $actualXml, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertXmlStringEqualsXmlString($expectedXml, $actualXml, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertXmlStringNotEqualsXmlFile($expectedFile, $actualXml, $message = '')</code></td></tr><tr><td align="left"><code class="literal">assertXmlStringNotEqualsXmlString($expectedXml, $actualXml, $message = '')</code></td></tr></tbody></table></div></div><br class="table-break" /></div><div class="appendix"><div class="titlepage"><div><div><h1 class="title"><a id="appendixes.annotations"></a>Appendix B. Annotations</h1></div></div></div><p>
    <a id="idm140124619478048" class="indexterm"></a>

    An annotation is a special form of syntactic metadata that can be added to
    the source code of some programming languages. While PHP has no dedicated
    language feature for annotating source code, the usage of tags such as
    <code class="literal">@annotation arguments</code> in a documentation block has been
    established in the PHP community to annotate source code. In PHP
    documentation blocks are reflective: they can be accessed through the
    Reflection API's <code class="literal">getDocComment()</code> method on the function,
    class, method, and attribute level. Applications such as PHPUnit use this
    information at runtime to configure their behaviour.
  </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
      A doc comment in PHP must start with <code class="literal">/**</code> and end with
      <code class="literal">*/</code>. Annotations in any other style of comment will be
      ignored.
    </p></div><p>
    This appendix shows all the varieties of annotations supported by PHPUnit.
  </p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.author"></a>@author</h2></div></div></div><p>
      <a id="idm140124619694304" class="indexterm"></a>

      The <code class="literal">@author</code> annotation is an alias for the
      <code class="literal">@group</code> annotation (see <a class="xref" href="#appendixes.annotations.group" title="@group">the section called “@group”</a>) and allows to filter tests based
      on their authors.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.backupGlobals"></a>@backupGlobals</h2></div></div></div><p>
      <a id="idm140124619690784" class="indexterm"></a>

      The backup and restore operations for global variables can be completely
      disabled for all tests of a test case class like this </p><pre class="programlisting">/**
 * @backupGlobals disabled
 */
class MyTest extends PHPUnit_Framework_TestCase
{
    // ...
}</pre><p>
    </p><p>
      <a id="idm140124619688976" class="indexterm"></a>

      The <code class="literal">@backupGlobals</code> annotation can also be used on the
      test method level. This allows for a fine-grained configuration of the
      backup and restore operations: </p><pre class="programlisting">/**
 * @backupGlobals disabled
 */
class MyTest extends PHPUnit_Framework_TestCase
{
    /**
     * @backupGlobals enabled
     */
    public function testThatInteractsWithGlobalVariables()
    {
        // ...
    }
}</pre><p>
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.backupStaticAttributes"></a>@backupStaticAttributes</h2></div></div></div><p>
      <a id="idm140124619685456" class="indexterm"></a>

      The backup and restore operations for static attributes of classes can be
      completely disabled for all tests of a test case class like this
      </p><pre class="programlisting">/**
 * @backupStaticAttributes disabled
 */
class MyTest extends PHPUnit_Framework_TestCase
{
    // ...
}</pre><p>
    </p><p>
      <a id="idm140124619683616" class="indexterm"></a>

      The <code class="literal">@backupStaticAttributes</code> annotation can also be used
      on the test method level. This allows for a fine-grained configuration of
      the backup and restore operations: </p><pre class="programlisting">/**
 * @backupStaticAttributes disabled
 */
class MyTest extends PHPUnit_Framework_TestCase
{
    /**
     * @backupStaticAttributes enabled
     */
    public function testThatInteractsWithStaticAttributes()
    {
        // ...
    }
}</pre><p>
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.codeCoverageIgnore"></a>@codeCoverageIgnore*</h2></div></div></div><p>
      <a id="idm140124619680016" class="indexterm"></a>
      <a id="idm140124619679440" class="indexterm"></a>
      <a id="idm140124619678848" class="indexterm"></a>

      The <code class="literal">@codeCoverageIgnore</code>, 
      <code class="literal">@codeCoverageIgnoreStart</code> and 
      <code class="literal">@codeCoverageIgnoreEnd</code> annotations can be used 
      to exclude lines of code from the coverage analysis. 
    </p><p>
      For usage see <a class="xref" href="#code-coverage-analysis.ignoring-code-blocks" title="Ignoring Code Blocks">the section called “Ignoring Code Blocks”</a>.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.covers"></a>@covers</h2></div></div></div><p>
      <a id="idm140124619674160" class="indexterm"></a>
      <a id="idm140124619673584" class="indexterm"></a>

      The <code class="literal">@covers</code> annotation can be used in the test code to
      specify which method(s) a test method wants to test: </p><pre class="programlisting">/**
 * @covers BankAccount::getBalance
 */
public function testBalanceIsInitiallyZero()
{
    $this-&gt;assertEquals(0, $this-&gt;ba-&gt;getBalance());
}</pre><p>
    </p><p>
      If provided, only the code coverage information for the specified
      method(s) will be considered.
    </p><p>
      <a class="xref" href="#appendixes.annotations.covers.tables.annotations" title="Table B.1. Annotations for specifying which methods are covered by a test">Table B.1</a> shows
      the syntax of the <code class="literal">@covers</code> annotation.
    </p><div class="table"><a id="appendixes.annotations.covers.tables.annotations"></a><p class="title"><strong>Table B.1. Annotations for specifying which methods are covered by a test</strong></p><div class="table-contents"><table class="table" summary="Annotations for specifying which methods are covered by a test" border="1"><colgroup><col /><col /></colgroup><thead><tr><th align="left">Annotation</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><code class="literal">@covers ClassName::methodName</code></td><td align="left"><code class="literal">Specifies that the annotated test method covers the specified method.</code></td></tr><tr><td align="left"><code class="literal">@covers ClassName</code></td><td align="left"><code class="literal">Specifies that the annotated test method covers all methods of a given class.</code></td></tr><tr><td align="left"><code class="literal">@covers ClassName&lt;extended&gt;</code></td><td align="left"><code class="literal">Specifies that the annotated test method covers all methods of a given class and its parent class(es) and interface(s).</code></td></tr><tr><td align="left"><code class="literal">@covers ClassName::&lt;public&gt;</code></td><td align="left"><code class="literal">Specifies that the annotated test method covers all public methods of a given class.</code></td></tr><tr><td align="left"><code class="literal">@covers ClassName::&lt;protected&gt;</code></td><td align="left"><code class="literal">Specifies that the annotated test method covers all protected methods of a given class.</code></td></tr><tr><td align="left"><code class="literal">@covers ClassName::&lt;private&gt;</code></td><td align="left"><code class="literal">Specifies that the annotated test method covers all private methods of a given class.</code></td></tr><tr><td align="left"><code class="literal">@covers ClassName::&lt;!public&gt;</code></td><td align="left"><code class="literal">Specifies that the annotated test method covers all methods of a given class that are not public.</code></td></tr><tr><td align="left"><code class="literal">@covers ClassName::&lt;!protected&gt;</code></td><td align="left"><code class="literal">Specifies that the annotated test method covers all methods of a given class that are not protected.</code></td></tr><tr><td align="left"><code class="literal">@covers ClassName::&lt;!private&gt;</code></td><td align="left"><code class="literal">Specifies that the annotated test method covers all methods of a given class that are not private.</code></td></tr><tr><td align="left"><code class="literal">@covers ::functionName</code></td><td align="left"><code class="literal">Specifies that the annotated test method covers the specified global function.</code></td></tr></tbody></table></div></div><br class="table-break" /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.coversDefaultClass"></a>@coversDefaultClass</h2></div></div></div><p>
      <a id="idm140124619425072" class="indexterm"></a>

      The <code class="literal">@coversDefaultClass</code> annotation can be used to
      specify a default namespace or class name so long names don't need to be
      repeated for every <code class="literal">@covers</code> annotation. See
      <a class="xref" href="#appendixes.annotations.examples.CoversDefaultClassTest.php" title="Example B.1: Using @coversDefaultClass to shorten annotations">Example B.1</a>.
    </p><div class="example"><a id="appendixes.annotations.examples.CoversDefaultClassTest.php"></a><p class="title"><strong>Example B.1: Using @coversDefaultClass to shorten annotations</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
/**
 * @coversDefaultClass \Foo\CoveredClass
 */
class CoversDefaultClassTest extends PHPUnit_Framework_TestCase
{
    /**
     * @covers ::publicMethod
     */
    public function testSomething()
    {
        $o = new Foo\CoveredClass;
        $o-&gt;publicMethod();
    }
}
?&gt;</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.coversNothing"></a>@coversNothing</h2></div></div></div><p>
      <a id="idm140124619419280" class="indexterm"></a>

      The <code class="literal">@coversNothing</code> annotation can be used in the 
      test code to specify that no code coverage information will be 
      recorded for the annotated test case.
    </p><p>
        This can be used for integration testing. See 
        <a class="xref" href="#code-coverage-analysis.specifying-covered-methods.examples.GuestbookIntegrationTest.php" title="Example 14.3: A test that specifies that no method should be covered">Example 14.3</a>
        for an example.
    </p><p>    
        The annotation can be used on the class and the method level and
        will override any <code class="literal">@covers</code> tags.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.dataProvider"></a>@dataProvider</h2></div></div></div><p>
      <a id="idm140124619414368" class="indexterm"></a>

      A test method can accept arbitrary arguments. These arguments are to be
      provided by a data provider method (<code class="literal">provider()</code> in
      <a class="xref" href="#writing-tests-for-phpunit.data-providers.examples.DataTest.php" title="Example 4.5: Using a data provider that returns an array of arrays">Example 4.5</a>).
      The data provider method to be used is specified using the
      <code class="literal">@dataProvider</code> annotation.
    </p><p>
      See <a class="xref" href="#writing-tests-for-phpunit.data-providers" title="Data Providers">the section called “Data Providers”</a> for more
      details.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.depends"></a>@depends</h2></div></div></div><p>
      <a id="idm140124619409424" class="indexterm"></a>

      PHPUnit supports the declaration of explicit dependencies between test
      methods. Such dependencies do not define the order in which the test
      methods are to be executed but they allow the returning of an instance of
      the test fixture by a producer and passing it to the dependent consumers.
      <a class="xref" href="#writing-tests-for-phpunit.examples.StackTest2.php" title="Example 4.2: Using the @depends annotation to express dependencies">Example 4.2</a> shows
      how to use the <code class="literal">@depends</code> annotation to express
      dependencies between test methods.
    </p><p>
      See <a class="xref" href="#writing-tests-for-phpunit.test-dependencies" title="Test Dependencies">the section called “Test Dependencies”</a> for more
      details.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.expectedException"></a>@expectedException</h2></div></div></div><p>
      <a id="idm140124619404736" class="indexterm"></a>

      <a class="xref" href="#writing-tests-for-phpunit.exceptions.examples.ExceptionTest.php" title="Example 4.9: Using the @expectedException annotation">Example 4.9</a>
      shows how to use the <code class="literal">@expectedException</code> annotation to
      test whether an exception is thrown inside the tested code.
    </p><p>
      See <a class="xref" href="#writing-tests-for-phpunit.exceptions" title="Testing Exceptions">the section called “Testing Exceptions”</a> for more
      details.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.expectedExceptionCode"></a>@expectedExceptionCode</h2></div></div></div><p>
      <a id="idm140124619400336" class="indexterm"></a>

      The <code class="literal">@expectedExceptionCode</code> annotation, in conjunction
      with the <code class="literal">@expectedException</code> allows making assertions on
      the error code of a thrown exception thus being able to narrow down a
      specific exception.

      </p><pre class="programlisting">class MyTest extends PHPUnit_Framework_TestCase
{
    /**
     * @expectedException     MyException
     * @expectedExceptionCode 20
     */
    public function testExceptionHasErrorcode20()
    {
        throw new MyException('Some Message', 20);
    }
}</pre><p>

      To ease testing and reduce duplication a shortcut can be used to
      specify a class constant as an
      <code class="literal">@expectedExceptionCode</code> using the
      "<code class="literal">@expectedExceptionCode ClassName::CONST</code>" syntax.

      </p><pre class="programlisting">class MyTest extends PHPUnit_Framework_TestCase
{
    /**
      * @expectedException     MyException
      * @expectedExceptionCode MyClass::ERRORCODE
      */
    public function testExceptionHasErrorcode20()
    {
      throw new MyException('Some Message', 20);
    }
}
class MyClass
{
    const ERRORCODE = 20;
}</pre><p>

    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.expectedExceptionMessage"></a>@expectedExceptionMessage</h2></div></div></div><p>
      <a id="idm140124619394592" class="indexterm"></a>

      The <code class="literal">@expectedExceptionMessage</code> annotation works similar
      to <code class="literal">@expectedExceptionCode</code> as it lets you make an
      assertion on the error message of an exception.

      </p><pre class="programlisting">class MyTest extends PHPUnit_Framework_TestCase
{
    /**
     * @expectedException        MyException
     * @expectedExceptionMessage Some Message
     */
    public function testExceptionHasRightMessage()
    {
        throw new MyException('Some Message', 20);
    }
}</pre><p>

      The expected message can be a substring of the exception Message.
      This can be useful to only assert that a certain name or parameter that
      was passed in shows up in the exception and not fixate the whole
      exception message in the test.

      </p><pre class="programlisting">class MyTest extends PHPUnit_Framework_TestCase
{
     /**
      * @expectedException        MyException
      * @expectedExceptionMessage broken
      */
     public function testExceptionHasRightMessage()
     {
         $param = "broken";
         throw new MyException('Invalid parameter "'.$param.'".', 20);
     }
}</pre><p>

      To ease testing and reduce duplication a shortcut can be used to
      specify a class constant as an
      <code class="literal">@expectedExceptionMessage</code> using the
      "<code class="literal">@expectedExceptionMessage ClassName::CONST</code>" syntax.

      A sample can be found in <a class="xref" href="#appendixes.annotations.expectedExceptionCode" title="@expectedExceptionCode">the section called “@expectedExceptionCode”</a>.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.group"></a>@group</h2></div></div></div><p>
      <a id="idm140124619388000" class="indexterm"></a>

      A test can be tagged as belonging to one or more groups using the
      <code class="literal">@group</code> annotation like this </p><pre class="programlisting">class MyTest extends PHPUnit_Framework_TestCase
{
    /**
     * @group specification
     */
    public function testSomething()
    {
    }

    /**
     * @group regresssion
     * @group bug2204
     */
    public function testSomethingElse()
    {
    }
}</pre><p>
    </p><p>
      Tests can be selected for execution based on groups using the
      <code class="literal">--group</code> and <code class="literal">--exclude-group</code> options
      of the command-line test runner or using the respective directives of the
      XML configuration file.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.large"></a>@large</h2></div></div></div><p>
      <a id="idm140124619383072" class="indexterm"></a>

      The <code class="literal">@large</code> annotation is an alias for
      <code class="literal">@group large</code>.
    </p><p>
      <a id="idm140124619381008" class="indexterm"></a>
      <a id="idm140124619380304" class="indexterm"></a>

      If the <code class="literal">PHP_Invoker</code> package is installed and strict
      mode is enabled, a large test will fail if it takes longer than 60
      seconds to execute. This timeout is configurable via the
      <code class="literal">timeoutForLargeTests</code> attribute in the XML
      configuration file.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.medium"></a>@medium</h2></div></div></div><p>
      <a id="idm140124619376880" class="indexterm"></a>

      The <code class="literal">@medium</code> annotation is an alias for
      <code class="literal">@group medium</code>. A medium test must not depend on a test
      marked as <code class="literal">@large</code>.
    </p><p>
      <a id="idm140124619374320" class="indexterm"></a>
      <a id="idm140124619373616" class="indexterm"></a>

      If the <code class="literal">PHP_Invoker</code> package is installed and strict
      mode is enabled, a medium test will fail if it takes longer than 10
      seconds to execute. This timeout is configurable via the
      <code class="literal">timeoutForMediumTests</code> attribute in the XML
      configuration file.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.preserveGlobalState"></a>@preserveGlobalState</h2></div></div></div><p>
      <a id="idm140124619370176" class="indexterm"></a>
      
      When a test is run in a separate process, PHPUnit will
      attempt to preserve the global state from the parent process by
      serializing all globals in the parent process and unserializing them
      in the child process. This can cause problems if the parent process
      contains globals that are not serializable. To fix this, you can prevent
      PHPUnit from preserving global state with the 
      <code class="literal">@preserveGlobalState</code> annotation.
      </p><pre class="programlisting">class MyTest extends PHPUnit_Framework_TestCase
{
    /**
     * @runInSeparateProcess
     * @preserveGlobalState disabled
     */
    public function testInSeparateProcess()
    {
        // ...
    }
}</pre><p>
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.requires"></a>@requires</h2></div></div></div><p>
      <a id="idm140124619366464" class="indexterm"></a>

      The <code class="literal">@requires</code> annotation can be used to skip tests when common
      preconditions, like the PHP Version or installed extensions, are not met.
    </p><p>
      <a id="idm140124619364752" class="indexterm"></a>
      A complete list of possibilities and examples can be found at
      <a class="xref" href="#incomplete-and-skipped-tests.requires.tables.api" title="Table 9.3. Possible @requires usages">Table 9.3</a>
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.runTestsInSeparateProcesses"></a>@runTestsInSeparateProcesses</h2></div></div></div><p>
      <a id="idm140124619361728" class="indexterm"></a>
      
      Indicates that all tests in a test class should be run in a separate
      PHP process. </p><pre class="programlisting">/**
 * @runTestsInSeparateProcesses
 */
class MyTest extends PHPUnit_Framework_TestCase
{
    // ...
}</pre><p>

      <span class="strong"><strong>Note:</strong></span> By default, PHPUnit will
      attempt to preserve the global state from the parent process by
      serializing all globals in the parent process and unserializing them
      in the child process. This can cause problems if the parent process
      contains globals that are not serializable. See <a class="xref" href="#appendixes.annotations.preserveGlobalState" title="@preserveGlobalState">the section called “@preserveGlobalState”</a> for information
      on how to fix this.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.runInSeparateProcess"></a>@runInSeparateProcess</h2></div></div></div><p>
      <a id="idm140124619357248" class="indexterm"></a>
      
      Indicates that a test should be run in a separate PHP process.
      </p><pre class="programlisting">class MyTest extends PHPUnit_Framework_TestCase
{
    /**
     * @runInSeparateProcess
     */
    public function testInSeparateProcess()
    {
        // ...
    }
}</pre><p>

      <span class="strong"><strong>Note:</strong></span> By default, PHPUnit will
      attempt to preserve the global state from the parent process by
      serializing all globals in the parent process and unserializing them
      in the child process. This can cause problems if the parent process
      contains globals that are not serializable. See <a class="xref" href="#appendixes.annotations.preserveGlobalState" title="@preserveGlobalState">the section called “@preserveGlobalState”</a> for information
      on how to fix this.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.small"></a>@small</h2></div></div></div><p>
      <a id="idm140124619352752" class="indexterm"></a>

      The <code class="literal">@small</code> annotation is an alias for
      <code class="literal">@group small</code>. A small test must not depend on a test
      marked as <code class="literal">@medium</code> or <code class="literal">@large</code>.
    </p><p>
      <a id="idm140124619349744" class="indexterm"></a>
      <a id="idm140124619349040" class="indexterm"></a>

      If the <code class="literal">PHP_Invoker</code> package is installed and strict
      mode is enabled, a small test will fail if it takes longer than 1
      second to execute. This timeout is configurable via the
      <code class="literal">timeoutForSmallTests</code> attribute in the XML
      configuration file.
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        By default, all tests are considered to be small if they are not marked
        as <code class="literal">@medium</code> or <code class="literal">@large</code>. Please note,
        however, that <code class="literal">--group</code> and the related options will
        only consider a test to be in the <code class="literal">small</code> group if it
        is explicitly marked with the appropriate annotation.
      </p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.test"></a>@test</h2></div></div></div><p>
      <a id="idm140124619342704" class="indexterm"></a>

      As an alternative to prefixing your test method names with
      <code class="literal">test</code>, you can use the <code class="literal">@test</code>
      annotation in a method's DocBlock to mark it as a test method.
      </p><pre class="programlisting">/**
 * @test
 */
public function initialBalanceShouldBe0()
{
    $this-&gt;assertEquals(0, $this-&gt;ba-&gt;getBalance());
}</pre><p>
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.testdox"></a>@testdox</h2></div></div></div><p>
      <a id="idm140124619338928" class="indexterm"></a>
      <a id="idm140124619338352" class="indexterm"></a>
    </p><pre class="programlisting"></pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.ticket"></a>@ticket</h2></div></div></div><p>
      <a id="idm140124619335856" class="indexterm"></a>
    </p><pre class="programlisting"></pre></div></div><div class="appendix"><div class="titlepage"><div><div><h1 class="title"><a id="appendixes.configuration"></a>Appendix C. The XML Configuration File</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.configuration.phpunit"></a>PHPUnit</h2></div></div></div><p>
      The attributes of the <code class="literal">&lt;phpunit&gt;</code> element can
      be used to configure PHPUnit's core functionality.
    </p><pre class="screen">&lt;phpunit
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:noNamespaceSchemaLocation="https://schema.phpunit.de/3.7/phpunit.xsd"
         backupGlobals="true"
         backupStaticAttributes="false"
         &lt;!--bootstrap="/path/to/bootstrap.php"--&gt;
         cacheTokens="false"
         colors="false"
         convertErrorsToExceptions="true"
         convertNoticesToExceptions="true"
         convertWarningsToExceptions="true"
         forceCoversAnnotation="false"
         mapTestClassNameToCoveredClassName="false"
         printerClass="PHPUnit_TextUI_ResultPrinter"
         &lt;!--printerFile="/path/to/ResultPrinter.php"--&gt;
         processIsolation="false"
         stopOnError="false"
         stopOnFailure="false"
         stopOnIncomplete="false"
         stopOnSkipped="false"
         testSuiteLoaderClass="PHPUnit_Runner_StandardTestSuiteLoader"
         &lt;!--testSuiteLoaderFile="/path/to/StandardTestSuiteLoader.php"--&gt;
         timeoutForSmallTests="1"
         timeoutForMediumTests="10"
         timeoutForLargeTests="60"
         strict="false"
         verbose="false"&gt;
  &lt;!-- ... --&gt;
&lt;/phpunit&gt;</pre><p>
      The XML configuration above corresponds to the default behaviour of the
      TextUI test runner documented in <a class="xref" href="#textui.clioptions" title="Command-Line Options">the section called “Command-Line Options”</a>.
    </p><p>
      Additional options that are not available as command-line options are:
    </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">convertErrorsToExceptions</code></span></dt><dd><p>
            By default, PHPUnit will install an error handler that converts
            the following errors to exceptions:
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><code class="literal">E_WARNING</code></li><li class="listitem"><code class="literal">E_NOTICE</code></li><li class="listitem"><code class="literal">E_USER_ERROR</code></li><li class="listitem"><code class="literal">E_USER_WARNING</code></li><li class="listitem"><code class="literal">E_USER_NOTICE</code></li><li class="listitem"><code class="literal">E_STRICT</code></li><li class="listitem"><code class="literal">E_RECOVERABLE_ERROR</code></li><li class="listitem"><code class="literal">E_DEPRECATED</code></li><li class="listitem"><code class="literal">E_USER_DEPRECATED</code></li></ul></div><p>
            Set <code class="literal">convertErrorsToExceptions</code> to
            <code class="literal">false</code> to disable this feature.
          </p></dd><dt><span class="term"><code class="literal">convertNoticesToExceptions</code></span></dt><dd><p>
            When set to <code class="literal">false</code>, the error handler installed
            by <code class="literal">convertErrorsToExceptions</code> will not convert
            <code class="literal">E_NOTICE</code>, <code class="literal">E_USER_NOTICE</code>, or
            <code class="literal">E_STRICT</code> errors to exceptions.
          </p></dd><dt><span class="term"><code class="literal">convertWarningsToExceptions</code></span></dt><dd><p>
            When set to <code class="literal">false</code>, the error handler installed
            by <code class="literal">convertErrorsToExceptions</code> will not convert
            <code class="literal">E_WARNING</code> or <code class="literal">E_USER_WARNING</code>
            errors to exceptions.
          </p></dd><dt><span class="term"><code class="literal">forceCoversAnnotation</code></span></dt><dd><p>
            Code Coverage will only be recorded for tests that use the
            <code class="literal">@covers</code> annotation documented in
            <a class="xref" href="#appendixes.annotations.covers" title="@covers">the section called “@covers”</a>.
          </p></dd><dt><span class="term"><code class="literal">timeoutForLargeTests</code></span></dt><dd><p>
            If the <code class="literal">PHP_Invoker</code> package is installed and
            strict mode is enabled, this attribute sets the timeout for all
            tests marked as <code class="literal">@large</code>. If a test does not
            complete within this configured timeout, it will fail.
          </p></dd><dt><span class="term"><code class="literal">timeoutForMediumTests</code></span></dt><dd><p>
            If the <code class="literal">PHP_Invoker</code> package is installed and
            strict mode is enabled, this attribute sets the timeout for all
            tests marked as <code class="literal">@medium</code>. If a test does not
            complete within this configured timeout, it will fail.
          </p></dd><dt><span class="term"><code class="literal">timeoutForSmallTests</code></span></dt><dd><p>
            If the <code class="literal">PHP_Invoker</code> package is installed and
            strict mode is enabled, this attribute sets the timeout for all
            tests not marked as <code class="literal">@medium</code> or
            <code class="literal">@large</code>. If a test does not complete within this
            configured timeout, it will fail.
          </p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.configuration.testsuites"></a>Test Suites</h2></div></div></div><p>
      <a id="idm140124619461792" class="indexterm"></a>

      The <code class="literal">&lt;testsuites&gt;</code> element and its
      one or more <code class="literal">&lt;testsuite&gt;</code> children can be
      used to compose a test suite out of test suites and test cases.
    </p><pre class="screen">&lt;testsuites&gt;
  &lt;testsuite name="My Test Suite"&gt;
    &lt;directory&gt;/path/to/*Test.php files&lt;/directory&gt;
    &lt;file&gt;/path/to/MyTest.php&lt;/file&gt;
    &lt;exclude&gt;/path/to/exclude&lt;/exclude&gt;
  &lt;/testsuite&gt;
&lt;/testsuites&gt;</pre><p>
      Using the <code class="literal">phpVersion</code> and
      <code class="literal">phpVersionOperator</code> attributes, a required PHP version
      can be specified. The example below will only add the
      <code class="filename">/path/to/*Test.php</code> files and
      <code class="filename">/path/to/MyTest.php</code> file if the PHP version is at
      least 5.3.0.
    </p><pre class="screen">  &lt;testsuites&gt;
    &lt;testsuite name="My Test Suite"&gt;
      &lt;directory suffix="Test.php" phpVersion="5.3.0" phpVersionOperator="&gt;="&gt;/path/to/files&lt;/directory&gt;
      &lt;file phpVersion="5.3.0" phpVersionOperator="&gt;="&gt;/path/to/MyTest.php&lt;/file&gt;
    &lt;/testsuite&gt;
  &lt;/testsuites&gt;</pre><p>
      The <code class="literal">phpVersionOperator</code> attribute is optional and
      defaults to <code class="literal">&gt;=</code>.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.configuration.groups"></a>Groups</h2></div></div></div><p>
      <a id="idm140124619334416" class="indexterm"></a>

      The <code class="literal">&lt;groups&gt;</code> element and its
      <code class="literal">&lt;include&gt;</code>,
      <code class="literal">&lt;exclude&gt;</code>, and
      <code class="literal">&lt;group&gt;</code> children can be used to select
      groups of tests marked with the <code class="literal">@group</code> annotation
      (documented in <a class="xref" href="#appendixes.annotations.group" title="@group">the section called “@group”</a>)
      that should (not) be run.
    </p><pre class="screen">&lt;groups&gt;
  &lt;include&gt;
    &lt;group&gt;name&lt;/group&gt;
  &lt;/include&gt;
  &lt;exclude&gt;
    &lt;group&gt;name&lt;/group&gt;
  &lt;/exclude&gt;
&lt;/groups&gt;</pre><p>
      The XML configuration above corresponds to invoking the TextUI test runner
      with the following options:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">--group name</code></p></li><li class="listitem"><p><code class="literal">--exclude-group name</code></p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.configuration.blacklist-whitelist"></a>Including and Excluding Files for Code Coverage</h2></div></div></div><p>
      <a id="idm140124619326496" class="indexterm"></a>
      <a id="idm140124619325920" class="indexterm"></a>
      <a id="idm140124619325344" class="indexterm"></a>

      The <code class="literal">&lt;filter&gt;</code> element and its children can
      be used to configure the blacklist and whitelist for the code coverage
      reporting.
    </p><pre class="screen">&lt;filter&gt;
  &lt;blacklist&gt;
    &lt;directory suffix=".php"&gt;/path/to/files&lt;/directory&gt;
    &lt;file&gt;/path/to/file&lt;/file&gt;
    &lt;exclude&gt;
      &lt;directory suffix=".php"&gt;/path/to/files&lt;/directory&gt;
      &lt;file&gt;/path/to/file&lt;/file&gt;
    &lt;/exclude&gt;
  &lt;/blacklist&gt;
  &lt;whitelist processUncoveredFilesFromWhitelist="true"&gt;
    &lt;directory suffix=".php"&gt;/path/to/files&lt;/directory&gt;
    &lt;file&gt;/path/to/file&lt;/file&gt;
    &lt;exclude&gt;
      &lt;directory suffix=".php"&gt;/path/to/files&lt;/directory&gt;
      &lt;file&gt;/path/to/file&lt;/file&gt;
    &lt;/exclude&gt;
  &lt;/whitelist&gt;
&lt;/filter&gt;</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.configuration.logging"></a>Logging</h2></div></div></div><p>
      <a id="idm140124619321616" class="indexterm"></a>

      The <code class="literal">&lt;logging&gt;</code> element and its
      <code class="literal">&lt;log&gt;</code> children can be used to configure the
      logging of the test execution.
    </p><pre class="screen">&lt;logging&gt;
  &lt;log type="coverage-html" target="/tmp/report" charset="UTF-8"
       highlight="false" lowUpperBound="35" highLowerBound="70"/&gt;
  &lt;log type="coverage-clover" target="/tmp/coverage.xml"/&gt;
  &lt;log type="coverage-php" target="/tmp/coverage.serialized"/&gt;
  &lt;log type="coverage-text" target="php://stdout" showUncoveredFiles="false"/&gt;
  &lt;log type="json" target="/tmp/logfile.json"/&gt;
  &lt;log type="tap" target="/tmp/logfile.tap"/&gt;
  &lt;log type="junit" target="/tmp/logfile.xml" logIncompleteSkipped="false"/&gt;
  &lt;log type="testdox-html" target="/tmp/testdox.html"/&gt;
  &lt;log type="testdox-text" target="/tmp/testdox.txt"/&gt;
&lt;/logging&gt;</pre><p>
      The XML configuration above corresponds to invoking the TextUI test runner
      with the following options:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">--coverage-html /tmp/report</code></p></li><li class="listitem"><p><code class="literal">--coverage-clover /tmp/coverage.xml</code></p></li><li class="listitem"><p><code class="literal">--coverage-php /tmp/coverage.serialized</code></p></li><li class="listitem"><p><code class="literal">--coverage-text</code></p></li><li class="listitem"><p><code class="literal">--log-json /tmp/logfile.json</code></p></li><li class="listitem"><p><code class="literal">&gt; /tmp/logfile.txt</code></p></li><li class="listitem"><p><code class="literal">--log-tap /tmp/logfile.tap</code></p></li><li class="listitem"><p><code class="literal">--log-junit /tmp/logfile.xml</code></p></li><li class="listitem"><p><code class="literal">--testdox-html /tmp/testdox.html</code></p></li><li class="listitem"><p><code class="literal">--testdox-text /tmp/testdox.txt</code></p></li></ul></div><p>
      The <code class="literal">charset</code>, <code class="literal">highlight</code>,
      <code class="literal">lowUpperBound</code>, <code class="literal">highLowerBound</code>,
      <code class="literal">logIncompleteSkipped</code> and
      <code class="literal">showUncoveredFiles</code> attributes have no equivalent TextUI
      test runner option.
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">charset</code>: Character set to be used for the generated HTML pages</p></li><li class="listitem"><p><code class="literal">highlight</code>: When set to <code class="literal">true</code>, the code in your coverage reports is syntax highlighted.</p></li><li class="listitem"><p><code class="literal">lowUpperBound</code>: Maximum coverage percentage to be considered "lowly" covered.</p></li><li class="listitem"><p><code class="literal">highLowerBound</code>: Minimum coverage percentage to be considered "highly" covered.</p></li><li class="listitem"><p><code class="literal">showUncoveredFiles</code>: Show all whitelisted files in <code class="literal">--coverage-text</code> output not just the ones with coverage information.</p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.configuration.test-listeners"></a>Test Listeners</h2></div></div></div><p>
      <a id="idm140124619300128" class="indexterm"></a>
      <a id="idm140124619299536" class="indexterm"></a>

      The <code class="literal">&lt;listeners&gt;</code> element and its
      <code class="literal">&lt;listener&gt;</code> children can be used to attach
      additional test listeners to the test execution.
    </p><pre class="screen">&lt;listeners&gt;
  &lt;listener class="MyListener" file="/optional/path/to/MyListener.php"&gt;
    &lt;arguments&gt;
      &lt;array&gt;
        &lt;element key="0"&gt;
          &lt;string&gt;Sebastian&lt;/string&gt;
        &lt;/element&gt;
      &lt;/array&gt;
      &lt;integer&gt;22&lt;/integer&gt;
      &lt;string&gt;April&lt;/string&gt;
      &lt;double&gt;19.78&lt;/double&gt;
      &lt;null/&gt;
      &lt;object class="stdClass"/&gt;
    &lt;/arguments&gt;
  &lt;/listener&gt;
&lt;/listeners&gt;</pre><p>
      The XML configuration above corresponds to attaching the
      <code class="literal">$listener</code> object (see below) to the test execution:
    </p><pre class="screen">$listener = new MyListener(
  array('Sebastian'),
  22,
  'April',
  19.78,
  NULL,
  new stdClass
);</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.configuration.php-ini-constants-variables"></a>Setting PHP INI settings, Constants and Global Variables</h2></div></div></div><p>
      <a id="idm140124619293968" class="indexterm"></a>
      <a id="idm140124619293392" class="indexterm"></a>
      <a id="idm140124619292816" class="indexterm"></a>

      The <code class="literal">&lt;php&gt;</code> element and its children can be
      used to configure PHP settings, constants, and global variables. It can
      also be used to prepend the <code class="literal">include_path</code>.
    </p><pre class="screen">&lt;php&gt;
  &lt;includePath&gt;.&lt;/includePath&gt;
  &lt;ini name="foo" value="bar"/&gt;
  &lt;const name="foo" value="bar"/&gt;
  &lt;var name="foo" value="bar"/&gt;
  &lt;env name="foo" value="bar"/&gt;
  &lt;post name="foo" value="bar"/&gt;
  &lt;get name="foo" value="bar"/&gt;
  &lt;cookie name="foo" value="bar"/&gt;
  &lt;server name="foo" value="bar"/&gt;
  &lt;files name="foo" value="bar"/&gt;
  &lt;request name="foo" value="bar"/&gt;
&lt;/php&gt;</pre><p>
      The XML configuration above corresponds to the following PHP code:
    </p><pre class="screen">ini_set('foo', 'bar');
define('foo', 'bar');
$GLOBALS['foo'] = 'bar';
$_ENV['foo'] = 'bar';
$_POST['foo'] = 'bar';
$_GET['foo'] = 'bar';
$_COOKIE['foo'] = 'bar';
$_SERVER['foo'] = 'bar';
$_FILES['foo'] = 'bar';
$_REQUEST['foo'] = 'bar';</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.configuration.selenium-rc"></a>Configuring Browsers for Selenium RC</h2></div></div></div><p>
      <a id="idm140124619287440" class="indexterm"></a>

      The <code class="literal">&lt;selenium&gt;</code> element and its
      <code class="literal">&lt;browser&gt;</code> children can be used to
      configure a list of Selenium RC servers.
    </p><pre class="screen">&lt;selenium&gt;
  &lt;browser name="Firefox on Linux"
           browser="*firefox /usr/lib/firefox/firefox-bin"
           host="my.linux.box"
           port="4444"
           timeout="30000"/&gt;
&lt;/selenium&gt;</pre><p>
      The XML configuration above corresponds to the following PHP code:
    </p><pre class="screen">class WebTest extends PHPUnit_Extensions_SeleniumTestCase
{
    public static $browsers = array(
      array(
        'name'    =&gt; 'Firefox on Linux',
        'browser' =&gt; '*firefox /usr/lib/firefox/firefox-bin',
        'host'    =&gt; 'my.linux.box',
        'port'    =&gt; 4444,
        'timeout' =&gt; 30000
      )
    );

    // ...
}</pre></div></div><div class="appendix"><div class="titlepage"><div><div><h1 class="title"><a id="appendixes.index"></a>Appendix D. Index</h1></div></div></div><div class="index"><div class="titlepage"><div><div><h2 class="title"><a id="appendixes.index.index"></a></h2></div></div></div><div xmlns:xlink="http://www.w3.org/1999/xlink" class="index"><div class="indexdiv"><h3>Symbols</h3><dl><dt id="ientry-idm140124621507520">$backupGlobalsBlacklist, <a class="indexterm" href="#fixtures.global-state">Global State</a></dt><dt id="ientry-idm140124621501984">$backupStaticAttributesBlacklist, <a class="indexterm" href="#fixtures.global-state">Global State</a></dt><dt id="ientry-idm140124619979648">@assert, <a class="indexterm" href="#skeleton-generator.test">Generating a Test Case Class Skeleton</a></dt><dt id="ientry-idm140124621406736">@author, <a class="indexterm" href="#textui.clioptions">Command-Line Options</a>, <a class="indexterm" href="#appendixes.annotations.author">@author</a></dt><dt id="ientry-idm140124621508224">@backupGlobals, <a class="indexterm" href="#fixtures.global-state">Global State</a>, <a class="indexterm" href="#appendixes.annotations.backupGlobals">@backupGlobals</a></dt><dt id="ientry-idm140124621502688">@backupStaticAttributes, <a class="indexterm" href="#fixtures.global-state">Global State</a>, <a class="indexterm" href="#appendixes.annotations.backupStaticAttributes">@backupStaticAttributes</a></dt><dt id="ientry-idm140124620007360">@codeCoverageIgnore, <a class="indexterm" href="#code-coverage-analysis.ignoring-code-blocks">Ignoring Code Blocks</a>, <a class="indexterm" href="#appendixes.annotations.codeCoverageIgnore">@codeCoverageIgnore*</a></dt><dt id="ientry-idm140124620006192">@codeCoverageIgnoreEnd, <a class="indexterm" href="#code-coverage-analysis.ignoring-code-blocks">Ignoring Code Blocks</a>, <a class="indexterm" href="#appendixes.annotations.codeCoverageIgnore">@codeCoverageIgnore*</a></dt><dt id="ientry-idm140124620006784">@codeCoverageIgnoreStart, <a class="indexterm" href="#code-coverage-analysis.ignoring-code-blocks">Ignoring Code Blocks</a>, <a class="indexterm" href="#appendixes.annotations.codeCoverageIgnore">@codeCoverageIgnore*</a></dt><dt id="ientry-idm140124620040304">@covers, <a class="indexterm" href="#code-coverage-analysis.specifying-covered-methods">Specifying Covered Methods</a>, <a class="indexterm" href="#appendixes.annotations.covers">@covers</a></dt><dt id="ientry-idm140124619425072">@coversDefaultClass, <a class="indexterm" href="#appendixes.annotations.coversDefaultClass">@coversDefaultClass</a></dt><dt id="ientry-idm140124620033712">@coversNothing, <a class="indexterm" href="#code-coverage-analysis.specifying-covered-methods">Specifying Covered Methods</a>, <a class="indexterm" href="#appendixes.annotations.coversNothing">@coversNothing</a></dt><dt id="ientry-idm140124621644160">@dataProvider, <a class="indexterm" href="#writing-tests-for-phpunit.data-providers">Data Providers</a>, <a class="indexterm" href="#appendixes.annotations.dataProvider">@dataProvider</a></dt><dt id="ientry-idm140124621630544">@depends, <a class="indexterm" href="#writing-tests-for-phpunit.test-dependencies">Test Dependencies</a>, <a class="indexterm" href="#writing-tests-for-phpunit.data-providers">Data Providers</a>, <a class="indexterm" href="#appendixes.annotations.depends">@depends</a></dt><dt id="ientry-idm140124620975632">@expectedException, <a class="indexterm" href="#writing-tests-for-phpunit.exceptions">Testing Exceptions</a>, <a class="indexterm" href="#appendixes.annotations.expectedException">@expectedException</a></dt><dt id="ientry-idm140124620968944">@expectedExceptionCode, <a class="indexterm" href="#writing-tests-for-phpunit.exceptions">Testing Exceptions</a>, <a class="indexterm" href="#appendixes.annotations.expectedExceptionCode">@expectedExceptionCode</a></dt><dt id="ientry-idm140124620969536">@expectedExceptionMessage, <a class="indexterm" href="#writing-tests-for-phpunit.exceptions">Testing Exceptions</a>, <a class="indexterm" href="#appendixes.annotations.expectedExceptionMessage">@expectedExceptionMessage</a></dt><dt id="ientry-idm140124621406160">@group, <a class="indexterm" href="#textui.clioptions">Command-Line Options</a>, <a class="indexterm" href="#appendixes.annotations.group">@group</a></dt><dt id="ientry-idm140124619383072">@large, <a class="indexterm" href="#appendixes.annotations.large">@large</a></dt><dt id="ientry-idm140124619376880">@medium, <a class="indexterm" href="#appendixes.annotations.medium">@medium</a></dt><dt id="ientry-idm140124619370176">@preserveGlobalState, <a class="indexterm" href="#appendixes.annotations.preserveGlobalState">@preserveGlobalState</a></dt><dt id="ientry-idm140124619366464">@requires, <a class="indexterm" href="#appendixes.annotations.requires">@requires</a></dt><dt id="ientry-idm140124619357248">@runInSeparateProcess, <a class="indexterm" href="#appendixes.annotations.runInSeparateProcess">@runInSeparateProcess</a></dt><dt id="ientry-idm140124619361728">@runTestsInSeparateProcesses, <a class="indexterm" href="#appendixes.annotations.runTestsInSeparateProcesses">@runTestsInSeparateProcesses</a></dt><dt id="ientry-idm140124619352752">@small, <a class="indexterm" href="#appendixes.annotations.small">@small</a></dt><dt id="ientry-idm140124621693552">@test, <a class="indexterm" href="#writing-tests-for-phpunit">Writing Tests for PHPUnit</a>, <a class="indexterm" href="#appendixes.annotations.test">@test</a></dt><dt id="ientry-idm140124619338352">@testdox, <a class="indexterm" href="#appendixes.annotations.testdox">@testdox</a></dt><dt id="ientry-idm140124619335856">@ticket, <a class="indexterm" href="#appendixes.annotations.ticket">@ticket</a></dt></dl></div><div class="indexdiv"><h3>A</h3><dl><dt id="ientry-idm140124621436960">Agile Documentation, <a class="indexterm" href="#textui.clioptions">Command-Line Options</a>, <a class="indexterm" href="#other-uses-for-tests.agile-documentation">Agile Documentation</a></dt><dt id="ientry-idm140124621693968">Annotation, <a class="indexterm" href="#writing-tests-for-phpunit">Writing Tests for PHPUnit</a>, <a class="indexterm" href="#writing-tests-for-phpunit.test-dependencies">Test Dependencies</a>, <a class="indexterm" href="#writing-tests-for-phpunit.data-providers">Data Providers</a>, <a class="indexterm" href="#writing-tests-for-phpunit.exceptions">Testing Exceptions</a>, <a class="indexterm" href="#textui.clioptions">Command-Line Options</a>, <a class="indexterm" href="#code-coverage-analysis.specifying-covered-methods">Specifying Covered Methods</a>, <a class="indexterm" href="#code-coverage-analysis.ignoring-code-blocks">Ignoring Code Blocks</a>, <a class="indexterm" href="#skeleton-generator.test">Generating a Test Case Class Skeleton</a>, <a class="indexterm" href="#appendixes.annotations">Annotations</a></dt><dt id="ientry-idm140124620463680">anything(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt id="ientry-idm140124620461568">arrayHasKey(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt id="ientry-idm140124620895632">assertArrayHasKey(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertArrayHasKey">assertArrayHasKey()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620895056">assertArrayNotHasKey(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertArrayHasKey">assertArrayHasKey()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620869808">assertAttributeContains(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertContains">assertContains()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620848128">assertAttributeContainsOnly(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertContainsOnly">assertContainsOnly()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124619728320">assertAttributeCount(), <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620818912">assertAttributeEmpty(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertEmpty">assertEmpty()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620798208">assertAttributeEquals(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertEquals">assertEquals()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620737360">assertAttributeGreaterThan(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertGreaterThan">assertGreaterThan()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620727536">assertAttributeGreaterThanOrEqual(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertGreaterThanOrEqual">assertGreaterThanOrEqual()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620717120">assertAttributeInstanceOf(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertInstanceOf">assertInstanceOf()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620704912">assertAttributeInternalType(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertInternalType">assertInternalType()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620669536">assertAttributeLessThan(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertLessThan">assertLessThan()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620659792">assertAttributeLessThanOrEqual(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertLessThanOrEqual">assertLessThanOrEqual()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620869216">assertAttributeNotContains(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertContains">assertContains()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620847536">assertAttributeNotContainsOnly(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertContainsOnly">assertContainsOnly()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124619709904">assertAttributeNotCount(), <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620818336">assertAttributeNotEmpty(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertEmpty">assertEmpty()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620797632">assertAttributeNotEquals(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertEquals">assertEquals()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620716528">assertAttributeNotInstanceOf(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertInstanceOf">assertInstanceOf()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620704320">assertAttributeNotInternalType(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertInternalType">assertInternalType()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620591040">assertAttributeNotSame(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertSame">assertSame()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620591616">assertAttributeSame(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertSame">assertSame()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620887216">assertClassHasAttribute(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertClassHasAttribute">assertClassHasAttribute()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620879104">assertClassHasStaticAttribute(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertClassHasStaticAttribute">assertClassHasStaticAttribute()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620886624">assertClassNotHasAttribute(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertClassHasAttribute">assertClassHasAttribute()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620878512">assertClassNotHasStaticAttribute(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertClassHasStaticAttribute">assertClassHasStaticAttribute()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620870960">assertContains(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertContains">assertContains()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620849280">assertContainsOnly(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertContainsOnly">assertContainsOnly()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620835696">assertContainsOnlyInstancesOf(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertContainsOnlyInstancesOf">assertContainsOnlyInstancesOf()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620828432">assertCount(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertCount">assertCount()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620820064">assertEmpty(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertEmpty">assertEmpty()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620799360">assertEquals(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertEquals">assertEquals()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620808416">assertEqualXMLStructure(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertEqualXMLStructure">assertEqualXMLStructure()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620761344">assertFalse(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertFalse">assertFalse()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620754400">assertFileEquals(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertFileEquals">assertFileEquals()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620745872">assertFileExists(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertFileExists">assertFileExists()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620753824">assertFileNotEquals(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertFileEquals">assertFileEquals()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620745296">assertFileNotExists(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertFileExists">assertFileExists()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620737936">assertGreaterThan(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertGreaterThan">assertGreaterThan()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620728128">assertGreaterThanOrEqual(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertGreaterThanOrEqual">assertGreaterThanOrEqual()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620718272">assertInstanceOf(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertInstanceOf">assertInstanceOf()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620706064">assertInternalType(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertInternalType">assertInternalType()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124621858656">Assertions, <a class="indexterm" href="#automating-tests">Automating Tests</a></dt><dt id="ientry-idm140124620693872">assertJsonFileEqualsJsonFile(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertJsonFileEqualsJsonFile">assertJsonFileEqualsJsonFile()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620693280">assertJsonFileNotEqualsJsonFile(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertJsonFileEqualsJsonFile">assertJsonFileEqualsJsonFile()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620686000">assertJsonStringEqualsJsonFile(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertJsonStringEqualsJsonFile">assertJsonStringEqualsJsonFile()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620678080">assertJsonStringEqualsJsonString(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertJsonStringEqualsJsonString">assertJsonStringEqualsJsonString()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620685408">assertJsonStringNotEqualsJsonFile(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertJsonStringEqualsJsonFile">assertJsonStringEqualsJsonFile()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620677488">assertJsonStringNotEqualsJsonString(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertJsonStringEqualsJsonString">assertJsonStringEqualsJsonString()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620670112">assertLessThan(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertLessThan">assertLessThan()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620660368">assertLessThanOrEqual(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertLessThanOrEqual">assertLessThanOrEqual()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620870384">assertNotContains(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertContains">assertContains()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620848704">assertNotContainsOnly(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertContainsOnly">assertContainsOnly()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620827856">assertNotCount(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertCount">assertCount()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620819488">assertNotEmpty(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertEmpty">assertEmpty()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620798784">assertNotEquals(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertEquals">assertEquals()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620717696">assertNotInstanceOf(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertInstanceOf">assertInstanceOf()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620705488">assertNotInternalType(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertInternalType">assertInternalType()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620649968">assertNotNull(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertNull">assertNull()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620633584">assertNotRegExp(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertRegExp">assertRegExp()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620592192">assertNotSame(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertSame">assertSame()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124619528320">assertNotSameSize(), <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620504320">assertNotTag(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertTag">assertTag()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620650544">assertNull(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertNull">assertNull()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620642224">assertObjectHasAttribute(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertObjectHasAttribute">assertObjectHasAttribute()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620641632">assertObjectNotHasAttribute(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertObjectHasAttribute">assertObjectHasAttribute()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124621474032">assertPostConditions(), <a class="indexterm" href="#fixtures">Fixtures</a></dt><dt id="ientry-idm140124621474608">assertPreConditions(), <a class="indexterm" href="#fixtures">Fixtures</a></dt><dt id="ientry-idm140124620634160">assertRegExp(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertRegExp">assertRegExp()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620592768">assertSame(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertSame">assertSame()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124619516832">assertSameSize(), <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620575440">assertSelectCount(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertSelectCount">assertSelectCount()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620560816">assertSelectEquals(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertSelectEquals">assertSelectEquals()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620545664">assertSelectRegExp(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertSelectRegExp">assertSelectRegExp()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620529888">assertStringEndsNotWith(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertStringEndsWith">assertStringEndsWith()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620530464">assertStringEndsWith(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertStringEndsWith">assertStringEndsWith()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620521984">assertStringEqualsFile(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertStringEqualsFile">assertStringEqualsFile()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620625760">assertStringMatchesFormat(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertStringMatchesFormat">assertStringMatchesFormat()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620601376">assertStringMatchesFormatFile(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertStringMatchesFormatFile">assertStringMatchesFormatFile()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620521392">assertStringNotEqualsFile(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertStringEqualsFile">assertStringEqualsFile()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620625168">assertStringNotMatchesFormat(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertStringMatchesFormat">assertStringMatchesFormat()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620600784">assertStringNotMatchesFormatFile(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertStringMatchesFormatFile">assertStringMatchesFormatFile()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620512784">assertStringStartsNotWith(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertStringStartsWith">assertStringStartsWith()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620513376">assertStringStartsWith(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertStringStartsWith">assertStringStartsWith()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620504896">assertTag(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertTag">assertTag()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620480656">assertThat(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620395760">assertTrue(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertTrue">assertTrue()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620388800">assertXmlFileEqualsXmlFile(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertXmlFileEqualsXmlFile">assertXmlFileEqualsXmlFile()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620388208">assertXmlFileNotEqualsXmlFile(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertXmlFileEqualsXmlFile">assertXmlFileEqualsXmlFile()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620380096">assertXmlStringEqualsXmlFile(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertXmlStringEqualsXmlFile">assertXmlStringEqualsXmlFile()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620371376">assertXmlStringEqualsXmlString(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertXmlStringEqualsXmlString">assertXmlStringEqualsXmlString()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620379504">assertXmlStringNotEqualsXmlFile(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertXmlStringEqualsXmlFile">assertXmlStringEqualsXmlFile()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620370784">assertXmlStringNotEqualsXmlString(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertXmlStringEqualsXmlString">assertXmlStringEqualsXmlString()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt id="ientry-idm140124620465888">attribute(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt id="ientry-idm140124620447968">attributeEqualTo(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt id="ientry-idm140124621458880">Automated Documentation, <a class="indexterm" href="#other-uses-for-tests.agile-documentation">Agile Documentation</a></dt><dt id="ientry-idm140124621855056">Automated Test, <a class="indexterm" href="#automating-tests">Automating Tests</a></dt></dl></div><div class="indexdiv"><h3>B</h3><dl><dt id="ientry-idm140124620244800">Behaviour-Driven Development, <a class="indexterm" href="#behaviour-driven-development">Behaviour-Driven Development</a></dt><dt id="ientry-idm140124619997328">Blacklist, <a class="indexterm" href="#code-coverage-analysis.including-excluding-files">Including and Excluding Files</a>, <a class="indexterm" href="#appendixes.configuration.blacklist-whitelist">Including and Excluding Files for Code Coverage</a></dt></dl></div><div class="indexdiv"><h3>C</h3><dl><dt id="ientry-idm140124620439264">classHasAttribute(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt id="ientry-idm140124620437088">classHasStaticAttribute(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt id="ientry-idm140124621451952">Code Coverage, <a class="indexterm" href="#textui.clioptions">Command-Line Options</a>, <a class="indexterm" href="#code-coverage-analysis">Code Coverage Analysis</a>, <a class="indexterm" href="#code-coverage-analysis.including-excluding-files">Including and Excluding Files</a>, <a class="indexterm" href="#appendixes.annotations.covers">@covers</a>, <a class="indexterm" href="#appendixes.configuration.blacklist-whitelist">Including and Excluding Files for Code Coverage</a></dt><dt id="ientry-idm140124621333344">Configuration, <a class="indexterm" href="#textui.clioptions">Command-Line Options</a></dt><dt id="ientry-idm140124619293968">Constant, <a class="indexterm" href="#appendixes.configuration.php-ini-constants-variables">Setting PHP INI settings, Constants and Global Variables</a></dt><dt id="ientry-idm140124620459408">contains(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt id="ientry-idm140124620456352">containsOnly(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt id="ientry-idm140124620453264">containsOnlyInstancesOf(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt></dl></div><div class="indexdiv"><h3>D</h3><dl><dt id="ientry-idm140124619840320">Data-Driven Tests, <a class="indexterm" href="#extending-phpunit.PHPUnit_Framework_Test">Implement PHPUnit_Framework_Test</a></dt><dt id="ientry-idm140124621622880">Defect Localization, <a class="indexterm" href="#writing-tests-for-phpunit.test-dependencies">Test Dependencies</a></dt><dt id="ientry-idm140124621238464">Depended-On Component, <a class="indexterm" href="#test-doubles">Test Doubles</a></dt><dt id="ientry-idm140124621108000">Design-by-Contract, <a class="indexterm" href="#test-driven-development">Test-Driven Development</a></dt><dt id="ientry-idm140124621106176">Documenting Assumptions, <a class="indexterm" href="#other-uses-for-tests.agile-documentation">Agile Documentation</a></dt><dt id="ientry-idm140124620244208">Domain-Driven Design, <a class="indexterm" href="#behaviour-driven-development">Behaviour-Driven Development</a></dt></dl></div><div class="indexdiv"><h3>E</h3><dl><dt id="ientry-idm140124620450128">equalTo(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt id="ientry-idm140124621730688">Error, <a class="indexterm" href="#textui">The Command-Line Test Runner</a></dt><dt id="ientry-idm140124620937840">Error Handler, <a class="indexterm" href="#writing-tests-for-phpunit.errors">Testing PHP Errors</a></dt><dt id="ientry-idm140124620207904">expects(), <a class="indexterm" href="#test-doubles.stubs">Stubs</a></dt><dt id="ientry-idm140124621107456">Extreme Programming, <a class="indexterm" href="#test-driven-development">Test-Driven Development</a>, <a class="indexterm" href="#behaviour-driven-development">Behaviour-Driven Development</a>, <a class="indexterm" href="#other-uses-for-tests.agile-documentation">Agile Documentation</a></dt></dl></div><div class="indexdiv"><h3>F</h3><dl><dt id="ientry-idm140124621730112">Failure, <a class="indexterm" href="#textui">The Command-Line Test Runner</a></dt><dt id="ientry-idm140124620445760">fileExists(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt id="ientry-idm140124621557776">Fixture, <a class="indexterm" href="#fixtures">Fixtures</a></dt><dt id="ientry-idm140124620215024">Fluent Interface, <a class="indexterm" href="#test-doubles.stubs">Stubs</a></dt></dl></div><div class="indexdiv"><h3>G</h3><dl><dt id="ientry-idm140124620208480">getMock(), <a class="indexterm" href="#test-doubles.stubs">Stubs</a></dt><dt id="ientry-idm140124621248160">getMockBuilder(), <a class="indexterm" href="#test-doubles.stubs">Stubs</a></dt><dt id="ientry-idm140124620096480">getMockForAbstractClass(), <a class="indexterm" href="#test-doubles.mock-objects">Mock Objects</a></dt><dt id="ientry-idm140124620086992">getMockFromWsdl(), <a class="indexterm" href="#test-doubles.stubbing-and-mocking-web-services">Stubbing and Mocking Web Services</a></dt><dt id="ientry-idm140124621517040">Global Variable, <a class="indexterm" href="#fixtures.global-state">Global State</a>, <a class="indexterm" href="#appendixes.configuration.php-ini-constants-variables">Setting PHP INI settings, Constants and Global Variables</a></dt><dt id="ientry-idm140124620443616">greaterThan(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt id="ientry-idm140124620441440">greaterThanOrEqual(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt></dl></div><div class="indexdiv"><h3>H</h3><dl><dt id="ientry-idm140124620434864">hasAttribute(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt></dl></div><div class="indexdiv"><h3>I</h3><dl><dt id="ientry-idm140124620432688">identicalTo(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt id="ientry-idm140124621323808">include_path, <a class="indexterm" href="#textui.clioptions">Command-Line Options</a></dt><dt id="ientry-idm140124621135040">Incomplete Test, <a class="indexterm" href="#incomplete-and-skipped-tests.incomplete-tests">Incomplete Tests</a>, <a class="indexterm" href="#skeleton-generator.test">Generating a Test Case Class Skeleton</a></dt><dt id="ientry-idm140124620430544">isFalse(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt id="ientry-idm140124620427968">isInstanceOf(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt id="ientry-idm140124620425776">isNull(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt id="ientry-idm140124620423200">isTrue(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt id="ientry-idm140124620420624">isType(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt></dl></div><div class="indexdiv"><h3>J</h3><dl><dt id="ientry-idm140124621702752">JSON, <a class="indexterm" href="#textui.clioptions">Command-Line Options</a></dt></dl></div><div class="indexdiv"><h3>L</h3><dl><dt id="ientry-idm140124620418464">lessThan(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt id="ientry-idm140124620416288">lessThanOrEqual(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt id="ientry-idm140124621709808">Logfile, <a class="indexterm" href="#textui.clioptions">Command-Line Options</a></dt><dt id="ientry-idm140124621458528">Logging, <a class="indexterm" href="#logging">Logging</a>, <a class="indexterm" href="#appendixes.configuration.logging">Logging</a></dt><dt id="ientry-idm140124620414112">logicalAnd(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt id="ientry-idm140124620412064">logicalNot(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt id="ientry-idm140124620409984">logicalOr(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt id="ientry-idm140124620407936">logicalXor(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt></dl></div><div class="indexdiv"><h3>M</h3><dl><dt id="ientry-idm140124620405888">matchesRegularExpression(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt id="ientry-idm140124621268880">method(), <a class="indexterm" href="#test-doubles.stubs">Stubs</a></dt><dt id="ientry-idm140124620141808">Mock Object, <a class="indexterm" href="#test-doubles.mock-objects">Mock Objects</a></dt></dl></div><div class="indexdiv"><h3>O</h3><dl><dt id="ientry-idm140124620156400">onConsecutiveCalls(), <a class="indexterm" href="#test-doubles.stubs">Stubs</a></dt><dt id="ientry-idm140124621472304">onNotSuccessfulTest(), <a class="indexterm" href="#fixtures">Fixtures</a></dt></dl></div><div class="indexdiv"><h3>P</h3><dl><dt id="ientry-idm140124620937264">PHP Error, <a class="indexterm" href="#writing-tests-for-phpunit.errors">Testing PHP Errors</a></dt><dt id="ientry-idm140124620936688">PHP Notice, <a class="indexterm" href="#writing-tests-for-phpunit.errors">Testing PHP Errors</a></dt><dt id="ientry-idm140124620936112">PHP Warning, <a class="indexterm" href="#writing-tests-for-phpunit.errors">Testing PHP Errors</a></dt><dt id="ientry-idm140124619292816">php.ini, <a class="indexterm" href="#appendixes.configuration.php-ini-constants-variables">Setting PHP INI settings, Constants and Global Variables</a></dt><dt id="ientry-idm140124619847680">PHPUnit_Extensions_RepeatedTest, <a class="indexterm" href="#extending-phpunit.PHPUnit_Extensions_TestDecorator">Subclass PHPUnit_Extensions_TestDecorator</a></dt><dt id="ientry-idm140124619867264">PHPUnit_Extensions_Selenium2TestCase, <a class="indexterm" href="#selenium.selenium2testcase">PHPUnit_Extensions_Selenium2TestCase</a></dt><dt id="ientry-idm140124619857968">PHPUnit_Extensions_SeleniumTestCase, <a class="indexterm" href="#selenium.seleniumtestcase">PHPUnit_Extensions_SeleniumTestCase</a></dt><dt id="ientry-idm140124620239408">PHPUnit_Extensions_Story_TestCase, <a class="indexterm" href="#behaviour-driven-development">Behaviour-Driven Development</a></dt><dt id="ientry-idm140124619849248">PHPUnit_Extensions_TestDecorator, <a class="indexterm" href="#extending-phpunit.PHPUnit_Extensions_TestDecorator">Subclass PHPUnit_Extensions_TestDecorator</a></dt><dt id="ientry-idm140124620261920">PHPUnit_Framework_Assert, <a class="indexterm" href="#test-driven-development.bankaccount-example">BankAccount Example</a></dt><dt id="ientry-idm140124620935536">PHPUnit_Framework_Error, <a class="indexterm" href="#writing-tests-for-phpunit.errors">Testing PHP Errors</a></dt><dt id="ientry-idm140124620929344">PHPUnit_Framework_Error_Notice, <a class="indexterm" href="#writing-tests-for-phpunit.errors">Testing PHP Errors</a></dt><dt id="ientry-idm140124620928752">PHPUnit_Framework_Error_Warning, <a class="indexterm" href="#writing-tests-for-phpunit.errors">Testing PHP Errors</a></dt><dt id="ientry-idm140124621134464">PHPUnit_Framework_IncompleteTest, <a class="indexterm" href="#incomplete-and-skipped-tests.incomplete-tests">Incomplete Tests</a></dt><dt id="ientry-idm140124621133872">PHPUnit_Framework_IncompleteTestError, <a class="indexterm" href="#incomplete-and-skipped-tests.incomplete-tests">Incomplete Tests</a></dt><dt id="ientry-idm140124619840896">PHPUnit_Framework_Test, <a class="indexterm" href="#extending-phpunit.PHPUnit_Framework_Test">Implement PHPUnit_Framework_Test</a></dt><dt id="ientry-idm140124621739952">PHPUnit_Framework_TestCase, <a class="indexterm" href="#writing-tests-for-phpunit">Writing Tests for PHPUnit</a>, <a class="indexterm" href="#extending-phpunit.PHPUnit_Framework_TestCase">Subclass PHPUnit_Framework_TestCase</a></dt><dt id="ientry-idm140124621386704">PHPUnit_Framework_TestListener, <a class="indexterm" href="#textui.clioptions">Command-Line Options</a>, <a class="indexterm" href="#extending-phpunit.PHPUnit_Framework_TestListener">Implement PHPUnit_Framework_TestListener</a>, <a class="indexterm" href="#appendixes.configuration.test-listeners">Test Listeners</a></dt><dt id="ientry-idm140124621391792">PHPUnit_Runner_TestSuiteLoader, <a class="indexterm" href="#textui.clioptions">Command-Line Options</a></dt><dt id="ientry-idm140124621386112">PHPUnit_Util_Printer, <a class="indexterm" href="#textui.clioptions">Command-Line Options</a></dt><dt id="ientry-idm140124619381008">PHP_Invoker, <a class="indexterm" href="#appendixes.annotations.large">@large</a>, <a class="indexterm" href="#appendixes.annotations.medium">@medium</a>, <a class="indexterm" href="#appendixes.annotations.small">@small</a></dt><dt id="ientry-idm140124621344720">Process Isolation, <a class="indexterm" href="#textui.clioptions">Command-Line Options</a></dt></dl></div><div class="indexdiv"><h3>R</h3><dl><dt id="ientry-idm140124621242224">Refactoring, <a class="indexterm" href="#testing-practices.during-development">During Development</a></dt><dt id="ientry-idm140124621451376">Report, <a class="indexterm" href="#textui.clioptions">Command-Line Options</a></dt><dt id="ientry-idm140124620184624">returnArgument(), <a class="indexterm" href="#test-doubles.stubs">Stubs</a></dt><dt id="ientry-idm140124620163152">returnCallback(), <a class="indexterm" href="#test-doubles.stubs">Stubs</a></dt><dt id="ientry-idm140124620177824">returnSelf(), <a class="indexterm" href="#test-doubles.stubs">Stubs</a></dt><dt id="ientry-idm140124621267728">returnValue(), <a class="indexterm" href="#test-doubles.stubs">Stubs</a></dt><dt id="ientry-idm140124620171072">returnValueMap(), <a class="indexterm" href="#test-doubles.stubs">Stubs</a></dt></dl></div><div class="indexdiv"><h3>S</h3><dl><dt id="ientry-idm140124619287440">Selenium RC, <a class="indexterm" href="#appendixes.configuration.selenium-rc">Configuring Browsers for Selenium RC</a></dt><dt id="ientry-idm140124619945712">Selenium Server, <a class="indexterm" href="#selenium.selenium-rc">Selenium Server</a></dt><dt id="ientry-idm140124621553808">setUp(), <a class="indexterm" href="#fixtures">Fixtures</a></dt><dt id="ientry-idm140124621533440">setUpBeforeClass, <a class="indexterm" href="#fixtures.sharing-fixture">Sharing Fixture</a></dt><dt id="ientry-idm140124621480080">setUpBeforeClass(), <a class="indexterm" href="#fixtures">Fixtures</a></dt><dt id="ientry-idm140124620024448">Skeleton Generator, <a class="indexterm" href="#skeleton-generator.test">Generating a Test Case Class Skeleton</a></dt><dt id="ientry-idm140124621360048">Strict Mode, <a class="indexterm" href="#textui.clioptions">Command-Line Options</a></dt><dt id="ientry-idm140124620403680">stringContains(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt id="ientry-idm140124620401504">stringEndsWith(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt id="ientry-idm140124620399328">stringStartsWith(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt id="ientry-idm140124620217296">Stub, <a class="indexterm" href="#test-doubles.stubs">Stubs</a></dt><dt id="ientry-idm140124620251648">Stubs, <a class="indexterm" href="#other-uses-for-tests.cross-team-tests">Cross-Team Tests</a></dt><dt id="ientry-idm140124621239952">System Under Test, <a class="indexterm" href="#test-doubles">Test Doubles</a></dt></dl></div><div class="indexdiv"><h3>T</h3><dl><dt id="ientry-idm140124621553232">tearDown(), <a class="indexterm" href="#fixtures">Fixtures</a></dt><dt id="ientry-idm140124621532864">tearDownAfterClass, <a class="indexterm" href="#fixtures.sharing-fixture">Sharing Fixture</a></dt><dt id="ientry-idm140124621478352">tearDownAfterClass(), <a class="indexterm" href="#fixtures">Fixtures</a></dt><dt id="ientry-idm140124621554384">Template Method, <a class="indexterm" href="#fixtures">Fixtures</a></dt><dt id="ientry-idm140124621717936">Test Dependencies, <a class="indexterm" href="#writing-tests-for-phpunit.test-dependencies">Test Dependencies</a></dt><dt id="ientry-idm140124621237888">Test Double, <a class="indexterm" href="#test-doubles">Test Doubles</a></dt><dt id="ientry-idm140124621407888">Test Groups, <a class="indexterm" href="#textui.clioptions">Command-Line Options</a>, <a class="indexterm" href="#appendixes.configuration.groups">Groups</a></dt><dt id="ientry-idm140124621344144">Test Isolation, <a class="indexterm" href="#textui.clioptions">Command-Line Options</a>, <a class="indexterm" href="#fixtures.global-state">Global State</a></dt><dt id="ientry-idm140124619299536">Test Listener, <a class="indexterm" href="#appendixes.configuration.test-listeners">Test Listeners</a></dt><dt id="ientry-idm140124621800768">Test Suite, <a class="indexterm" href="#organizing-tests">Organizing Tests</a>, <a class="indexterm" href="#appendixes.configuration.testsuites">Test Suites</a></dt><dt id="ientry-idm140124621276640">Test-Driven Development, <a class="indexterm" href="#test-driven-development">Test-Driven Development</a>, <a class="indexterm" href="#behaviour-driven-development">Behaviour-Driven Development</a></dt><dt id="ientry-idm140124621276064">Test-First Programming, <a class="indexterm" href="#test-driven-development">Test-Driven Development</a></dt><dt id="ientry-idm140124621538384">TestDox, <a class="indexterm" href="#other-uses-for-tests.agile-documentation">Agile Documentation</a>, <a class="indexterm" href="#appendixes.annotations.testdox">@testdox</a></dt><dt id="ientry-idm140124620149600">throwException(), <a class="indexterm" href="#test-doubles.stubs">Stubs</a></dt><dt id="ientry-idm140124619380304">timeoutForLargeTests, <a class="indexterm" href="#appendixes.annotations.large">@large</a></dt><dt id="ientry-idm140124619373616">timeoutForMediumTests, <a class="indexterm" href="#appendixes.annotations.medium">@medium</a></dt><dt id="ientry-idm140124619349040">timeoutForSmallTests, <a class="indexterm" href="#appendixes.annotations.small">@small</a></dt></dl></div><div class="indexdiv"><h3>U</h3><dl><dt id="ientry-idm140124621819200">Unit Test, <a class="indexterm" href="#automating-tests">Automating Tests</a>, <a class="indexterm" href="#test-driven-development">Test-Driven Development</a></dt></dl></div><div class="indexdiv"><h3>W</h3><dl><dt id="ientry-idm140124619996752">Whitelist, <a class="indexterm" href="#code-coverage-analysis.including-excluding-files">Including and Excluding Files</a>, <a class="indexterm" href="#appendixes.configuration.blacklist-whitelist">Including and Excluding Files for Code Coverage</a></dt><dt id="ientry-idm140124621268304">will(), <a class="indexterm" href="#test-doubles.stubs">Stubs</a></dt></dl></div><div class="indexdiv"><h3>X</h3><dl><dt id="ientry-idm140124621200000">Xdebug, <a class="indexterm" href="#code-coverage-analysis">Code Coverage Analysis</a></dt><dt id="ientry-idm140124621875616">XML Configuration, <a class="indexterm" href="#organizing-tests.xml-configuration">Composing a Test Suite Using XML Configuration</a></dt></dl></div></div></div></div><div class="appendix"><div class="titlepage"><div><div><h1 class="title"><a id="appendixes.bibliography"></a>Appendix E. Bibliography</h1></div></div></div><div class="biblioentry"><a id="Astels2003"></a><p>[<abbr class="abbrev">Astels2003</abbr>] <span class="title"><em>Test Driven Development</em>. </span><span class="authorgroup"><span class="firstname">David</span> <span class="surname">Astels</span>. </span><span class="copyright">Copyright © 2003. </span><span class="publisher"><span class="publishername">Prentice Hall. </span></span><span class="isbn">ISBN 0131016490. </span></p></div><div class="biblioentry"><a id="Astels2006"></a><p>[<abbr class="abbrev">Astels2006</abbr>] <span class="title"><em>A New Look at Test-Driven Development</em>. </span><span class="authorgroup"><span class="firstname">David</span> <span class="surname">Astels</span>. </span><span class="copyright">Copyright © 2006. </span><span class="publisher"><span class="publishername">http://blog.daveastels.com/files/BDD_Intro.pdf. </span></span></p></div><div class="biblioentry"><a id="Beck2002"></a><p>[<abbr class="abbrev">Beck2002</abbr>] <span class="title"><em>Test Driven Development by Example</em>. </span><span class="authorgroup"><span class="firstname">Kent</span> <span class="surname">Beck</span>. </span><span class="copyright">Copyright © 2002. </span><span class="publisher"><span class="publishername">Addison-Wesley. </span></span><span class="isbn">ISBN 0-321-14653-0. </span></p></div><div class="biblioentry"><a id="Meszaros2007"></a><p>[<abbr class="abbrev">Meszaros2007</abbr>] <span class="title"><em>xUnit Test Patterns: Refactoring Test Code</em>. </span><span class="authorgroup"><span class="firstname">Gerard</span> <span class="surname">Meszaros</span>. </span><span class="copyright">Copyright © 2007. </span><span class="publisher"><span class="publishername">Addison-Wesley. </span></span><span class="isbn">ISBN 978-0131495050. </span></p></div></div><div class="appendix"><div class="titlepage"><div><div><h1 class="title"><a id="appendixes.copyright"></a>Appendix F. Copyright</h1></div></div></div><pre class="programlisting">Copyright (c) 2005-2017 Sebastian Bergmann.

This work is licensed under the Creative Commons Attribution 3.0
Unported License.

A summary of the license is given below, followed by the full legal
text.

--------------------------------------------------------------------

You are free:

    * to Share - to copy, distribute and transmit the work
    * to Remix - to adapt the work

Under the following conditions:

Attribution. You must attribute the work in the manner specified by
the author or licensor (but not in any way that suggests that they
endorse you or your use of the work).

    * For any reuse or distribution, you must make clear to others
      the license terms of this work. The best way to do this is with
      a link to this web page.

    * Any of the above conditions can be waived if you get
      permission from the copyright holder.

    * Nothing in this license impairs or restricts the author's moral
      rights.

Your fair dealing and other rights are in no way affected by the
above.

This is a human-readable summary of the Legal Code (the full
license) below.

====================================================================

Creative Commons Legal Code
Attribution 3.0 Unported

CREATIVE COMMONS CORPORATION IS NOT A LAW FIRM AND DOES NOT PROVIDE
LEGAL SERVICES. DISTRIBUTION OF THIS LICENSE DOES NOT CREATE AN
ATTORNEY-CLIENT RELATIONSHIP. CREATIVE COMMONS PROVIDES THIS
INFORMATION ON AN "AS-IS" BASIS. CREATIVE COMMONS MAKES NO
WARRANTIES REGARDING THE INFORMATION PROVIDED, AND DISCLAIMS
LIABILITY FOR DAMAGES RESULTING FROM ITS USE.

License

THE WORK (AS DEFINED BELOW) IS PROVIDED UNDER THE TERMS OF THIS
CREATIVE COMMONS PUBLIC LICENSE ("CCPL" OR "LICENSE"). THE WORK IS
PROTECTED BY COPYRIGHT AND/OR OTHER APPLICABLE LAW. ANY USE OF THE
WORK OTHER THAN AS AUTHORIZED UNDER THIS LICENSE OR COPYRIGHT LAW
IS PROHIBITED.

BY EXERCISING ANY RIGHTS TO THE WORK PROVIDED HERE, YOU ACCEPT AND
AGREE TO BE BOUND BY THE TERMS OF THIS LICENSE. TO THE EXTENT THIS
LICENSE MAY BE CONSIDERED TO BE A CONTRACT, THE LICENSOR GRANTS YOU
THE RIGHTS CONTAINED HERE IN CONSIDERATION OF YOUR ACCEPTANCE OF
SUCH TERMS AND CONDITIONS.

1. Definitions

   a. "Adaptation" means a work based upon the Work, or upon the
      Work and other pre-existing works, such as a translation,
      adaptation, derivative work, arrangement of music or other
      alterations of a literary or artistic work, or phonogram or
      performance and includes cinematographic adaptations or any
      other form in which the Work may be recast, transformed, or
      adapted including in any form recognizably derived from the
      original, except that a work that constitutes a Collection
      will not be considered an Adaptation for the purpose of this
      License. For the avoidance of doubt, where the Work is a
      musical work, performance or phonogram, the synchronization of
      the Work in timed-relation with a moving image ("synching")
      will be considered an Adaptation for the purpose of this
      License.

   b. "Collection" means a collection of literary or artistic works,
      such as encyclopedias and anthologies, or performances,
      phonograms or broadcasts, or other works or subject matter
      other than works listed in Section 1(f) below, which, by
      reason of the selection and arrangement of their contents,
      constitute intellectual creations, in which the Work is
      included in its entirety in unmodified form along with one or
      more other contributions, each constituting separate and
      independent works in themselves, which together are assembled
      into a collective whole. A work that constitutes a Collection
      will not be considered an Adaptation (as defined above) for
      the purposes of this License.

   c. "Distribute" means to make available to the public the
      original and copies of the Work or Adaptation, as appropriate,
      through sale or other transfer of ownership.

   d. "Licensor" means the individual, individuals, entity or
      entities that offer(s) the Work under the terms of this License.

   e. "Original Author" means, in the case of a literary or artistic
      work, the individual, individuals, entity or entities who
      created the Work or if no individual or entity can be
      identified, the publisher; and in addition (i) in the case of
      a performance the actors, singers, musicians, dancers, and
      other persons who act, sing, deliver, declaim, play in,
      interpret or otherwise perform literary or artistic works or
      expressions of folklore; (ii) in the case of a phonogram the
      producer being the person or legal entity who first fixes the
      sounds of a performance or other sounds; and, (iii) in the
      case of broadcasts, the organization that transmits the
      broadcast.

   f. "Work" means the literary and/or artistic work offered under
      the terms of this License including without limitation any
      production in the literary, scientific and artistic domain,
      whatever may be the mode or form of its expression including
      digital form, such as a book, pamphlet and other writing; a
      lecture, address, sermon or other work of the same nature; a
      dramatic or dramatico-musical work; a choreographic work or
      entertainment in dumb show; a musical composition with or
      without words; a cinematographic work to which are assimilated
      works expressed by a process analogous to cinematography; a
      work of drawing, painting, architecture, sculpture, engraving
      or lithography; a photographic work to which are assimilated
      works expressed by a process analogous to photography; a work
      of applied art; an illustration, map, plan, sketch or three-
      dimensional work relative to geography, topography,
      architecture or science; a performance; a broadcast; a
      phonogram; a compilation of data to the extent it is protected
      as a copyrightable work; or a work performed by a variety or
      circus performer to the extent it is not otherwise considered
      a literary or artistic work.

   g. "You" means an individual or entity exercising rights under
      this License who has not previously violated the terms of
      this License with respect to the Work, or who has received
      express permission from the Licensor to exercise rights under
      this License despite a previous violation.

   h. "Publicly Perform" means to perform public recitations of the
      Work and to communicate to the public those public
      recitations, by any means or process, including by wire or
      wireless means or public digital performances; to make
      available to the public Works in such a way that members of
      the public may access these Works from a place and at a place
      individually chosen by them; to perform the Work to the public
      by any means or process and the communication to the public of
      the performances of the Work, including by public digital
      performance; to broadcast and rebroadcast the Work by any
      means including signs, sounds or images.

   i. "Reproduce" means to make copies of the Work by any means
      including without limitation by sound or visual recordings and
      the right of fixation and reproducing fixations of the Work,
      including storage of a protected performance or phonogram in
      digital form or other electronic medium.

2. Fair Dealing Rights. Nothing in this License is intended to
   reduce, limit, or restrict any uses free from copyright or rights
   arising from limitations or exceptions that are provided for in
   connection with the copyright protection under copyright law or
   other applicable laws.

3. License Grant. Subject to the terms and conditions of this
   License, Licensor hereby grants You a worldwide, royalty-free,
   non-exclusive, perpetual (for the duration of the applicable
   copyright) license to exercise the rights in the Work as stated
   below:

   a. to Reproduce the Work, to incorporate the Work into one or
      more Collections, and to Reproduce the Work as incorporated
      in the Collections;

   b. to create and Reproduce Adaptations provided that any such
      Adaptation, including any translation in any medium, takes
      reasonable steps to clearly label, demarcate or otherwise
      identify that changes were made to the original Work. For
      example, a translation could be marked "The original work was
      translated from English to Spanish," or a modification could
      indicate "The original work has been modified.";

   c. to Distribute and Publicly Perform the Work including as
      incorporated in Collections; and,

   d. to Distribute and Publicly Perform Adaptations.

   e. For the avoidance of doubt:

      i. Non-waivable Compulsory License Schemes. In those
         jurisdictions in which the right to collect royalties
         through any statutory or compulsory licensing scheme cannot
         be waived, the Licensor reserves the exclusive right to
         collect such royalties for any exercise by You of the
         rights granted under this License;

      ii. Waivable Compulsory License Schemes. In those
          jurisdictions in which the right to collect royalties
          through any statutory or compulsory licensing scheme can
          be waived, the Licensor waives the exclusive right to
          collect such royalties for any exercise by You of the
          rights granted under this License; and,

      iii. Voluntary License Schemes. The Licensor waives the right
           to collect royalties, whether individually or, in the
           event that the Licensor is a member of a collecting
           society that administers voluntary licensing schemes, via
           that society, from any exercise by You of the rights
           granted under this License.

The above rights may be exercised in all media and formats whether
now known or hereafter devised. The above rights include the right
to make such modifications as are technically necessary to exercise
the rights in other media and formats. Subject to Section 8(f), all
rights not expressly granted by Licensor are hereby reserved.

4. Restrictions. The license granted in Section 3 above is expressly
   made subject to and limited by the following restrictions:

   a. You may Distribute or Publicly Perform the Work only under the
      terms of this License. You must include a copy of, or the
      Uniform Resource Identifier (URI) for, this License with every
      copy of the Work You Distribute or Publicly Perform. You may
      not offer or impose any terms on the Work that restrict the
      terms of this License or the ability of the recipient of the
      Work to exercise the rights granted to that recipient under
      the terms of the License. You may not sublicense the Work. You
      must keep intact all notices that refer to this License and to
      the disclaimer of warranties with every copy of the Work You
      Distribute or Publicly Perform. When You Distribute or
      Publicly Perform the Work, You may not impose any effective
      technological measures on the Work that restrict the ability
      of a recipient of the Work from You to exercise the rights
      granted to that recipient under the terms of the License. This
      Section 4(a) applies to the Work as incorporated in a
      Collection, but this does not require the Collection apart
      from the Work itself to be made subject to the terms of this
      License. If You create a Collection, upon notice from any
      Licensor You must, to the extent practicable, remove from the
      Collection any credit as required by Section 4(b), as
      requested. If You create an Adaptation, upon notice from any
      Licensor You must, to the extent practicable, remove from the
      Adaptation any credit as required by Section 4(b), as requested.

   b. If You Distribute, or Publicly Perform the Work or any
      Adaptations or Collections, You must, unless a request has
      been made pursuant to Section 4(a), keep intact all copyright
      notices for the Work and provide, reasonable to the medium or
      means You are utilizing: (i) the name of the Original Author
      (or pseudonym, if applicable) if supplied, and/or if the
      Original Author and/or Licensor designate another party or
      parties (e.g., a sponsor institute, publishing entity,
      journal) for attribution ("Attribution Parties") in Licensor's
      copyright notice, terms of service or by other reasonable
      means, the name of such party or parties; (ii) the title of
      the Work if supplied; (iii) to the extent reasonably
      practicable, the URI, if any, that Licensor specifies to be
      associated with the Work, unless such URI does not refer to
      the copyright notice or licensing information for the Work;
      and (iv), consistent with Section 3(b), in the case of an
      Adaptation, a credit identifying the use of the Work in the
      Adaptation (e.g., "French translation of the Work by Original
      Author," or "Screenplay based on original Work by Original
      Author"). The credit required by this Section 4 (b) may be
      implemented in any reasonable manner; provided, however, that
      in the case of a Adaptation or Collection, at a minimum such
      credit will appear, if a credit for all contributing authors
      of the Adaptation or Collection appears, then as part of these
      credits and in a manner at least as prominent as the credits
      for the other contributing authors. For the avoidance of
      doubt, You may only use the credit required by this Section
      for the purpose of attribution in the manner set out above
      and, by exercising Your rights under this License, You may not
      implicitly or explicitly assert or imply any connection with,
      sponsorship or endorsement by the Original Author, Licensor
      and/or Attribution Parties, as appropriate, of You or Your use
      of the Work, without the separate, express prior written
      permission of the Original Author, Licensor and/or
      Attribution Parties.

   c. Except as otherwise agreed in writing by the Licensor or as
      may be otherwise permitted by applicable law, if You
      Reproduce, Distribute or Publicly Perform the Work either by
      itself or as part of any Adaptations or Collections, You must
      not distort, mutilate, modify or take other derogatory action
      in relation to the Work which would be prejudicial to the
      Original Author's honor or reputation. Licensor agrees that in
      those jurisdictions (e.g. Japan), in which any exercise of the
      right granted in Section 3(b) of this License (the right to
      make Adaptations) would be deemed to be a distortion,
      mutilation, modification or other derogatory action
      prejudicial to the Original Author's honor and reputation, the
      Licensor will waive or not assert, as appropriate, this
      Section, to the fullest extent permitted by the applicable
      national law, to enable You to reasonably exercise Your right
      under Section 3(b) of this License (right to make Adaptations)
      but not otherwise.

5. Representations, Warranties and Disclaimer

UNLESS OTHERWISE MUTUALLY AGREED TO BY THE PARTIES IN WRITING,
LICENSOR OFFERS THE WORK AS-IS AND MAKES NO REPRESENTATIONS OR
WARRANTIES OF ANY KIND CONCERNING THE WORK, EXPRESS, IMPLIED,
STATUTORY OR OTHERWISE, INCLUDING, WITHOUT LIMITATION, WARRANTIES OF
TITLE, MERCHANTIBILITY, FITNESS FOR A PARTICULAR PURPOSE,
NONINFRINGEMENT, OR THE ABSENCE OF LATENT OR OTHER DEFECTS,
ACCURACY, OR THE PRESENCE OF ABSENCE OF ERRORS, WHETHER OR NOT
DISCOVERABLE. SOME JURISDICTIONS DO NOT ALLOW THE EXCLUSION OF
IMPLIED WARRANTIES, SO SUCH EXCLUSION MAY NOT APPLY TO YOU.

6. Limitation on Liability. EXCEPT TO THE EXTENT REQUIRED BY
   APPLICABLE LAW, IN NO EVENT WILL LICENSOR BE LIABLE TO YOU ON ANY
   LEGAL THEORY FOR ANY SPECIAL, INCIDENTAL, CONSEQUENTIAL, PUNITIVE
   OR EXEMPLARY DAMAGES ARISING OUT OF THIS LICENSE OR THE USE OF
   THE WORK, EVEN IF LICENSOR HAS BEEN ADVISED OF THE POSSIBILITY
   OF SUCH DAMAGES.

7. Termination

   a. This License and the rights granted hereunder will terminate
      automatically upon any breach by You of the terms of this
      License. Individuals or entities who have received Adaptations
      or Collections from You under this License, however, will not
      have their licenses terminated provided such individuals or
      entities remain in full compliance with those licenses.
      Sections 1, 2, 5, 6, 7, and 8 will survive any termination of
      this License.

   b. Subject to the above terms and conditions, the license granted
      here is perpetual (for the duration of the applicable
      copyright in the Work). Notwithstanding the above, Licensor
      reserves the right to release the Work under different license
      terms or to stop distributing the Work at any time; provided,
      however that any such election will not serve to withdraw this
      License (or any other license that has been, or is required to
      be, granted under the terms of this License), and this License
      will continue in full force and effect unless terminated as
      stated above.

8. Miscellaneous

   a. Each time You Distribute or Publicly Perform the Work or a
      Collection, the Licensor offers to the recipient a license to
      the Work on the same terms and conditions as the license
      granted to You under this License.

   b. Each time You Distribute or Publicly Perform an Adaptation,
      Licensor offers to the recipient a license to the original
      Work on the same terms and conditions as the license granted
      to You under this License.

   c. If any provision of this License is invalid or unenforceable
      under applicable law, it shall not affect the validity or
      enforceability of the remainder of the terms of this License,
      and without further action by the parties to this agreement,
      such provision shall be reformed to the minimum extent
      necessary to make such provision valid and enforceable.

   d. No term or provision of this License shall be deemed waived
      and no breach consented to unless such waiver or consent shall
      be in writing and signed by the party to be charged with such
      waiver or consent.

   e. This License constitutes the entire agreement between the
      parties with respect to the Work licensed here. There are no
      understandings, agreements or representations with respect to
      the Work not specified here. Licensor shall not be bound by
      any additional provisions that may appear in any communication
      from You. This License may not be modified without the mutual
      written agreement of the Licensor and You.

   f. The rights granted under, and the subject matter referenced,
      in this License were drafted utilizing the terminology of the
      Berne Convention for the Protection of Literary and Artistic
      Works (as amended on September 28, 1979), the Rome Convention
      of 1961, the WIPO Copyright Treaty of 1996, the WIPO
      Performances and Phonograms Treaty of 1996 and the Universal
      Copyright Convention (as revised on July 24, 1971). These
      rights and subject matter take effect in the relevant
      jurisdiction in which the License terms are sought to be
      enforced according to the corresponding provisions of the
      implementation of those treaty provisions in the applicable
      national law. If the standard suite of rights granted under
      applicable copyright law includes additional rights not
      granted under this License, such additional rights are deemed
      to be included in the License; this License is not intended to
      restrict the license of any rights under applicable law.

Creative Commons is not a party to this License, and makes no
warranty whatsoever in connection with the Work. Creative Commons
will not be liable to You or any party on any legal theory for any
damages whatsoever, including without limitation any general,
special, incidental or consequential damages arising in connection
to this license. Notwithstanding the foregoing two (2) sentences,
if Creative Commons has expressly identified itself as the Licensor
hereunder, it shall have all rights and obligations of Licensor.

Except for the limited purpose of indicating to the public that the
Work is licensed under the CCPL, Creative Commons does not authorize
the use by either party of the trademark "Creative Commons" or any
related trademark or logo of Creative Commons without the prior
written consent of Creative Commons. Any permitted use will be in
compliance with Creative Commons' then-current trademark usage
guidelines, as may be published on its website or otherwise made
available upon request from time to time. For the avoidance of
doubt, this trademark restriction does not form part of this
License.

Creative Commons may be contacted at http://creativecommons.org/.

====================================================================</pre></div></div></body></html>